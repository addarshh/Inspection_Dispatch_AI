INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015041, 13)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015041, 13)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015041, 13)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015041, 13)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015041, 13)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015041, 13)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015041, 13)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015041, 13)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015041, 13)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015041, 13)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015041, 13)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015041, 13)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015041, 13)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015041, 13)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015041, 13)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015041, 13)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015182, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015182, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (2051950, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015182, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2586520, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (2015182, 2)
    and df2:n_pois_per_grid Shape: (2015182, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015182, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015182, 4)
    and df2:populationsGrids Shape: (2015182, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015182, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015182, 5)
    and df2:populationsGrids Shape: (2015182, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015182, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (60, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1366524, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1347688, 11)
    		and df2:licensesKeysDf Shape: (3797, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1347688, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (899109, 17) 
        and df2:licensesDf Shape: (899109, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (476043, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (1694520, 30)
    	and df2:licensesDf Shape: (899109, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1241202, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (371986, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (371986, 25)
    	and df2:xgb_predict_df Shape: (371986, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (371986, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (371986, 28)
    	and df2:licenses_df Shape: (899109, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (371986, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (638, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (638, 2)
    	and df2:amanaPopulationOverlay Shape: (2015182, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015182, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (2015182, 7)
    	and df2:amanaPopulationOverlay Shape: (2015182, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015182, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (2015182, 14)
    	and predictions_df Shape: (371986, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (2365395, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (2015182, 8)
    	and df2:grid_level_new_businesses Shape: (2015182, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015182, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015182, 2)
    	and df2:poiData Shape: (2015182, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015182, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015182, 5)
    	and df2:population_per_grid Shape: (2015182, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015182, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015182, 2)
    	and df2:licenses_per_grid Shape: (2015182, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015182, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015182, 2)
    	and df2:licenses_per_grid Shape: (2015182, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015182, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2015182, 9)
    	and df2:n_priority_areas_per_grid Shape: (2015182, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (2015182, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2365395, 53)
    	and df2:points_for_qgis Shape: (371986, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (371992, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (371992, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (371986, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (371986, 43)
    	and df2:data.amanaPopulationOverlay Shape: (2015182, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (371977, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (21749, 17)
    	and df2:n_licenses_per_facility Shape: (21770, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (21749, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (2015182, 20)
    	and df2:grid_level_license_risks Shape: (2015182, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015182, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (2015182, 30)
    	and df2:licenses_per_facility Shape: (21749, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015182, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (2015182, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (371977, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (371977, 46)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015182, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015182, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (2051950, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015182, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2015182, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (2015182, 2)
    and df2:n_pois_per_grid Shape: (2015182, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015182, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015182, 4)
    and df2:populationsGrids Shape: (2015182, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015182, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015182, 5)
    and df2:populationsGrids Shape: (2015182, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015182, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (60, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1366524, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (0, 11)
    		and df2:licensesKeysDf Shape: (3797, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (0, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (0, 17) 
        and df2:licensesDf Shape: (0, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (0, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015182, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015182, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (2051950, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015182, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2015182, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (2015182, 2)
    and df2:n_pois_per_grid Shape: (2015182, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015182, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015182, 4)
    and df2:populationsGrids Shape: (2015182, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015182, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015182, 5)
    and df2:populationsGrids Shape: (2015182, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015182, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (60, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1366524, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (0, 11)
    		and df2:licensesKeysDf Shape: (3797, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (0, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (0, 17) 
        and df2:licensesDf Shape: (0, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (0, 47)
        
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015182, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015182, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (2051950, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015182, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2015182, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (2015182, 2)
    and df2:n_pois_per_grid Shape: (2015182, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015182, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015182, 4)
    and df2:populationsGrids Shape: (2015182, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015182, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015182, 5)
    and df2:populationsGrids Shape: (2015182, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015182, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (60, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1366524, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (0, 11)
    		and df2:licensesKeysDf Shape: (3797, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (0, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (0, 17) 
        and df2:licensesDf Shape: (0, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (0, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015182, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015182, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (2051950, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015182, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2015182, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (2015182, 2)
    and df2:n_pois_per_grid Shape: (2015182, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015182, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015182, 4)
    and df2:populationsGrids Shape: (2015182, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015182, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015182, 5)
    and df2:populationsGrids Shape: (2015182, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015182, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (60, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1366524, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (0, 11)
    		and df2:licensesKeysDf Shape: (3797, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (0, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (0, 17) 
        and df2:licensesDf Shape: (0, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (0, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (1972973, 22)

INFO:root:Fetched Inspections_df shape: (2899051, 31)

INFO:root:Fetched/Read Health_df shape: (3797, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (2899051, 31)
    	and df2:Health_df Shape: (3797, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (2961247, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (1746742, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (1746742, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (1746726, 67)
    	and df2:Retail_Licenses_medina_df Shape: (1972973, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (1746735, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015182, 13)
INFO:root:Fetched population_grids shape: (2015182, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2015182, 3)
INFO:root:Read pois_licenses_comparison shape: (2015182, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (2899051, 31)
    	and df2:Health_df Shape: (3797, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (2961247, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (1746742, 38)
    	and df2:Retail_Licenses_medina_df Shape: (1972973, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (2963515, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (2963515, 61)
    	and df2:Health_df Shape: (3797, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3035753, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (739397, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2015182, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5484, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2015182, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (12291, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (118579, 73)
    	and df2:predictions_df Shape: (118579, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (118579, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015182, 14)
    	and df2:priority_areas Shape: (60, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (638, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (638, 2)
    	and df2:population_grids Shape: (2015182, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015182, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015182, 7)
    	and df2:population_grids Shape: (2015182, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015182, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (657967, 32)
    	and df2:geometry_per_grid Shape: (2015182, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (657933, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015182, 7)
    	and df2:population_grids Shape: (2015182, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015182, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (118133, 78)
    	and df2:population_grids Shape: (2015182, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (118129, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (12949, 2)
    	and df2:pois_data Shape: (2015182, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (12949, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (12949, 5)
    	and df2:population_per_grid Shape: (2015182, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (12949, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (12949, 3)
    	and df2:licenses_per_grid Shape: (12949, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (12949, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (12949, 9)
    	and df2:geometry_per_grid Shape: (2015182, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (12949, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (12949, 23)
    	and df2:n_priority_areas_per_grid Shape: (2015182, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (12949, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (12949, 3)
    	and df2:licenses_per_grid Shape: (12949, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (12949, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (118129, 94)
    	and df2:points_for_qgis Shape: (118133, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (118133, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (118133, 24)
    	and df2:population_grids Shape: (2015182, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (118129, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (12949, 10)
    	and df2:n_licenses_per_facility Shape: (12949, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (12949, 11)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (12949, 52)
    	and df2:grid_level_license_risks Shape: (12949, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (12949, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (12949, 59)
    	and df2:licenses_per_facility Shape: (12949, 12)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (12949, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (60, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (15, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015182, 15)
    	and df2:population_grids Shape: (2015182, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015182, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1428597, 3)
INFO:root:Fetched zone_grids shape: (1428597, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (118129, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (118129, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2015182, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1428597, 3)
INFO:root:Fetched zone_grids shape: (1428597, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (12949, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (12949, 18)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015182, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015182, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (2051950, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015182, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2015182, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (2015182, 2)
    and df2:n_pois_per_grid Shape: (2015182, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015182, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015182, 4)
    and df2:populationsGrids Shape: (2015182, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015182, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015182, 5)
    and df2:populationsGrids Shape: (2015182, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015182, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (60, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1366524, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (0, 11)
    		and df2:licensesKeysDf Shape: (3797, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (0, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (0, 17) 
        and df2:licensesDf Shape: (0, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (0, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (1973645, 22)

INFO:root:Fetched Inspections_df shape: (2905186, 31)

INFO:root:Fetched/Read Health_df shape: (3797, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (2905186, 31)
    	and df2:Health_df Shape: (3797, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (2967616, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (1752413, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (1752413, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (1752397, 67)
    	and df2:Retail_Licenses_medina_df Shape: (1973645, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (1752406, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015182, 13)
INFO:root:Fetched population_grids shape: (2015182, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2015182, 3)
INFO:root:Read pois_licenses_comparison shape: (2015182, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (2905186, 31)
    	and df2:Health_df Shape: (3797, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (2967616, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (1752413, 38)
    	and df2:Retail_Licenses_medina_df Shape: (1973645, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (2968552, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (2968552, 61)
    	and df2:Health_df Shape: (3797, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3041186, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (742195, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2015182, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5484, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2015182, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (12291, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (118748, 73)
    	and df2:predictions_df Shape: (118748, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (118748, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015182, 14)
    	and df2:priority_areas Shape: (60, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (638, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (638, 2)
    	and df2:population_grids Shape: (2015182, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015182, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015182, 7)
    	and df2:population_grids Shape: (2015182, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015182, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (658699, 32)
    	and df2:geometry_per_grid Shape: (2015182, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (658664, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015182, 7)
    	and df2:population_grids Shape: (2015182, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015182, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (118300, 78)
    	and df2:population_grids Shape: (2015182, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (118296, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (12955, 2)
    	and df2:pois_data Shape: (2015182, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (12955, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (12955, 5)
    	and df2:population_per_grid Shape: (2015182, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (12955, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (12955, 3)
    	and df2:licenses_per_grid Shape: (12955, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (12955, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (12955, 9)
    	and df2:geometry_per_grid Shape: (2015182, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (12955, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (12955, 23)
    	and df2:n_priority_areas_per_grid Shape: (2015182, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (12955, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (12955, 3)
    	and df2:licenses_per_grid Shape: (12955, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (12955, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (118296, 94)
    	and df2:points_for_qgis Shape: (118300, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (118300, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (118300, 24)
    	and df2:population_grids Shape: (2015182, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (118296, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (12955, 10)
    	and df2:n_licenses_per_facility Shape: (12955, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (12955, 11)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (12955, 52)
    	and df2:grid_level_license_risks Shape: (12955, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (12955, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (12955, 59)
    	and df2:licenses_per_facility Shape: (12955, 12)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (12955, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (60, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (15, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015182, 15)
    	and df2:population_grids Shape: (2015182, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015182, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1428597, 3)
INFO:root:Fetched zone_grids shape: (1428597, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (118296, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (118296, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2015182, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1428597, 3)
INFO:root:Fetched zone_grids shape: (1428597, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (12955, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (12955, 18)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015110, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (2051878, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2586580, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (2015110, 2)
    and df2:n_pois_per_grid Shape: (2015110, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015110, 4)
    and df2:populationsGrids Shape: (2015110, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015110, 5)
    and df2:populationsGrids Shape: (2015110, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1384, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1351383, 11)
    		and df2:licensesKeysDf Shape: (3797, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1351383, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (901162, 17) 
        and df2:licensesDf Shape: (901162, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (485292, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (1722063, 30)
    	and df2:licensesDf Shape: (901162, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1251010, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (371755, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (371755, 25)
    	and df2:xgb_predict_df Shape: (371755, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (371755, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (371755, 28)
    	and df2:licenses_df Shape: (901162, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (371755, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (9492, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (9492, 2)
    	and df2:amanaPopulationOverlay Shape: (2015110, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:amanaPopulationOverlay Shape: (2015110, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (2015110, 14)
    	and predictions_df Shape: (371755, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (2365100, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (2015110, 8)
    	and df2:grid_level_new_businesses Shape: (2015110, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015110, 2)
    	and df2:poiData Shape: (2015110, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015110, 5)
    	and df2:population_per_grid Shape: (2015110, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015110, 2)
    	and df2:licenses_per_grid Shape: (2015110, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015110, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015110, 2)
    	and df2:licenses_per_grid Shape: (2015110, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015110, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2015110, 9)
    	and df2:n_priority_areas_per_grid Shape: (2015110, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (2015110, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2365100, 53)
    	and df2:points_for_qgis Shape: (371755, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (371760, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (371760, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (371755, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (371755, 43)
    	and df2:data.amanaPopulationOverlay Shape: (2015110, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (371746, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (21738, 17)
    	and df2:n_licenses_per_facility Shape: (21761, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (21738, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (2015110, 20)
    	and df2:grid_level_license_risks Shape: (2015110, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (2015110, 30)
    	and df2:licenses_per_facility Shape: (21738, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (2015110, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (371746, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (371746, 46)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015110, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (2051878, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2587265, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (2015110, 2)
    and df2:n_pois_per_grid Shape: (2015110, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015110, 4)
    and df2:populationsGrids Shape: (2015110, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015110, 5)
    and df2:populationsGrids Shape: (2015110, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1384, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1352159, 11)
    		and df2:licensesKeysDf Shape: (3797, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1352159, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (901582, 17) 
        and df2:licensesDf Shape: (901582, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (485297, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (1722063, 30)
    	and df2:licensesDf Shape: (901582, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1251433, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (372144, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (372144, 25)
    	and df2:xgb_predict_df Shape: (372144, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (372144, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (372144, 28)
    	and df2:licenses_df Shape: (901582, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (372144, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (9492, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (9492, 2)
    	and df2:amanaPopulationOverlay Shape: (2015110, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:amanaPopulationOverlay Shape: (2015110, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (2015110, 14)
    	and predictions_df Shape: (372144, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (2365484, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (2015110, 8)
    	and df2:grid_level_new_businesses Shape: (2015110, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015110, 2)
    	and df2:poiData Shape: (2015110, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015110, 5)
    	and df2:population_per_grid Shape: (2015110, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015110, 2)
    	and df2:licenses_per_grid Shape: (2015110, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015110, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015110, 2)
    	and df2:licenses_per_grid Shape: (2015110, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015110, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2015110, 9)
    	and df2:n_priority_areas_per_grid Shape: (2015110, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (2015110, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2365484, 53)
    	and df2:points_for_qgis Shape: (372144, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (372149, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (372149, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (372144, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (372144, 43)
    	and df2:data.amanaPopulationOverlay Shape: (2015110, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (372135, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (21743, 17)
    	and df2:n_licenses_per_facility Shape: (21766, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (21743, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (2015110, 20)
    	and df2:grid_level_license_risks Shape: (2015110, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (2015110, 30)
    	and df2:licenses_per_facility Shape: (21743, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (2015110, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (372135, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (372135, 46)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (1975144, 22)

INFO:root:Fetched Inspections_df shape: (2920901, 31)

INFO:root:Fetched/Read Health_df shape: (3797, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (2920901, 31)
    	and df2:Health_df Shape: (3797, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (2983831, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (1764611, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (1764611, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (1764595, 67)
    	and df2:Retail_Licenses_medina_df Shape: (1975144, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (1764604, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015110, 13)
INFO:root:Fetched population_grids shape: (2015110, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2015110, 3)
INFO:root:Read pois_licenses_comparison shape: (2015110, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (2920901, 31)
    	and df2:Health_df Shape: (3797, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (2983831, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (1764611, 38)
    	and df2:Retail_Licenses_medina_df Shape: (1975144, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (2978829, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (2978829, 61)
    	and df2:Health_df Shape: (3797, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3052271, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (747813, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2015110, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5484, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2015110, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (12291, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (119217, 73)
    	and df2:predictions_df Shape: (119217, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (119217, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015110, 14)
    	and df2:priority_areas Shape: (1384, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9492, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9492, 2)
    	and df2:population_grids Shape: (2015110, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015110, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:population_grids Shape: (2015110, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015110, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (660476, 32)
    	and df2:geometry_per_grid Shape: (2015110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (660428, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:population_grids Shape: (2015110, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (118769, 78)
    	and df2:population_grids Shape: (2015110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (118764, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (12974, 2)
    	and df2:pois_data Shape: (2015110, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (12974, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (12974, 5)
    	and df2:population_per_grid Shape: (2015110, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (12974, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (12974, 3)
    	and df2:licenses_per_grid Shape: (12974, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (12974, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (12974, 9)
    	and df2:geometry_per_grid Shape: (2015110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (12974, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (12974, 23)
    	and df2:n_priority_areas_per_grid Shape: (2015110, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (12974, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (12974, 3)
    	and df2:licenses_per_grid Shape: (12974, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (12974, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (118764, 94)
    	and df2:points_for_qgis Shape: (118769, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (118769, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (118769, 24)
    	and df2:population_grids Shape: (2015110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (118764, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (12974, 10)
    	and df2:n_licenses_per_facility Shape: (12974, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (12974, 11)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (12974, 52)
    	and df2:grid_level_license_risks Shape: (12974, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (12974, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (12974, 59)
    	and df2:licenses_per_facility Shape: (12974, 12)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (12974, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1384, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015110, 15)
    	and df2:population_grids Shape: (2015110, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (118764, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (118764, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2015110, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (12974, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (12974, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (1975888, 22)

INFO:root:Fetched Inspections_df shape: (2927325, 31)

INFO:root:Fetched/Read Health_df shape: (3797, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (2927325, 31)
    	and df2:Health_df Shape: (3797, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (2990400, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (1769917, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (1769917, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (1769901, 67)
    	and df2:Retail_Licenses_medina_df Shape: (1975888, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (1769906, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015110, 13)
INFO:root:Fetched population_grids shape: (2015110, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2015110, 3)
INFO:root:Read pois_licenses_comparison shape: (2015110, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (2927325, 31)
    	and df2:Health_df Shape: (3797, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (2990400, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (1769917, 38)
    	and df2:Retail_Licenses_medina_df Shape: (1975888, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (2983435, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (2983435, 61)
    	and df2:Health_df Shape: (3797, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3057189, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (750238, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2015110, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5484, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2015110, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (12291, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (119442, 73)
    	and df2:predictions_df Shape: (119442, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (119442, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015110, 14)
    	and df2:priority_areas Shape: (1384, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9492, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9492, 2)
    	and df2:population_grids Shape: (2015110, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015110, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:population_grids Shape: (2015110, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015110, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (661272, 32)
    	and df2:geometry_per_grid Shape: (2015110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (661224, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:population_grids Shape: (2015110, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (118993, 78)
    	and df2:population_grids Shape: (2015110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (118988, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (12986, 2)
    	and df2:pois_data Shape: (2015110, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (12986, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (12986, 5)
    	and df2:population_per_grid Shape: (2015110, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (12986, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (12986, 3)
    	and df2:licenses_per_grid Shape: (12986, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (12986, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (12986, 9)
    	and df2:geometry_per_grid Shape: (2015110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (12986, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (12986, 23)
    	and df2:n_priority_areas_per_grid Shape: (2015110, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (12986, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (12986, 3)
    	and df2:licenses_per_grid Shape: (12986, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (12986, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (118988, 94)
    	and df2:points_for_qgis Shape: (118993, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (118993, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (118993, 24)
    	and df2:population_grids Shape: (2015110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (118988, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (12986, 10)
    	and df2:n_licenses_per_facility Shape: (12986, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (12986, 11)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (12986, 52)
    	and df2:grid_level_license_risks Shape: (12986, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (12986, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (12986, 59)
    	and df2:licenses_per_facility Shape: (12986, 12)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (12986, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1384, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015110, 15)
    	and df2:population_grids Shape: (2015110, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (118988, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (118988, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2015110, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (12986, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (12986, 18)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015110, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (2051878, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2587789, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (2015110, 2)
    and df2:n_pois_per_grid Shape: (2015110, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015110, 4)
    and df2:populationsGrids Shape: (2015110, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015110, 5)
    and df2:populationsGrids Shape: (2015110, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1384, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1352916, 11)
    		and df2:licensesKeysDf Shape: (3797, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1352916, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (901992, 17) 
        and df2:licensesDf Shape: (901992, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (489110, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (1733186, 30)
    	and df2:licensesDf Shape: (901992, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1254985, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (372432, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (372432, 25)
    	and df2:xgb_predict_df Shape: (372432, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (372432, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (372432, 28)
    	and df2:licenses_df Shape: (901992, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (372432, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (9492, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (9492, 2)
    	and df2:amanaPopulationOverlay Shape: (2015110, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:amanaPopulationOverlay Shape: (2015110, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (2015110, 14)
    	and predictions_df Shape: (372432, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (2365761, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (2015110, 8)
    	and df2:grid_level_new_businesses Shape: (2015110, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015110, 2)
    	and df2:poiData Shape: (2015110, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015110, 5)
    	and df2:population_per_grid Shape: (2015110, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015110, 2)
    	and df2:licenses_per_grid Shape: (2015110, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015110, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015110, 2)
    	and df2:licenses_per_grid Shape: (2015110, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015110, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2015110, 9)
    	and df2:n_priority_areas_per_grid Shape: (2015110, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (2015110, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2365761, 53)
    	and df2:points_for_qgis Shape: (372432, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (372437, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (372437, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (372432, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (372432, 43)
    	and df2:data.amanaPopulationOverlay Shape: (2015110, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (372423, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (21755, 17)
    	and df2:n_licenses_per_facility Shape: (21777, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (21755, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (2015110, 20)
    	and df2:grid_level_license_risks Shape: (2015110, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (2015110, 30)
    	and df2:licenses_per_facility Shape: (21755, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (2015110, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (372423, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (372423, 46)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015110, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (2051878, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2587086, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (2015110, 2)
    and df2:n_pois_per_grid Shape: (2015110, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015110, 4)
    and df2:populationsGrids Shape: (2015110, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015110, 5)
    and df2:populationsGrids Shape: (2015110, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1384, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1353521, 11)
    		and df2:licensesKeysDf Shape: (3797, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1353521, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (902308, 17) 
        and df2:licensesDf Shape: (902308, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (490339, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (1737041, 30)
    	and df2:licensesDf Shape: (902308, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1256299, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (371971, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (371971, 25)
    	and df2:xgb_predict_df Shape: (371971, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (371971, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (371971, 28)
    	and df2:licenses_df Shape: (902308, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (371971, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (9492, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (9492, 2)
    	and df2:amanaPopulationOverlay Shape: (2015110, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:amanaPopulationOverlay Shape: (2015110, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (2015110, 14)
    	and predictions_df Shape: (371971, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (2365322, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (2015110, 8)
    	and df2:grid_level_new_businesses Shape: (2015110, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015110, 2)
    	and df2:poiData Shape: (2015110, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015110, 5)
    	and df2:population_per_grid Shape: (2015110, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015110, 2)
    	and df2:licenses_per_grid Shape: (2015110, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015110, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015110, 2)
    	and df2:licenses_per_grid Shape: (2015110, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015110, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2015110, 9)
    	and df2:n_priority_areas_per_grid Shape: (2015110, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (2015110, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2365322, 53)
    	and df2:points_for_qgis Shape: (371971, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (371976, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (371976, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (371971, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (371971, 43)
    	and df2:data.amanaPopulationOverlay Shape: (2015110, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (371962, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (21732, 17)
    	and df2:n_licenses_per_facility Shape: (21755, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (21732, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (2015110, 20)
    	and df2:grid_level_license_risks Shape: (2015110, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (2015110, 30)
    	and df2:licenses_per_facility Shape: (21732, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (2015110, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (371962, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (371962, 46)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (1976635, 22)

INFO:root:Fetched Inspections_df shape: (2932013, 31)

INFO:root:Fetched/Read Health_df shape: (3797, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (2932013, 31)
    	and df2:Health_df Shape: (3797, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (2995305, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (1774695, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (1774695, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (1774679, 67)
    	and df2:Retail_Licenses_medina_df Shape: (1976635, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (1774684, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015110, 13)
INFO:root:Fetched population_grids shape: (2015110, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2015110, 3)
INFO:root:Read pois_licenses_comparison shape: (2015110, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (2932013, 31)
    	and df2:Health_df Shape: (3797, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (2995305, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (1774695, 38)
    	and df2:Retail_Licenses_medina_df Shape: (1976635, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (2987584, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (2987584, 61)
    	and df2:Health_df Shape: (3797, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3061678, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (752483, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2015110, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5484, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2015110, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (12291, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (119617, 73)
    	and df2:predictions_df Shape: (119617, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (119617, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015110, 14)
    	and df2:priority_areas Shape: (1384, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9492, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9492, 2)
    	and df2:population_grids Shape: (2015110, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015110, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:population_grids Shape: (2015110, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015110, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (662821, 32)
    	and df2:geometry_per_grid Shape: (2015110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (662772, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:population_grids Shape: (2015110, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (119162, 78)
    	and df2:population_grids Shape: (2015110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (119157, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (12996, 2)
    	and df2:pois_data Shape: (2015110, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (12996, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (12996, 5)
    	and df2:population_per_grid Shape: (2015110, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (12996, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (12996, 3)
    	and df2:licenses_per_grid Shape: (12996, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (12996, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (12996, 9)
    	and df2:geometry_per_grid Shape: (2015110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (12996, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (12996, 23)
    	and df2:n_priority_areas_per_grid Shape: (2015110, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (12996, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (12996, 3)
    	and df2:licenses_per_grid Shape: (12996, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (12996, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (119157, 94)
    	and df2:points_for_qgis Shape: (119162, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (119162, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (119162, 24)
    	and df2:population_grids Shape: (2015110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (119157, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (12996, 10)
    	and df2:n_licenses_per_facility Shape: (12996, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (12996, 11)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (12996, 52)
    	and df2:grid_level_license_risks Shape: (12996, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (12996, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (12996, 59)
    	and df2:licenses_per_facility Shape: (12996, 12)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (12996, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1384, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015110, 15)
    	and df2:population_grids Shape: (2015110, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (119157, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (119157, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2015110, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (12996, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (12996, 18)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015110, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (2051878, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2587388, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (2015110, 2)
    and df2:n_pois_per_grid Shape: (2015110, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015110, 4)
    and df2:populationsGrids Shape: (2015110, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015110, 5)
    and df2:populationsGrids Shape: (2015110, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1384, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1354085, 11)
    		and df2:licensesKeysDf Shape: (3797, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1354085, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (902597, 17) 
        and df2:licensesDf Shape: (902597, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (490980, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (1739193, 30)
    	and df2:licensesDf Shape: (902597, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1257145, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (372073, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (372073, 25)
    	and df2:xgb_predict_df Shape: (372073, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (372073, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (372073, 28)
    	and df2:licenses_df Shape: (902597, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (372073, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (9492, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (9492, 2)
    	and df2:amanaPopulationOverlay Shape: (2015110, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:amanaPopulationOverlay Shape: (2015110, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (2015110, 14)
    	and predictions_df Shape: (372073, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (2365428, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (2015110, 8)
    	and df2:grid_level_new_businesses Shape: (2015110, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015110, 2)
    	and df2:poiData Shape: (2015110, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015110, 5)
    	and df2:population_per_grid Shape: (2015110, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015110, 2)
    	and df2:licenses_per_grid Shape: (2015110, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015110, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015110, 2)
    	and df2:licenses_per_grid Shape: (2015110, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015110, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2015110, 9)
    	and df2:n_priority_areas_per_grid Shape: (2015110, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (2015110, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2365428, 53)
    	and df2:points_for_qgis Shape: (372073, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (372078, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (372078, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (372073, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (372073, 43)
    	and df2:data.amanaPopulationOverlay Shape: (2015110, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (372064, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (21728, 17)
    	and df2:n_licenses_per_facility Shape: (21751, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (21728, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (2015110, 20)
    	and df2:grid_level_license_risks Shape: (2015110, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (2015110, 30)
    	and df2:licenses_per_facility Shape: (21728, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (2015110, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (372064, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (372064, 46)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (1977654, 22)

INFO:root:Fetched Inspections_df shape: (2941814, 31)

INFO:root:Fetched/Read Health_df shape: (3797, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (2941814, 31)
    	and df2:Health_df Shape: (3797, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3005440, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (1781221, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (1781221, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (1781205, 67)
    	and df2:Retail_Licenses_medina_df Shape: (1977654, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (1781210, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015110, 13)
INFO:root:Fetched population_grids shape: (2015110, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2015110, 3)
INFO:root:Read pois_licenses_comparison shape: (2015110, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (2941814, 31)
    	and df2:Health_df Shape: (3797, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3005440, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (1781221, 38)
    	and df2:Retail_Licenses_medina_df Shape: (1977654, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (2993325, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (2993325, 61)
    	and df2:Health_df Shape: (3797, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3067989, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (755477, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2015110, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5484, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2015110, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (12291, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (119756, 73)
    	and df2:predictions_df Shape: (119756, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (119756, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015110, 14)
    	and df2:priority_areas Shape: (1384, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9492, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9492, 2)
    	and df2:population_grids Shape: (2015110, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015110, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:population_grids Shape: (2015110, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015110, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (664695, 32)
    	and df2:geometry_per_grid Shape: (2015110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (664644, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:population_grids Shape: (2015110, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (119300, 78)
    	and df2:population_grids Shape: (2015110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (119295, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13008, 2)
    	and df2:pois_data Shape: (2015110, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13008, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13008, 5)
    	and df2:population_per_grid Shape: (2015110, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13008, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13008, 3)
    	and df2:licenses_per_grid Shape: (13008, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13008, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13008, 9)
    	and df2:geometry_per_grid Shape: (2015110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (13008, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13008, 23)
    	and df2:n_priority_areas_per_grid Shape: (2015110, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (13008, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13008, 3)
    	and df2:licenses_per_grid Shape: (13008, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (13008, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (119295, 94)
    	and df2:points_for_qgis Shape: (119300, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (119300, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (119300, 24)
    	and df2:population_grids Shape: (2015110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (119295, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (13008, 10)
    	and df2:n_licenses_per_facility Shape: (13008, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13008, 11)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (13008, 52)
    	and df2:grid_level_license_risks Shape: (13008, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13008, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (13008, 59)
    	and df2:licenses_per_facility Shape: (13008, 12)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13008, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1384, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015110, 15)
    	and df2:population_grids Shape: (2015110, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (119295, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (119295, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2015110, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (13008, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (13008, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (1978378, 22)

INFO:root:Fetched Inspections_df shape: (2948402, 31)

INFO:root:Fetched/Read Health_df shape: (3797, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (2948402, 31)
    	and df2:Health_df Shape: (3797, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3012239, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (1786675, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (1786675, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (1786659, 67)
    	and df2:Retail_Licenses_medina_df Shape: (1978378, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (1786664, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015110, 13)
INFO:root:Fetched population_grids shape: (2015110, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2015110, 3)
INFO:root:Read pois_licenses_comparison shape: (2015110, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (2948402, 31)
    	and df2:Health_df Shape: (3797, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3012239, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (1786675, 38)
    	and df2:Retail_Licenses_medina_df Shape: (1978378, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (2997807, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (2997807, 61)
    	and df2:Health_df Shape: (3797, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3072821, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (757871, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2015110, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5484, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2015110, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (12291, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (119948, 73)
    	and df2:predictions_df Shape: (119948, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (119948, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015110, 14)
    	and df2:priority_areas Shape: (1384, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9492, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9492, 2)
    	and df2:population_grids Shape: (2015110, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015110, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:population_grids Shape: (2015110, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015110, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (665648, 32)
    	and df2:geometry_per_grid Shape: (2015110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (665586, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:population_grids Shape: (2015110, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (119492, 78)
    	and df2:population_grids Shape: (2015110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (119486, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13020, 2)
    	and df2:pois_data Shape: (2015110, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13020, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13020, 5)
    	and df2:population_per_grid Shape: (2015110, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13020, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13020, 3)
    	and df2:licenses_per_grid Shape: (13020, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13020, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13020, 9)
    	and df2:geometry_per_grid Shape: (2015110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (13020, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13020, 23)
    	and df2:n_priority_areas_per_grid Shape: (2015110, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (13020, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13020, 3)
    	and df2:licenses_per_grid Shape: (13020, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (13020, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (119486, 94)
    	and df2:points_for_qgis Shape: (119492, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (119492, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (119492, 24)
    	and df2:population_grids Shape: (2015110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (119486, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (13020, 10)
    	and df2:n_licenses_per_facility Shape: (13020, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13020, 11)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (13020, 52)
    	and df2:grid_level_license_risks Shape: (13020, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13020, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (13020, 59)
    	and df2:licenses_per_facility Shape: (13020, 12)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13020, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1384, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015110, 15)
    	and df2:population_grids Shape: (2015110, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (119486, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (119486, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2015110, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (13020, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (13020, 18)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015110, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (2051878, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2589334, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (2015110, 2)
    and df2:n_pois_per_grid Shape: (2015110, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015110, 4)
    and df2:populationsGrids Shape: (2015110, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015110, 5)
    and df2:populationsGrids Shape: (2015110, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1384, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1356234, 11)
    		and df2:licensesKeysDf Shape: (3797, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1356234, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (903731, 17) 
        and df2:licensesDf Shape: (903731, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (496024, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (1754782, 30)
    	and df2:licensesDf Shape: (903731, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1262558, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (373095, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (373095, 25)
    	and df2:xgb_predict_df Shape: (373095, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (373095, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (373095, 28)
    	and df2:licenses_df Shape: (903731, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (373095, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (9492, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (9492, 2)
    	and df2:amanaPopulationOverlay Shape: (2015110, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:amanaPopulationOverlay Shape: (2015110, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (2015110, 14)
    	and predictions_df Shape: (373095, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (2366406, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (2015110, 8)
    	and df2:grid_level_new_businesses Shape: (2015110, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015110, 2)
    	and df2:poiData Shape: (2015110, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015110, 5)
    	and df2:population_per_grid Shape: (2015110, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015110, 2)
    	and df2:licenses_per_grid Shape: (2015110, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015110, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015110, 2)
    	and df2:licenses_per_grid Shape: (2015110, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015110, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2015110, 9)
    	and df2:n_priority_areas_per_grid Shape: (2015110, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (2015110, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2366406, 53)
    	and df2:points_for_qgis Shape: (373095, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (373100, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (373100, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (373095, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (373095, 43)
    	and df2:data.amanaPopulationOverlay Shape: (2015110, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (373086, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (21772, 17)
    	and df2:n_licenses_per_facility Shape: (21795, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (21772, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (2015110, 20)
    	and df2:grid_level_license_risks Shape: (2015110, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (2015110, 30)
    	and df2:licenses_per_facility Shape: (21772, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (2015110, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (373086, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (373086, 46)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015110, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (2051878, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2590248, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (2015110, 2)
    and df2:n_pois_per_grid Shape: (2015110, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015110, 4)
    and df2:populationsGrids Shape: (2015110, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015110, 5)
    and df2:populationsGrids Shape: (2015110, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1384, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1357758, 11)
    		and df2:licensesKeysDf Shape: (3797, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1357758, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (904554, 17) 
        and df2:licensesDf Shape: (904554, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (499112, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (1765817, 30)
    	and df2:licensesDf Shape: (904554, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1266039, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (373575, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (373575, 25)
    	and df2:xgb_predict_df Shape: (373575, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (373575, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (373575, 28)
    	and df2:licenses_df Shape: (904554, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (373575, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (9492, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (9492, 2)
    	and df2:amanaPopulationOverlay Shape: (2015110, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:amanaPopulationOverlay Shape: (2015110, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (2015110, 14)
    	and predictions_df Shape: (373575, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (2366871, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (2015110, 8)
    	and df2:grid_level_new_businesses Shape: (2015110, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015110, 2)
    	and df2:poiData Shape: (2015110, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015110, 5)
    	and df2:population_per_grid Shape: (2015110, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015110, 2)
    	and df2:licenses_per_grid Shape: (2015110, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015110, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015110, 2)
    	and df2:licenses_per_grid Shape: (2015110, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015110, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2015110, 9)
    	and df2:n_priority_areas_per_grid Shape: (2015110, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (2015110, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2366871, 53)
    	and df2:points_for_qgis Shape: (373575, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (373580, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (373580, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (373575, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (373575, 43)
    	and df2:data.amanaPopulationOverlay Shape: (2015110, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (373566, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (21787, 17)
    	and df2:n_licenses_per_facility Shape: (21810, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (21787, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (2015110, 20)
    	and df2:grid_level_license_risks Shape: (2015110, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (2015110, 30)
    	and df2:licenses_per_facility Shape: (21787, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (2015110, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (373566, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (373566, 46)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015110, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (2051878, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2589624, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (2015110, 2)
    and df2:n_pois_per_grid Shape: (2015110, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015110, 4)
    and df2:populationsGrids Shape: (2015110, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015110, 5)
    and df2:populationsGrids Shape: (2015110, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1384, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1357887, 11)
    		and df2:licensesKeysDf Shape: (3797, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1357887, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (904612, 17) 
        and df2:licensesDf Shape: (904612, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (499504, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (1767091, 30)
    	and df2:licensesDf Shape: (904612, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1266465, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (373147, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (373147, 25)
    	and df2:xgb_predict_df Shape: (373147, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (373147, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (373147, 28)
    	and df2:licenses_df Shape: (904612, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (373147, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (9492, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (9492, 2)
    	and df2:amanaPopulationOverlay Shape: (2015110, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:amanaPopulationOverlay Shape: (2015110, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (2015110, 14)
    	and predictions_df Shape: (373147, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (2366454, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (2015110, 8)
    	and df2:grid_level_new_businesses Shape: (2015110, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015110, 2)
    	and df2:poiData Shape: (2015110, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015110, 5)
    	and df2:population_per_grid Shape: (2015110, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015110, 2)
    	and df2:licenses_per_grid Shape: (2015110, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015110, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015110, 2)
    	and df2:licenses_per_grid Shape: (2015110, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015110, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2015110, 9)
    	and df2:n_priority_areas_per_grid Shape: (2015110, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (2015110, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2366454, 53)
    	and df2:points_for_qgis Shape: (373147, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (373152, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (373152, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (373147, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (373147, 43)
    	and df2:data.amanaPopulationOverlay Shape: (2015110, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (373138, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (21776, 17)
    	and df2:n_licenses_per_facility Shape: (21799, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (21776, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (2015110, 20)
    	and df2:grid_level_license_risks Shape: (2015110, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (2015110, 30)
    	and df2:licenses_per_facility Shape: (21776, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (2015110, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (373138, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (373138, 46)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (1980808, 22)

INFO:root:Fetched Inspections_df shape: (2973876, 31)

INFO:root:Fetched/Read Health_df shape: (3797, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (2973876, 31)
    	and df2:Health_df Shape: (3797, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3038366, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (1804980, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (1804980, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (1804964, 67)
    	and df2:Retail_Licenses_medina_df Shape: (1980808, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (1804969, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015110, 13)
INFO:root:Fetched population_grids shape: (2015110, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2015110, 3)
INFO:root:Read pois_licenses_comparison shape: (2015110, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (2973876, 31)
    	and df2:Health_df Shape: (3797, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3038366, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (1804980, 38)
    	and df2:Retail_Licenses_medina_df Shape: (1980808, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3012006, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3012006, 61)
    	and df2:Health_df Shape: (3797, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3088086, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (765035, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2015110, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5484, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2015110, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (12291, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (120327, 73)
    	and df2:predictions_df Shape: (120327, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (120327, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015110, 14)
    	and df2:priority_areas Shape: (1384, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9492, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9492, 2)
    	and df2:population_grids Shape: (2015110, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015110, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:population_grids Shape: (2015110, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015110, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (669214, 32)
    	and df2:geometry_per_grid Shape: (2015110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (669093, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:population_grids Shape: (2015110, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (119866, 78)
    	and df2:population_grids Shape: (2015110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (119860, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13040, 2)
    	and df2:pois_data Shape: (2015110, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13040, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13040, 5)
    	and df2:population_per_grid Shape: (2015110, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13040, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13040, 3)
    	and df2:licenses_per_grid Shape: (13040, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13040, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13040, 9)
    	and df2:geometry_per_grid Shape: (2015110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (13040, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13040, 23)
    	and df2:n_priority_areas_per_grid Shape: (2015110, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (13040, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13040, 3)
    	and df2:licenses_per_grid Shape: (13040, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (13040, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (119860, 94)
    	and df2:points_for_qgis Shape: (119866, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (119866, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (119866, 24)
    	and df2:population_grids Shape: (2015110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (119860, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (13040, 10)
    	and df2:n_licenses_per_facility Shape: (13040, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13040, 11)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (13040, 52)
    	and df2:grid_level_license_risks Shape: (13040, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13040, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (13040, 59)
    	and df2:licenses_per_facility Shape: (13040, 12)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13040, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1384, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015110, 15)
    	and df2:population_grids Shape: (2015110, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (119860, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (119860, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2015110, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (13040, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (13040, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (1982727, 22)

INFO:root:Fetched Inspections_df shape: (2999426, 31)

INFO:root:Fetched/Read Health_df shape: (3797, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (2999426, 31)
    	and df2:Health_df Shape: (3797, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3064527, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (1824191, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (1824191, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (1824175, 67)
    	and df2:Retail_Licenses_medina_df Shape: (1982727, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (1824180, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015110, 13)
INFO:root:Fetched population_grids shape: (2015110, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2015110, 3)
INFO:root:Read pois_licenses_comparison shape: (2015110, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (2999426, 31)
    	and df2:Health_df Shape: (3797, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3064527, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (1824191, 38)
    	and df2:Retail_Licenses_medina_df Shape: (1982727, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3024807, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3024807, 61)
    	and df2:Health_df Shape: (3797, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3101897, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (771370, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2015110, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5484, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2015110, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (12291, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (120665, 73)
    	and df2:predictions_df Shape: (120665, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (120665, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015110, 14)
    	and df2:priority_areas Shape: (1384, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9492, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9492, 2)
    	and df2:population_grids Shape: (2015110, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015110, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:population_grids Shape: (2015110, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015110, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (672272, 32)
    	and df2:geometry_per_grid Shape: (2015110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (672146, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:population_grids Shape: (2015110, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (120205, 78)
    	and df2:population_grids Shape: (2015110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (120199, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13067, 2)
    	and df2:pois_data Shape: (2015110, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13067, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13067, 5)
    	and df2:population_per_grid Shape: (2015110, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13067, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13067, 3)
    	and df2:licenses_per_grid Shape: (13067, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13067, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13067, 9)
    	and df2:geometry_per_grid Shape: (2015110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (13067, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13067, 23)
    	and df2:n_priority_areas_per_grid Shape: (2015110, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (13067, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13067, 3)
    	and df2:licenses_per_grid Shape: (13067, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (13067, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (120199, 94)
    	and df2:points_for_qgis Shape: (120205, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (120205, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (120205, 24)
    	and df2:population_grids Shape: (2015110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (120199, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (13067, 10)
    	and df2:n_licenses_per_facility Shape: (13067, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13067, 11)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (13067, 52)
    	and df2:grid_level_license_risks Shape: (13067, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13067, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (13067, 59)
    	and df2:licenses_per_facility Shape: (13067, 12)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13067, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1384, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015110, 15)
    	and df2:population_grids Shape: (2015110, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (120199, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (120199, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2015110, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (13067, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (13067, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (1983488, 22)

INFO:root:Fetched Inspections_df shape: (3009380, 31)

INFO:root:Fetched/Read Health_df shape: (3797, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3009380, 31)
    	and df2:Health_df Shape: (3797, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3074700, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (1833117, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (1833117, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (1833101, 67)
    	and df2:Retail_Licenses_medina_df Shape: (1983488, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (1833106, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015110, 13)
INFO:root:Fetched population_grids shape: (2015110, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2015110, 3)
INFO:root:Read pois_licenses_comparison shape: (2015110, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3009380, 31)
    	and df2:Health_df Shape: (3797, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3074700, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (1833117, 38)
    	and df2:Retail_Licenses_medina_df Shape: (1983488, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3031113, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3031113, 61)
    	and df2:Health_df Shape: (3797, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3108603, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (774554, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2015110, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5484, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2015110, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (12291, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (120859, 73)
    	and df2:predictions_df Shape: (120859, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (120859, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015110, 14)
    	and df2:priority_areas Shape: (1384, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9492, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9492, 2)
    	and df2:population_grids Shape: (2015110, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015110, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:population_grids Shape: (2015110, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015110, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (673361, 32)
    	and df2:geometry_per_grid Shape: (2015110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (673235, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:population_grids Shape: (2015110, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (120396, 78)
    	and df2:population_grids Shape: (2015110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (120390, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13082, 2)
    	and df2:pois_data Shape: (2015110, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13082, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13082, 5)
    	and df2:population_per_grid Shape: (2015110, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13082, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13082, 3)
    	and df2:licenses_per_grid Shape: (13082, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13082, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13082, 9)
    	and df2:geometry_per_grid Shape: (2015110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (13082, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13082, 23)
    	and df2:n_priority_areas_per_grid Shape: (2015110, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (13082, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13082, 3)
    	and df2:licenses_per_grid Shape: (13082, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (13082, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (120390, 94)
    	and df2:points_for_qgis Shape: (120396, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (120396, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (120396, 24)
    	and df2:population_grids Shape: (2015110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (120390, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (13082, 10)
    	and df2:n_licenses_per_facility Shape: (13082, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13082, 11)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (13082, 52)
    	and df2:grid_level_license_risks Shape: (13082, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13082, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (13082, 59)
    	and df2:licenses_per_facility Shape: (13082, 12)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13082, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1384, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015110, 15)
    	and df2:population_grids Shape: (2015110, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (120390, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (120390, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2015110, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (13082, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (13082, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (1984261, 22)

INFO:root:Fetched Inspections_df shape: (3018044, 31)

INFO:root:Fetched/Read Health_df shape: (3797, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3018044, 31)
    	and df2:Health_df Shape: (3797, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3083621, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (1840514, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (1840514, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (1840498, 67)
    	and df2:Retail_Licenses_medina_df Shape: (1984261, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (1840503, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015110, 13)
INFO:root:Fetched population_grids shape: (2015110, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2015110, 3)
INFO:root:Read pois_licenses_comparison shape: (2015110, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3018044, 31)
    	and df2:Health_df Shape: (3797, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3083621, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (1840514, 38)
    	and df2:Retail_Licenses_medina_df Shape: (1984261, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3036832, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3036832, 61)
    	and df2:Health_df Shape: (3797, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3114710, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (777316, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2015110, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5484, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2015110, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (12291, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (120992, 73)
    	and df2:predictions_df Shape: (120992, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (120992, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015110, 14)
    	and df2:priority_areas Shape: (1384, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9492, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9492, 2)
    	and df2:population_grids Shape: (2015110, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015110, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:population_grids Shape: (2015110, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015110, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (674447, 32)
    	and df2:geometry_per_grid Shape: (2015110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (674321, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:population_grids Shape: (2015110, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (120527, 78)
    	and df2:population_grids Shape: (2015110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (120521, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13085, 2)
    	and df2:pois_data Shape: (2015110, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13085, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13085, 5)
    	and df2:population_per_grid Shape: (2015110, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13085, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13085, 3)
    	and df2:licenses_per_grid Shape: (13085, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13085, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13085, 9)
    	and df2:geometry_per_grid Shape: (2015110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (13085, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13085, 23)
    	and df2:n_priority_areas_per_grid Shape: (2015110, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (13085, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13085, 3)
    	and df2:licenses_per_grid Shape: (13085, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (13085, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (120521, 94)
    	and df2:points_for_qgis Shape: (120527, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (120527, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (120527, 24)
    	and df2:population_grids Shape: (2015110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (120521, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (13085, 10)
    	and df2:n_licenses_per_facility Shape: (13085, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13085, 11)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (13085, 52)
    	and df2:grid_level_license_risks Shape: (13085, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13085, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (13085, 59)
    	and df2:licenses_per_facility Shape: (13085, 12)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13085, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1384, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015110, 15)
    	and df2:population_grids Shape: (2015110, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (120521, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (120521, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2015110, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (13085, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (13085, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (1984954, 22)

INFO:root:Fetched Inspections_df shape: (3023985, 31)

INFO:root:Fetched/Read Health_df shape: (3797, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3023985, 31)
    	and df2:Health_df Shape: (3797, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3089798, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (1845861, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (1845861, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (1845845, 67)
    	and df2:Retail_Licenses_medina_df Shape: (1984954, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (1845850, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015110, 13)
INFO:root:Fetched population_grids shape: (2015110, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2015110, 3)
INFO:root:Read pois_licenses_comparison shape: (2015110, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3023985, 31)
    	and df2:Health_df Shape: (3797, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3089798, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (1845861, 38)
    	and df2:Retail_Licenses_medina_df Shape: (1984954, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3041388, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3041388, 61)
    	and df2:Health_df Shape: (3797, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3119624, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (779418, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2015110, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5484, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2015110, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (12291, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (121096, 73)
    	and df2:predictions_df Shape: (121096, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (121096, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015110, 14)
    	and df2:priority_areas Shape: (1384, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9492, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9492, 2)
    	and df2:population_grids Shape: (2015110, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015110, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:population_grids Shape: (2015110, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015110, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (675377, 32)
    	and df2:geometry_per_grid Shape: (2015110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (675251, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:population_grids Shape: (2015110, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (120631, 78)
    	and df2:population_grids Shape: (2015110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (120625, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13089, 2)
    	and df2:pois_data Shape: (2015110, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13089, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13089, 5)
    	and df2:population_per_grid Shape: (2015110, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13089, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13089, 3)
    	and df2:licenses_per_grid Shape: (13089, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13089, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13089, 9)
    	and df2:geometry_per_grid Shape: (2015110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (13089, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13089, 23)
    	and df2:n_priority_areas_per_grid Shape: (2015110, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (13089, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13089, 3)
    	and df2:licenses_per_grid Shape: (13089, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (13089, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (120625, 94)
    	and df2:points_for_qgis Shape: (120631, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (120631, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (120631, 24)
    	and df2:population_grids Shape: (2015110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (120625, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (13089, 10)
    	and df2:n_licenses_per_facility Shape: (13089, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13089, 11)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (13089, 52)
    	and df2:grid_level_license_risks Shape: (13089, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13089, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (13089, 59)
    	and df2:licenses_per_facility Shape: (13089, 12)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13089, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1384, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015110, 15)
    	and df2:population_grids Shape: (2015110, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (120625, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (120625, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2015110, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (13089, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (13089, 18)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015110, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (2051878, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2592029, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (2015110, 2)
    and df2:n_pois_per_grid Shape: (2015110, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015110, 4)
    and df2:populationsGrids Shape: (2015110, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015110, 5)
    and df2:populationsGrids Shape: (2015110, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1384, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1362229, 11)
    		and df2:licensesKeysDf Shape: (3797, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1362229, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (907064, 17) 
        and df2:licensesDf Shape: (907064, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (511918, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (1808015, 30)
    	and df2:licensesDf Shape: (907064, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1280024, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (374617, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (374617, 25)
    	and df2:xgb_predict_df Shape: (374617, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (374617, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (374617, 28)
    	and df2:licenses_df Shape: (907064, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (374617, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (9492, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (9492, 2)
    	and df2:amanaPopulationOverlay Shape: (2015110, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:amanaPopulationOverlay Shape: (2015110, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (2015110, 14)
    	and predictions_df Shape: (374617, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (2367906, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (2015110, 8)
    	and df2:grid_level_new_businesses Shape: (2015110, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015110, 2)
    	and df2:poiData Shape: (2015110, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015110, 5)
    	and df2:population_per_grid Shape: (2015110, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015110, 2)
    	and df2:licenses_per_grid Shape: (2015110, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015110, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015110, 2)
    	and df2:licenses_per_grid Shape: (2015110, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015110, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2015110, 9)
    	and df2:n_priority_areas_per_grid Shape: (2015110, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (2015110, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2367906, 53)
    	and df2:points_for_qgis Shape: (374617, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (374622, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (374622, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (374617, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (374617, 43)
    	and df2:data.amanaPopulationOverlay Shape: (2015110, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (374607, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (21792, 17)
    	and df2:n_licenses_per_facility Shape: (21814, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (21792, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (2015110, 20)
    	and df2:grid_level_license_risks Shape: (2015110, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (2015110, 30)
    	and df2:licenses_per_facility Shape: (21792, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (2015110, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (374607, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (374607, 46)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (1985484, 22)

INFO:root:Fetched Inspections_df shape: (3028783, 31)

INFO:root:Fetched/Read Health_df shape: (3797, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3028783, 31)
    	and df2:Health_df Shape: (3797, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3094771, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (1848902, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (1848902, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (1848886, 67)
    	and df2:Retail_Licenses_medina_df Shape: (1985484, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (1848891, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015110, 13)
INFO:root:Fetched population_grids shape: (2015110, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2015110, 3)
INFO:root:Read pois_licenses_comparison shape: (2015110, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3028783, 31)
    	and df2:Health_df Shape: (3797, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3094771, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (1848902, 38)
    	and df2:Retail_Licenses_medina_df Shape: (1985484, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3044099, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3044099, 61)
    	and df2:Health_df Shape: (3797, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3122527, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (780545, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2015110, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5484, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2015110, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (12291, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (121103, 73)
    	and df2:predictions_df Shape: (121103, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (121103, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015110, 14)
    	and df2:priority_areas Shape: (1384, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9492, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9492, 2)
    	and df2:population_grids Shape: (2015110, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015110, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:population_grids Shape: (2015110, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015110, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (677094, 32)
    	and df2:geometry_per_grid Shape: (2015110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (676969, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:population_grids Shape: (2015110, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (120636, 78)
    	and df2:population_grids Shape: (2015110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (120630, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13095, 2)
    	and df2:pois_data Shape: (2015110, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13095, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13095, 5)
    	and df2:population_per_grid Shape: (2015110, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13095, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13095, 3)
    	and df2:licenses_per_grid Shape: (13095, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13095, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13095, 9)
    	and df2:geometry_per_grid Shape: (2015110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (13095, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13095, 23)
    	and df2:n_priority_areas_per_grid Shape: (2015110, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (13095, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13095, 3)
    	and df2:licenses_per_grid Shape: (13095, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (13095, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (120630, 94)
    	and df2:points_for_qgis Shape: (120636, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (120636, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (120636, 24)
    	and df2:population_grids Shape: (2015110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (120630, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (13095, 10)
    	and df2:n_licenses_per_facility Shape: (13095, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13095, 11)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (13095, 52)
    	and df2:grid_level_license_risks Shape: (13095, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13095, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (13095, 59)
    	and df2:licenses_per_facility Shape: (13095, 12)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13095, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1384, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015110, 15)
    	and df2:population_grids Shape: (2015110, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (120630, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (120630, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2015110, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (13095, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (13095, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (1986302, 22)

INFO:root:Fetched Inspections_df shape: (3040784, 31)

INFO:root:Fetched/Read Health_df shape: (3797, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3040784, 31)
    	and df2:Health_df Shape: (3797, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3107114, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (1856576, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (1856576, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (1856560, 67)
    	and df2:Retail_Licenses_medina_df Shape: (1986302, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (1856565, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015110, 13)
INFO:root:Fetched population_grids shape: (2015110, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2015110, 3)
INFO:root:Read pois_licenses_comparison shape: (2015110, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3040784, 31)
    	and df2:Health_df Shape: (3797, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3107114, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (1856576, 38)
    	and df2:Retail_Licenses_medina_df Shape: (1986302, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3050277, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3050277, 61)
    	and df2:Health_df Shape: (3797, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3129129, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (784326, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2015110, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5484, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2015110, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (12291, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (121592, 73)
    	and df2:predictions_df Shape: (121592, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (121592, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015110, 14)
    	and df2:priority_areas Shape: (1384, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9492, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9492, 2)
    	and df2:population_grids Shape: (2015110, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015110, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:population_grids Shape: (2015110, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015110, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (678159, 32)
    	and df2:geometry_per_grid Shape: (2015110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (678035, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:population_grids Shape: (2015110, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (121126, 78)
    	and df2:population_grids Shape: (2015110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (121120, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13115, 2)
    	and df2:pois_data Shape: (2015110, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13115, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13115, 5)
    	and df2:population_per_grid Shape: (2015110, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13115, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13115, 3)
    	and df2:licenses_per_grid Shape: (13115, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13115, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13115, 9)
    	and df2:geometry_per_grid Shape: (2015110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (13115, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13115, 23)
    	and df2:n_priority_areas_per_grid Shape: (2015110, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (13115, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13115, 3)
    	and df2:licenses_per_grid Shape: (13115, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (13115, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (121120, 94)
    	and df2:points_for_qgis Shape: (121126, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (121126, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (121126, 24)
    	and df2:population_grids Shape: (2015110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (121120, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (13115, 10)
    	and df2:n_licenses_per_facility Shape: (13115, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13115, 11)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (13115, 52)
    	and df2:grid_level_license_risks Shape: (13115, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13115, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (13115, 59)
    	and df2:licenses_per_facility Shape: (13115, 12)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13115, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1384, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015110, 15)
    	and df2:population_grids Shape: (2015110, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (121120, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (121120, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2015110, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (13115, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (13115, 18)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015110, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (2051878, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2594744, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (2015110, 2)
    and df2:n_pois_per_grid Shape: (2015110, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015110, 4)
    and df2:populationsGrids Shape: (2015110, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015110, 5)
    and df2:populationsGrids Shape: (2015110, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1384, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1365081, 11)
    		and df2:licensesKeysDf Shape: (3797, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1365081, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (908669, 17) 
        and df2:licensesDf Shape: (908669, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (520023, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (1832427, 30)
    	and df2:licensesDf Shape: (908669, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1288471, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (376266, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (376266, 25)
    	and df2:xgb_predict_df Shape: (376266, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (376266, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (376266, 28)
    	and df2:licenses_df Shape: (908669, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (376266, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (9492, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (9492, 2)
    	and df2:amanaPopulationOverlay Shape: (2015110, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:amanaPopulationOverlay Shape: (2015110, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (2015110, 14)
    	and predictions_df Shape: (376266, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (2369502, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (2015110, 8)
    	and df2:grid_level_new_businesses Shape: (2015110, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015110, 2)
    	and df2:poiData Shape: (2015110, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015110, 5)
    	and df2:population_per_grid Shape: (2015110, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015110, 2)
    	and df2:licenses_per_grid Shape: (2015110, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015110, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015110, 2)
    	and df2:licenses_per_grid Shape: (2015110, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015110, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2015110, 9)
    	and df2:n_priority_areas_per_grid Shape: (2015110, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (2015110, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2369502, 53)
    	and df2:points_for_qgis Shape: (376266, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (376271, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (376271, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (376266, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (376266, 43)
    	and df2:data.amanaPopulationOverlay Shape: (2015110, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (376256, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (21847, 17)
    	and df2:n_licenses_per_facility Shape: (21869, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (21847, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (2015110, 20)
    	and df2:grid_level_license_risks Shape: (2015110, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (2015110, 30)
    	and df2:licenses_per_facility Shape: (21847, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (2015110, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (376256, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (376256, 46)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015110, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (2051878, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2593992, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (2015110, 2)
    and df2:n_pois_per_grid Shape: (2015110, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015110, 4)
    and df2:populationsGrids Shape: (2015110, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015110, 5)
    and df2:populationsGrids Shape: (2015110, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1384, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1365081, 11)
    		and df2:licensesKeysDf Shape: (3797, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1365081, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (908669, 17) 
        and df2:licensesDf Shape: (908669, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (520023, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (1832427, 30)
    	and df2:licensesDf Shape: (908669, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1288471, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (375795, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (375795, 25)
    	and df2:xgb_predict_df Shape: (375795, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (375795, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (375795, 28)
    	and df2:licenses_df Shape: (908669, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (375795, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (9492, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (9492, 2)
    	and df2:amanaPopulationOverlay Shape: (2015110, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:amanaPopulationOverlay Shape: (2015110, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (2015110, 14)
    	and predictions_df Shape: (375795, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (2369041, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (2015110, 8)
    	and df2:grid_level_new_businesses Shape: (2015110, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015110, 2)
    	and df2:poiData Shape: (2015110, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015110, 5)
    	and df2:population_per_grid Shape: (2015110, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015110, 2)
    	and df2:licenses_per_grid Shape: (2015110, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015110, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015110, 2)
    	and df2:licenses_per_grid Shape: (2015110, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015110, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2015110, 9)
    	and df2:n_priority_areas_per_grid Shape: (2015110, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (2015110, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2369041, 53)
    	and df2:points_for_qgis Shape: (375795, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (375800, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (375800, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (375795, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (375795, 43)
    	and df2:data.amanaPopulationOverlay Shape: (2015110, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (375785, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (21837, 17)
    	and df2:n_licenses_per_facility Shape: (21859, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (21837, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (2015110, 20)
    	and df2:grid_level_license_risks Shape: (2015110, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (2015110, 30)
    	and df2:licenses_per_facility Shape: (21837, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (2015110, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (375785, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (375785, 46)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (1988694, 22)

INFO:root:Fetched Inspections_df shape: (3072755, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3072755, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3140285, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (1878904, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (1878904, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (1878888, 67)
    	and df2:Retail_Licenses_medina_df Shape: (1988694, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (1878895, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015110, 13)
INFO:root:Fetched population_grids shape: (2015110, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2015110, 3)
INFO:root:Read pois_licenses_comparison shape: (2015110, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3072755, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3140285, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (1878904, 38)
    	and df2:Retail_Licenses_medina_df Shape: (1988694, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3068636, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3068636, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3149092, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (794678, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2015110, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5484, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2015110, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (12291, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (122722, 73)
    	and df2:predictions_df Shape: (122722, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (122722, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015110, 14)
    	and df2:priority_areas Shape: (1384, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9492, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9492, 2)
    	and df2:population_grids Shape: (2015110, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015110, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:population_grids Shape: (2015110, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015110, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (682305, 32)
    	and df2:geometry_per_grid Shape: (2015110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (682181, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:population_grids Shape: (2015110, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (122253, 78)
    	and df2:population_grids Shape: (2015110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (122247, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13169, 2)
    	and df2:pois_data Shape: (2015110, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13169, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13169, 5)
    	and df2:population_per_grid Shape: (2015110, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13169, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13169, 3)
    	and df2:licenses_per_grid Shape: (13169, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13169, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13169, 9)
    	and df2:geometry_per_grid Shape: (2015110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (13169, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13169, 23)
    	and df2:n_priority_areas_per_grid Shape: (2015110, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (13169, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13169, 3)
    	and df2:licenses_per_grid Shape: (13169, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (13169, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (122247, 94)
    	and df2:points_for_qgis Shape: (122253, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (122253, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (122253, 24)
    	and df2:population_grids Shape: (2015110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (122247, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (13169, 10)
    	and df2:n_licenses_per_facility Shape: (13169, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13169, 11)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (13169, 52)
    	and df2:grid_level_license_risks Shape: (13169, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13169, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (13169, 59)
    	and df2:licenses_per_facility Shape: (13169, 12)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13169, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1384, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015110, 15)
    	and df2:population_grids Shape: (2015110, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (122247, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (122247, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2015110, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (13169, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (13169, 18)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015110, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (2051878, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2595493, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (2015110, 2)
    and df2:n_pois_per_grid Shape: (2015110, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015110, 4)
    and df2:populationsGrids Shape: (2015110, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015110, 5)
    and df2:populationsGrids Shape: (2015110, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1384, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1366366, 11)
    		and df2:licensesKeysDf Shape: (3800, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1366366, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (909580, 17) 
        and df2:licensesDf Shape: (909580, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (524003, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (1844006, 30)
    	and df2:licensesDf Shape: (909580, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1292666, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (376890, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (376890, 25)
    	and df2:xgb_predict_df Shape: (376890, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (376890, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (376890, 28)
    	and df2:licenses_df Shape: (909580, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (376890, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (9492, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (9492, 2)
    	and df2:amanaPopulationOverlay Shape: (2015110, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:amanaPopulationOverlay Shape: (2015110, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (2015110, 14)
    	and predictions_df Shape: (376890, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (2370111, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (2015110, 8)
    	and df2:grid_level_new_businesses Shape: (2015110, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015110, 2)
    	and df2:poiData Shape: (2015110, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015110, 5)
    	and df2:population_per_grid Shape: (2015110, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015110, 2)
    	and df2:licenses_per_grid Shape: (2015110, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015110, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015110, 2)
    	and df2:licenses_per_grid Shape: (2015110, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015110, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2015110, 9)
    	and df2:n_priority_areas_per_grid Shape: (2015110, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (2015110, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2370111, 53)
    	and df2:points_for_qgis Shape: (376890, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (376895, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (376895, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (376890, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (376890, 43)
    	and df2:data.amanaPopulationOverlay Shape: (2015110, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (376880, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (21862, 17)
    	and df2:n_licenses_per_facility Shape: (21884, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (21862, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (2015110, 20)
    	and df2:grid_level_license_risks Shape: (2015110, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (2015110, 30)
    	and df2:licenses_per_facility Shape: (21862, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (2015110, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (376880, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (376880, 46)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (1989480, 22)

INFO:root:Fetched Inspections_df shape: (3081781, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3081781, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3149528, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (1885777, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (1885777, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (1885761, 67)
    	and df2:Retail_Licenses_medina_df Shape: (1989480, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (1885768, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015110, 13)
INFO:root:Fetched population_grids shape: (2015110, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2015110, 3)
INFO:root:Read pois_licenses_comparison shape: (2015110, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3081781, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3149528, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (1885777, 38)
    	and df2:Retail_Licenses_medina_df Shape: (1989480, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3074491, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3074491, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3155289, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (798314, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2015110, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5484, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2015110, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (12291, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (123088, 73)
    	and df2:predictions_df Shape: (123088, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (123088, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015110, 14)
    	and df2:priority_areas Shape: (1384, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9492, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9492, 2)
    	and df2:population_grids Shape: (2015110, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015110, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:population_grids Shape: (2015110, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015110, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (683153, 32)
    	and df2:geometry_per_grid Shape: (2015110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (683029, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:population_grids Shape: (2015110, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (122619, 78)
    	and df2:population_grids Shape: (2015110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (122613, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13192, 2)
    	and df2:pois_data Shape: (2015110, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13192, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13192, 5)
    	and df2:population_per_grid Shape: (2015110, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13192, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13192, 3)
    	and df2:licenses_per_grid Shape: (13192, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13192, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13192, 9)
    	and df2:geometry_per_grid Shape: (2015110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (13192, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13192, 23)
    	and df2:n_priority_areas_per_grid Shape: (2015110, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (13192, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13192, 3)
    	and df2:licenses_per_grid Shape: (13192, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (13192, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (122613, 94)
    	and df2:points_for_qgis Shape: (122619, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (122619, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (122619, 24)
    	and df2:population_grids Shape: (2015110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (122613, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (13192, 10)
    	and df2:n_licenses_per_facility Shape: (13192, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13192, 11)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (13192, 52)
    	and df2:grid_level_license_risks Shape: (13192, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13192, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (13192, 59)
    	and df2:licenses_per_facility Shape: (13192, 12)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13192, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1384, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015110, 15)
    	and df2:population_grids Shape: (2015110, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (122613, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (122613, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2015110, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (13192, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (13192, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (1990405, 22)

INFO:root:Fetched Inspections_df shape: (3099808, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3099808, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3167967, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (1894892, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (1894892, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (1894876, 67)
    	and df2:Retail_Licenses_medina_df Shape: (1990405, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (1894883, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1235032, 13)
INFO:root:Fetched population_grids shape: (1235032, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1235032, 3)
INFO:root:Read pois_licenses_comparison shape: (1235032, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3099808, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3167967, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (1894892, 38)
    	and df2:Retail_Licenses_medina_df Shape: (1990405, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3082067, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3082067, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3163427, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (802972, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1235032, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (4816, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1235032, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (10652, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (123423, 73)
    	and df2:predictions_df Shape: (123423, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (123423, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1235032, 14)
    	and df2:priority_areas Shape: (1384, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (7963, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (7963, 2)
    	and df2:population_grids Shape: (1235032, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1235032, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1235032, 7)
    	and df2:population_grids Shape: (1235032, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1235032, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (685282, 32)
    	and df2:geometry_per_grid Shape: (1235032, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (562263, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1235032, 7)
    	and df2:population_grids Shape: (1235032, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (1235032, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (122956, 78)
    	and df2:population_grids Shape: (1235032, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (101602, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (9665, 2)
    	and df2:pois_data Shape: (1235032, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (9665, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (9665, 5)
    	and df2:population_per_grid Shape: (1235032, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (9665, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (9665, 3)
    	and df2:licenses_per_grid Shape: (9665, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (9665, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (9665, 9)
    	and df2:geometry_per_grid Shape: (1235032, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (9665, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (9665, 23)
    	and df2:n_priority_areas_per_grid Shape: (1235032, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (9665, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (9665, 3)
    	and df2:licenses_per_grid Shape: (9665, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (9665, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (101602, 94)
    	and df2:points_for_qgis Shape: (122956, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (122956, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (122956, 24)
    	and df2:population_grids Shape: (1235032, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (101602, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (9665, 10)
    	and df2:n_licenses_per_facility Shape: (9665, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (9665, 11)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (9665, 52)
    	and df2:grid_level_license_risks Shape: (9665, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (9665, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (9665, 59)
    	and df2:licenses_per_facility Shape: (9665, 12)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (9665, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1384, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1235032, 15)
    	and df2:population_grids Shape: (1235032, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (1235032, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (101602, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (101602, 28)
    
INFO:root:OUTPUT tooltip_df shape: (1235032, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (9665, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (9665, 18)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015110, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (2051878, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2596424, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (2015110, 2)
    and df2:n_pois_per_grid Shape: (2015110, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015110, 4)
    and df2:populationsGrids Shape: (2015110, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015110, 5)
    and df2:populationsGrids Shape: (2015110, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1384, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1368849, 11)
    		and df2:licensesKeysDf Shape: (3800, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1368849, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (910988, 17) 
        and df2:licensesDf Shape: (910988, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (531021, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (1867341, 30)
    	and df2:licensesDf Shape: (910988, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1300005, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (377435, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (377435, 25)
    	and df2:xgb_predict_df Shape: (377435, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (377435, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (377435, 28)
    	and df2:licenses_df Shape: (910988, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (377435, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (9492, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (9492, 2)
    	and df2:amanaPopulationOverlay Shape: (2015110, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:amanaPopulationOverlay Shape: (2015110, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (2015110, 14)
    	and predictions_df Shape: (377435, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (2370643, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (2015110, 8)
    	and df2:grid_level_new_businesses Shape: (2015110, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015110, 2)
    	and df2:poiData Shape: (2015110, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015110, 5)
    	and df2:population_per_grid Shape: (2015110, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015110, 2)
    	and df2:licenses_per_grid Shape: (2015110, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015110, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015110, 2)
    	and df2:licenses_per_grid Shape: (2015110, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015110, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2015110, 9)
    	and df2:n_priority_areas_per_grid Shape: (2015110, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (2015110, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2370643, 53)
    	and df2:points_for_qgis Shape: (377435, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (377440, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (377440, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (377435, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (377435, 43)
    	and df2:data.amanaPopulationOverlay Shape: (2015110, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (377425, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (21874, 17)
    	and df2:n_licenses_per_facility Shape: (21896, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (21874, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (2015110, 20)
    	and df2:grid_level_license_risks Shape: (2015110, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (2015110, 30)
    	and df2:licenses_per_facility Shape: (21874, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (2015110, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (377425, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (377425, 46)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (1993299, 22)

INFO:root:Fetched Inspections_df shape: (3132000, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3132000, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3201321, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (1920719, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (1920719, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (1920703, 67)
    	and df2:Retail_Licenses_medina_df Shape: (1993299, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (1920710, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015110, 13)
INFO:root:Fetched population_grids shape: (2015110, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2015110, 3)
INFO:root:Read pois_licenses_comparison shape: (2015110, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3132000, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3201321, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (1920719, 38)
    	and df2:Retail_Licenses_medina_df Shape: (1993299, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3104203, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3104203, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3187199, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (816189, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2015110, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5484, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2015110, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (12291, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (124718, 73)
    	and df2:predictions_df Shape: (124718, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (124718, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015110, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9508, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9508, 2)
    	and df2:population_grids Shape: (2015110, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015110, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:population_grids Shape: (2015110, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015110, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (689286, 32)
    	and df2:geometry_per_grid Shape: (2015110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (689163, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:population_grids Shape: (2015110, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (124251, 78)
    	and df2:population_grids Shape: (2015110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (124245, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13279, 2)
    	and df2:pois_data Shape: (2015110, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13279, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13279, 5)
    	and df2:population_per_grid Shape: (2015110, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13279, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13279, 3)
    	and df2:licenses_per_grid Shape: (13279, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13279, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13279, 9)
    	and df2:geometry_per_grid Shape: (2015110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (13279, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13279, 23)
    	and df2:n_priority_areas_per_grid Shape: (2015110, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (13279, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13279, 3)
    	and df2:licenses_per_grid Shape: (13279, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (13279, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (124245, 94)
    	and df2:points_for_qgis Shape: (124251, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (124251, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (124251, 24)
    	and df2:population_grids Shape: (2015110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (124245, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (13279, 10)
    	and df2:n_licenses_per_facility Shape: (13279, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13279, 11)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (13279, 52)
    	and df2:grid_level_license_risks Shape: (13279, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13279, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (13279, 59)
    	and df2:licenses_per_facility Shape: (13279, 12)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13279, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1389, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015110, 15)
    	and df2:population_grids Shape: (2015110, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (124245, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (124245, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2015110, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (13279, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (13279, 18)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015110, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (2051878, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2597270, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (2015110, 2)
    and df2:n_pois_per_grid Shape: (2015110, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015110, 4)
    and df2:populationsGrids Shape: (2015110, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015110, 5)
    and df2:populationsGrids Shape: (2015110, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1389, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1370483, 11)
    		and df2:licensesKeysDf Shape: (3800, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1370483, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (911933, 17) 
        and df2:licensesDf Shape: (911933, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (535407, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (1881186, 30)
    	and df2:licensesDf Shape: (911933, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1304543, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (377844, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (377844, 25)
    	and df2:xgb_predict_df Shape: (377844, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (377844, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (377844, 28)
    	and df2:licenses_df Shape: (911933, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (377844, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (9508, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (9508, 2)
    	and df2:amanaPopulationOverlay Shape: (2015110, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:amanaPopulationOverlay Shape: (2015110, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (2015110, 14)
    	and predictions_df Shape: (377844, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (2371040, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (2015110, 8)
    	and df2:grid_level_new_businesses Shape: (2015110, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015110, 2)
    	and df2:poiData Shape: (2015110, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015110, 5)
    	and df2:population_per_grid Shape: (2015110, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015110, 2)
    	and df2:licenses_per_grid Shape: (2015110, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015110, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015110, 2)
    	and df2:licenses_per_grid Shape: (2015110, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015110, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2015110, 9)
    	and df2:n_priority_areas_per_grid Shape: (2015110, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (2015110, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2371040, 53)
    	and df2:points_for_qgis Shape: (377844, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (377849, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (377849, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (377844, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (377844, 43)
    	and df2:data.amanaPopulationOverlay Shape: (2015110, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (377834, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (21886, 17)
    	and df2:n_licenses_per_facility Shape: (21908, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (21886, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (2015110, 20)
    	and df2:grid_level_license_risks Shape: (2015110, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (2015110, 30)
    	and df2:licenses_per_facility Shape: (21886, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (2015110, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (377834, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (377834, 46)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (1993299, 22)

INFO:root:Fetched Inspections_df shape: (3133699, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3133699, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3203063, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (1922552, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (1922552, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (1922536, 67)
    	and df2:Retail_Licenses_medina_df Shape: (1993299, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (1922543, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015110, 13)
INFO:root:Fetched population_grids shape: (2015110, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2015110, 3)
INFO:root:Read pois_licenses_comparison shape: (2015110, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3133699, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3203063, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (1922552, 38)
    	and df2:Retail_Licenses_medina_df Shape: (1993299, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3105545, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3105545, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3188613, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (817239, 68)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (1994887, 22)

INFO:root:Fetched Inspections_df shape: (3152645, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3152645, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3222794, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (1937907, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (1937907, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (1937891, 67)
    	and df2:Retail_Licenses_medina_df Shape: (1994887, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (1937898, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015110, 13)
INFO:root:Fetched population_grids shape: (2015110, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2015110, 3)
INFO:root:Read pois_licenses_comparison shape: (2015110, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3152645, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3222794, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (1937907, 38)
    	and df2:Retail_Licenses_medina_df Shape: (1994887, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3118718, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3118718, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3203062, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (824982, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2015110, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5484, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2015110, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (12291, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (125466, 73)
    	and df2:predictions_df Shape: (125466, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (125466, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015110, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9508, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9508, 2)
    	and df2:population_grids Shape: (2015110, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015110, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:population_grids Shape: (2015110, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015110, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (691975, 32)
    	and df2:geometry_per_grid Shape: (2015110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (691852, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:population_grids Shape: (2015110, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (124996, 78)
    	and df2:population_grids Shape: (2015110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (124990, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13329, 2)
    	and df2:pois_data Shape: (2015110, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13329, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13329, 5)
    	and df2:population_per_grid Shape: (2015110, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13329, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13329, 3)
    	and df2:licenses_per_grid Shape: (13329, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13329, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13329, 9)
    	and df2:geometry_per_grid Shape: (2015110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (13329, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13329, 23)
    	and df2:n_priority_areas_per_grid Shape: (2015110, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (13329, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13329, 3)
    	and df2:licenses_per_grid Shape: (13329, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (13329, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (124990, 94)
    	and df2:points_for_qgis Shape: (124996, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (124996, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (124996, 24)
    	and df2:population_grids Shape: (2015110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (124990, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (13329, 10)
    	and df2:n_licenses_per_facility Shape: (13329, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13329, 11)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (13329, 52)
    	and df2:grid_level_license_risks Shape: (13329, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13329, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (13329, 59)
    	and df2:licenses_per_facility Shape: (13329, 12)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13329, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1389, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015110, 15)
    	and df2:population_grids Shape: (2015110, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (124990, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (124990, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2015110, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (13329, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (13329, 18)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015110, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (2051878, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2598324, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (2015110, 2)
    and df2:n_pois_per_grid Shape: (2015110, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015110, 4)
    and df2:populationsGrids Shape: (2015110, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015110, 5)
    and df2:populationsGrids Shape: (2015110, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1389, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1372761, 11)
    		and df2:licensesKeysDf Shape: (3800, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1372761, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (913245, 17) 
        and df2:licensesDf Shape: (913245, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (542346, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (1901600, 30)
    	and df2:licensesDf Shape: (913245, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1311453, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (378315, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (378315, 25)
    	and df2:xgb_predict_df Shape: (378315, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (378315, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (378315, 28)
    	and df2:licenses_df Shape: (913245, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (378315, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (9508, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (9508, 2)
    	and df2:amanaPopulationOverlay Shape: (2015110, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:amanaPopulationOverlay Shape: (2015110, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (2015110, 14)
    	and predictions_df Shape: (378315, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (2371510, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (2015110, 8)
    	and df2:grid_level_new_businesses Shape: (2015110, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015110, 2)
    	and df2:poiData Shape: (2015110, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015110, 5)
    	and df2:population_per_grid Shape: (2015110, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015110, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015110, 2)
    	and df2:licenses_per_grid Shape: (2015110, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015110, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015110, 2)
    	and df2:licenses_per_grid Shape: (2015110, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015110, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2015110, 9)
    	and df2:n_priority_areas_per_grid Shape: (2015110, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (2015110, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2371510, 53)
    	and df2:points_for_qgis Shape: (378315, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (378320, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (378320, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (378315, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (378315, 43)
    	and df2:data.amanaPopulationOverlay Shape: (2015110, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (378305, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (21886, 17)
    	and df2:n_licenses_per_facility Shape: (21908, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (21886, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (2015110, 20)
    	and df2:grid_level_license_risks Shape: (2015110, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (2015110, 30)
    	and df2:licenses_per_facility Shape: (21886, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (2015110, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (378305, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (378305, 46)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (1996163, 22)

INFO:root:Fetched Inspections_df shape: (3165672, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3165672, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3236408, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (1949192, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (1949192, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (1949176, 67)
    	and df2:Retail_Licenses_medina_df Shape: (1996163, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (1949183, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015110, 13)
INFO:root:Fetched population_grids shape: (2015110, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2015110, 3)
INFO:root:Read pois_licenses_comparison shape: (2015110, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3165672, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3236408, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (1949192, 38)
    	and df2:Retail_Licenses_medina_df Shape: (1996163, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3128842, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3128842, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3214112, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (830972, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2015110, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5484, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2015110, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (12291, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (125970, 73)
    	and df2:predictions_df Shape: (125970, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (125970, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015110, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9508, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9508, 2)
    	and df2:population_grids Shape: (2015110, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015110, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:population_grids Shape: (2015110, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015110, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (694382, 32)
    	and df2:geometry_per_grid Shape: (2015110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (694257, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:population_grids Shape: (2015110, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (125495, 78)
    	and df2:population_grids Shape: (2015110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (125489, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13348, 2)
    	and df2:pois_data Shape: (2015110, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13348, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13348, 5)
    	and df2:population_per_grid Shape: (2015110, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13348, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13348, 3)
    	and df2:licenses_per_grid Shape: (13348, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13348, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13348, 9)
    	and df2:geometry_per_grid Shape: (2015110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (13348, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13348, 23)
    	and df2:n_priority_areas_per_grid Shape: (2015110, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (13348, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13348, 3)
    	and df2:licenses_per_grid Shape: (13348, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (13348, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (125489, 94)
    	and df2:points_for_qgis Shape: (125495, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (125495, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (125495, 24)
    	and df2:population_grids Shape: (2015110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (125489, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (13348, 10)
    	and df2:n_licenses_per_facility Shape: (13348, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13348, 11)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (13348, 52)
    	and df2:grid_level_license_risks Shape: (13348, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13348, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (13348, 59)
    	and df2:licenses_per_facility Shape: (13348, 12)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13348, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1389, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015110, 15)
    	and df2:population_grids Shape: (2015110, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (125489, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (125489, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2015110, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (13348, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (13348, 18)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015110, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (2051878, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2015110, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (2015110, 2)
    and df2:n_pois_per_grid Shape: (2015110, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015110, 4)
    and df2:populationsGrids Shape: (2015110, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015110, 5)
    and df2:populationsGrids Shape: (2015110, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015110, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1389, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (0, 11)
    		and df2:licensesKeysDf Shape: (3800, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (0, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (0, 17) 
        and df2:licensesDf Shape: (0, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (0, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (1996770, 22)

INFO:root:Fetched Inspections_df shape: (3165672, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3165672, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3236408, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (1949192, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (1949192, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (1949176, 67)
    	and df2:Retail_Licenses_medina_df Shape: (1996770, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (1949183, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015110, 13)
INFO:root:Fetched population_grids shape: (2015110, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2015110, 3)
INFO:root:Read pois_licenses_comparison shape: (2015110, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3165672, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3236408, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (1949192, 38)
    	and df2:Retail_Licenses_medina_df Shape: (1996770, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3129449, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3129449, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3214719, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (830972, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2015110, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5484, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2015110, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (12291, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (125953, 73)
    	and df2:predictions_df Shape: (125953, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (125953, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015110, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9508, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9508, 2)
    	and df2:population_grids Shape: (2015110, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015110, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:population_grids Shape: (2015110, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015110, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (695290, 32)
    	and df2:geometry_per_grid Shape: (2015110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (695165, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015110, 7)
    	and df2:population_grids Shape: (2015110, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015110, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (125478, 78)
    	and df2:population_grids Shape: (2015110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (125472, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13346, 2)
    	and df2:pois_data Shape: (2015110, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13346, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13346, 5)
    	and df2:population_per_grid Shape: (2015110, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13346, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13346, 3)
    	and df2:licenses_per_grid Shape: (13346, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13346, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13346, 9)
    	and df2:geometry_per_grid Shape: (2015110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (13346, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13346, 23)
    	and df2:n_priority_areas_per_grid Shape: (2015110, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (13346, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13346, 3)
    	and df2:licenses_per_grid Shape: (13346, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (13346, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (125472, 94)
    	and df2:points_for_qgis Shape: (125478, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (125478, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (125478, 24)
    	and df2:population_grids Shape: (2015110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (125472, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (13346, 10)
    	and df2:n_licenses_per_facility Shape: (13346, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13346, 11)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (13346, 52)
    	and df2:grid_level_license_risks Shape: (13346, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13346, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (13346, 59)
    	and df2:licenses_per_facility Shape: (13346, 12)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13346, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1389, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015110, 15)
    	and df2:population_grids Shape: (2015110, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015110, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (125472, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (125472, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2015110, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (13346, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (13346, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (1997046, 22)

INFO:root:Fetched Inspections_df shape: (3170141, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3170141, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3241107, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (1953935, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (1953935, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (1953919, 67)
    	and df2:Retail_Licenses_medina_df Shape: (1997046, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (1953926, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2014110, 13)
INFO:root:Fetched population_grids shape: (2014110, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2014110, 3)
INFO:root:Read pois_licenses_comparison shape: (2014110, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3170141, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3241107, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (1953935, 38)
    	and df2:Retail_Licenses_medina_df Shape: (1997046, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3133559, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3133559, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3219183, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (833425, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2014110, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5280, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2014110, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (11542, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (126141, 73)
    	and df2:predictions_df Shape: (126141, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (126141, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2014110, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9356, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9356, 2)
    	and df2:population_grids Shape: (2014110, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2014110, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2014110, 7)
    	and df2:population_grids Shape: (2014110, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2014110, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (696118, 32)
    	and df2:geometry_per_grid Shape: (2014110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (685609, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2014110, 7)
    	and df2:population_grids Shape: (2014110, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2014110, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (125666, 78)
    	and df2:population_grids Shape: (2014110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (123250, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13184, 2)
    	and df2:pois_data Shape: (2014110, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13184, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13184, 5)
    	and df2:population_per_grid Shape: (2014110, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13184, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13184, 3)
    	and df2:licenses_per_grid Shape: (13184, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13184, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13184, 9)
    	and df2:geometry_per_grid Shape: (2014110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (13184, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13184, 23)
    	and df2:n_priority_areas_per_grid Shape: (2014110, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (13184, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13184, 3)
    	and df2:licenses_per_grid Shape: (13184, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (13184, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (123250, 94)
    	and df2:points_for_qgis Shape: (125666, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (125666, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (125666, 24)
    	and df2:population_grids Shape: (2014110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (123250, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (13184, 10)
    	and df2:n_licenses_per_facility Shape: (13184, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13184, 11)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (13184, 52)
    	and df2:grid_level_license_risks Shape: (13184, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13184, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (13184, 59)
    	and df2:licenses_per_facility Shape: (13184, 12)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13184, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1389, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2014110, 15)
    	and df2:population_grids Shape: (2014110, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2014110, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (123250, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (123250, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2014110, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (13184, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (13184, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (1997327, 22)

INFO:root:Fetched Inspections_df shape: (3175064, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3175064, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3246187, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (1958017, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (1958017, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (1958001, 67)
    	and df2:Retail_Licenses_medina_df Shape: (1997327, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (1958008, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2014110, 13)
INFO:root:Fetched population_grids shape: (2014110, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2014110, 3)
INFO:root:Read pois_licenses_comparison shape: (2014110, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3175064, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3246187, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (1958017, 38)
    	and df2:Retail_Licenses_medina_df Shape: (1997327, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3137002, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3137002, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3222878, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (835697, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2014110, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5280, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2014110, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (11542, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (126260, 73)
    	and df2:predictions_df Shape: (126260, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (126260, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2014110, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9356, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9356, 2)
    	and df2:population_grids Shape: (2014110, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2014110, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2014110, 7)
    	and df2:population_grids Shape: (2014110, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2014110, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (696906, 32)
    	and df2:geometry_per_grid Shape: (2014110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (686392, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2014110, 7)
    	and df2:population_grids Shape: (2014110, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2014110, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (125784, 78)
    	and df2:population_grids Shape: (2014110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (123368, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13193, 2)
    	and df2:pois_data Shape: (2014110, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13193, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13193, 5)
    	and df2:population_per_grid Shape: (2014110, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13193, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13193, 3)
    	and df2:licenses_per_grid Shape: (13193, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13193, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13193, 9)
    	and df2:geometry_per_grid Shape: (2014110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (13193, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13193, 23)
    	and df2:n_priority_areas_per_grid Shape: (2014110, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (13193, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13193, 3)
    	and df2:licenses_per_grid Shape: (13193, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (13193, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (123368, 94)
    	and df2:points_for_qgis Shape: (125784, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (125784, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (125784, 24)
    	and df2:population_grids Shape: (2014110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (123368, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (13193, 10)
    	and df2:n_licenses_per_facility Shape: (13193, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13193, 11)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (13193, 52)
    	and df2:grid_level_license_risks Shape: (13193, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13193, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (13193, 59)
    	and df2:licenses_per_facility Shape: (13193, 12)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13193, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1389, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2014110, 15)
    	and df2:population_grids Shape: (2014110, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2014110, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (123368, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (123368, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2014110, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (13193, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (13193, 18)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2014110, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (2014110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (2049622, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (2014110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2590228, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (2014110, 2)
    and df2:n_pois_per_grid Shape: (2014110, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2014110, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2014110, 4)
    and df2:populationsGrids Shape: (2014110, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2014110, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2014110, 5)
    and df2:populationsGrids Shape: (2014110, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2014110, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1389, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1375124, 11)
    		and df2:licensesKeysDf Shape: (3800, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1375124, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (914590, 17) 
        and df2:licensesDf Shape: (914590, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (548809, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (1920756, 30)
    	and df2:licensesDf Shape: (914590, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1318225, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (379081, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (379081, 25)
    	and df2:xgb_predict_df Shape: (379081, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (379081, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (379081, 28)
    	and df2:licenses_df Shape: (914590, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (379081, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (9356, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (9356, 2)
    	and df2:amanaPopulationOverlay Shape: (2014110, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2014110, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (2014110, 7)
    	and df2:amanaPopulationOverlay Shape: (2014110, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2014110, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (2014110, 14)
    	and predictions_df Shape: (379081, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (2366085, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (2014110, 8)
    	and df2:grid_level_new_businesses Shape: (2014110, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2014110, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2014110, 2)
    	and df2:poiData Shape: (2014110, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2014110, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2014110, 5)
    	and df2:population_per_grid Shape: (2014110, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2014110, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2014110, 2)
    	and df2:licenses_per_grid Shape: (2014110, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2014110, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2014110, 2)
    	and df2:licenses_per_grid Shape: (2014110, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2014110, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2014110, 9)
    	and df2:n_priority_areas_per_grid Shape: (2014110, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (2014110, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2366085, 53)
    	and df2:points_for_qgis Shape: (379081, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (379086, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (379086, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (379081, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (379081, 43)
    	and df2:data.amanaPopulationOverlay Shape: (2014110, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (373711, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (21718, 17)
    	and df2:n_licenses_per_facility Shape: (21739, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (21718, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (2014110, 20)
    	and df2:grid_level_license_risks Shape: (2014110, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2014110, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (2014110, 30)
    	and df2:licenses_per_facility Shape: (21718, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2014110, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (2014110, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (373711, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (373711, 46)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2014110, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (2014110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (2049622, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (2014110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2590598, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (2014110, 2)
    and df2:n_pois_per_grid Shape: (2014110, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2014110, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2014110, 4)
    and df2:populationsGrids Shape: (2014110, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2014110, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2014110, 5)
    and df2:populationsGrids Shape: (2014110, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2014110, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1389, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1375730, 11)
    		and df2:licensesKeysDf Shape: (3800, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1375730, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (914943, 17) 
        and df2:licensesDf Shape: (914943, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (548814, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (1920756, 30)
    	and df2:licensesDf Shape: (914943, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1318582, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (379310, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (379310, 25)
    	and df2:xgb_predict_df Shape: (379310, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (379310, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (379310, 28)
    	and df2:licenses_df Shape: (914943, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (379310, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (9356, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (9356, 2)
    	and df2:amanaPopulationOverlay Shape: (2014110, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2014110, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (2014110, 7)
    	and df2:amanaPopulationOverlay Shape: (2014110, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2014110, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (2014110, 14)
    	and predictions_df Shape: (379310, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (2366305, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (2014110, 8)
    	and df2:grid_level_new_businesses Shape: (2014110, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2014110, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2014110, 2)
    	and df2:poiData Shape: (2014110, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2014110, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2014110, 5)
    	and df2:population_per_grid Shape: (2014110, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2014110, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2014110, 2)
    	and df2:licenses_per_grid Shape: (2014110, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2014110, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2014110, 2)
    	and df2:licenses_per_grid Shape: (2014110, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2014110, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2014110, 9)
    	and df2:n_priority_areas_per_grid Shape: (2014110, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (2014110, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2366305, 53)
    	and df2:points_for_qgis Shape: (379310, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (379315, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (379315, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (379310, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (379310, 43)
    	and df2:data.amanaPopulationOverlay Shape: (2014110, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (373935, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (21723, 17)
    	and df2:n_licenses_per_facility Shape: (21744, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (21723, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (2014110, 20)
    	and df2:grid_level_license_risks Shape: (2014110, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2014110, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (2014110, 30)
    	and df2:licenses_per_facility Shape: (21723, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2014110, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (2014110, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (373935, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (373935, 46)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2014110, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (2014110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (2049622, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (2014110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2591641, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (2014110, 2)
    and df2:n_pois_per_grid Shape: (2014110, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2014110, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2014110, 4)
    and df2:populationsGrids Shape: (2014110, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2014110, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2014110, 5)
    and df2:populationsGrids Shape: (2014110, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2014110, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1389, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1376999, 11)
    		and df2:licensesKeysDf Shape: (3800, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1376999, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (915640, 17) 
        and df2:licensesDf Shape: (915640, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (554254, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (1936768, 30)
    	and df2:licensesDf Shape: (915640, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1323676, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (379883, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (379883, 25)
    	and df2:xgb_predict_df Shape: (379883, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (379883, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (379883, 28)
    	and df2:licenses_df Shape: (915640, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (379883, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (9356, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (9356, 2)
    	and df2:amanaPopulationOverlay Shape: (2014110, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2014110, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (2014110, 7)
    	and df2:amanaPopulationOverlay Shape: (2014110, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2014110, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (2014110, 14)
    	and predictions_df Shape: (379883, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (2366859, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (2014110, 8)
    	and df2:grid_level_new_businesses Shape: (2014110, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2014110, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2014110, 2)
    	and df2:poiData Shape: (2014110, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2014110, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2014110, 5)
    	and df2:population_per_grid Shape: (2014110, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2014110, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2014110, 2)
    	and df2:licenses_per_grid Shape: (2014110, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2014110, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2014110, 2)
    	and df2:licenses_per_grid Shape: (2014110, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2014110, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2014110, 9)
    	and df2:n_priority_areas_per_grid Shape: (2014110, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (2014110, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2366859, 53)
    	and df2:points_for_qgis Shape: (379883, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (379888, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (379888, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (379883, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (379883, 43)
    	and df2:data.amanaPopulationOverlay Shape: (2014110, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (374500, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (21735, 17)
    	and df2:n_licenses_per_facility Shape: (21756, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (21735, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (2014110, 20)
    	and df2:grid_level_license_risks Shape: (2014110, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2014110, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (2014110, 30)
    	and df2:licenses_per_facility Shape: (21735, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2014110, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (2014110, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (374500, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (374500, 46)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (1999791, 22)

INFO:root:Fetched Inspections_df shape: (3202203, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3202203, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3274337, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (1980315, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (1980315, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (1980299, 67)
    	and df2:Retail_Licenses_medina_df Shape: (1999791, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (1980306, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2014110, 13)
INFO:root:Fetched population_grids shape: (2014110, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2014110, 3)
INFO:root:Read pois_licenses_comparison shape: (2014110, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3202203, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3274337, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (1980315, 38)
    	and df2:Retail_Licenses_medina_df Shape: (1999791, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3156941, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3156941, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3244379, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (847273, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2014110, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5280, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2014110, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (11542, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (127063, 73)
    	and df2:predictions_df Shape: (127063, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (127063, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2014110, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9356, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9356, 2)
    	and df2:population_grids Shape: (2014110, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2014110, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2014110, 7)
    	and df2:population_grids Shape: (2014110, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2014110, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (701172, 32)
    	and df2:geometry_per_grid Shape: (2014110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (690600, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2014110, 7)
    	and df2:population_grids Shape: (2014110, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2014110, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (126580, 78)
    	and df2:population_grids Shape: (2014110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (124150, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13218, 2)
    	and df2:pois_data Shape: (2014110, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13218, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13218, 5)
    	and df2:population_per_grid Shape: (2014110, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13218, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13218, 3)
    	and df2:licenses_per_grid Shape: (13218, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13218, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13218, 9)
    	and df2:geometry_per_grid Shape: (2014110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (13218, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13218, 23)
    	and df2:n_priority_areas_per_grid Shape: (2014110, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (13218, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13218, 3)
    	and df2:licenses_per_grid Shape: (13218, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (13218, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (124150, 94)
    	and df2:points_for_qgis Shape: (126580, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (126580, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (126580, 24)
    	and df2:population_grids Shape: (2014110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (124150, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (13218, 10)
    	and df2:n_licenses_per_facility Shape: (13218, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13218, 11)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (13218, 52)
    	and df2:grid_level_license_risks Shape: (13218, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13218, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (13218, 59)
    	and df2:licenses_per_facility Shape: (13218, 12)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13218, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1389, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2014110, 15)
    	and df2:population_grids Shape: (2014110, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2014110, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (124150, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (124150, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2014110, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (13218, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (13218, 18)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2014110, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (2014110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (2049622, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (2014110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2590934, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (2014110, 2)
    and df2:n_pois_per_grid Shape: (2014110, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2014110, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2014110, 4)
    and df2:populationsGrids Shape: (2014110, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2014110, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2014110, 5)
    and df2:populationsGrids Shape: (2014110, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2014110, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1389, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1376999, 11)
    		and df2:licensesKeysDf Shape: (3800, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1376999, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (915640, 17) 
        and df2:licensesDf Shape: (915640, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (554254, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (1936768, 30)
    	and df2:licensesDf Shape: (915640, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1323676, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (379451, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (379451, 25)
    	and df2:xgb_predict_df Shape: (379451, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (379451, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (379451, 28)
    	and df2:licenses_df Shape: (915640, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (379451, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (9356, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (9356, 2)
    	and df2:amanaPopulationOverlay Shape: (2014110, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2014110, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (2014110, 7)
    	and df2:amanaPopulationOverlay Shape: (2014110, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2014110, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (2014110, 14)
    	and predictions_df Shape: (379451, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (2366440, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (2014110, 8)
    	and df2:grid_level_new_businesses Shape: (2014110, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2014110, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2014110, 2)
    	and df2:poiData Shape: (2014110, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2014110, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2014110, 5)
    	and df2:population_per_grid Shape: (2014110, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2014110, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2014110, 2)
    	and df2:licenses_per_grid Shape: (2014110, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2014110, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2014110, 2)
    	and df2:licenses_per_grid Shape: (2014110, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2014110, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2014110, 9)
    	and df2:n_priority_areas_per_grid Shape: (2014110, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (2014110, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2366440, 53)
    	and df2:points_for_qgis Shape: (379451, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (379456, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (379456, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (379451, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (379451, 43)
    	and df2:data.amanaPopulationOverlay Shape: (2014110, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (374074, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (21726, 17)
    	and df2:n_licenses_per_facility Shape: (21747, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (21726, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (2014110, 20)
    	and df2:grid_level_license_risks Shape: (2014110, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2014110, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (2014110, 30)
    	and df2:licenses_per_facility Shape: (21726, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2014110, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (2014110, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (374074, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (374074, 46)
ERROR:sqlalchemy.pool.impl.QueuePool:Exception during reset or similar
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 739, in _finalize_fairy
    fairy._reset(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 988, in _reset
    pool._dialect.do_rollback(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 682, in do_rollback
    dbapi_connection.rollback()
cx_Oracle.DatabaseError: ORA-25408: can not safely replay call
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2014110, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (2014110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (2049622, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (2014110, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2591843, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (2014110, 2)
    and df2:n_pois_per_grid Shape: (2014110, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2014110, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2014110, 4)
    and df2:populationsGrids Shape: (2014110, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2014110, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2014110, 5)
    and df2:populationsGrids Shape: (2014110, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2014110, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1389, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1378041, 11)
    		and df2:licensesKeysDf Shape: (3800, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1378041, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (916205, 17) 
        and df2:licensesDf Shape: (916205, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (556505, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (1943883, 30)
    	and df2:licensesDf Shape: (916205, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1326087, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (379970, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (379970, 25)
    	and df2:xgb_predict_df Shape: (379970, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (379970, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (379970, 28)
    	and df2:licenses_df Shape: (916205, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (379970, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (9356, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (9356, 2)
    	and df2:amanaPopulationOverlay Shape: (2014110, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2014110, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (2014110, 7)
    	and df2:amanaPopulationOverlay Shape: (2014110, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2014110, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (2014110, 14)
    	and predictions_df Shape: (379970, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (2366943, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (2014110, 8)
    	and df2:grid_level_new_businesses Shape: (2014110, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2014110, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2014110, 2)
    	and df2:poiData Shape: (2014110, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2014110, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2014110, 5)
    	and df2:population_per_grid Shape: (2014110, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2014110, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2014110, 2)
    	and df2:licenses_per_grid Shape: (2014110, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2014110, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2014110, 2)
    	and df2:licenses_per_grid Shape: (2014110, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2014110, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2014110, 9)
    	and df2:n_priority_areas_per_grid Shape: (2014110, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (2014110, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2366943, 53)
    	and df2:points_for_qgis Shape: (379970, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (379975, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (379975, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (379970, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (379970, 43)
    	and df2:data.amanaPopulationOverlay Shape: (2014110, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (374584, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (21735, 17)
    	and df2:n_licenses_per_facility Shape: (21755, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (21735, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (2014110, 20)
    	and df2:grid_level_license_risks Shape: (2014110, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2014110, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (2014110, 30)
    	and df2:licenses_per_facility Shape: (21735, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2014110, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (2014110, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (374584, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (374584, 46)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2000830, 22)

INFO:root:Fetched Inspections_df shape: (3214089, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3214089, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3286703, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (1991063, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (1991063, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (1991047, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2000830, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (1991054, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2014110, 13)
INFO:root:Fetched population_grids shape: (2014110, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2014110, 3)
INFO:root:Read pois_licenses_comparison shape: (2014110, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3214089, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3286703, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (1991063, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2000830, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3166386, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3166386, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3254598, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (853115, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2014110, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5280, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2014110, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (11542, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (127400, 73)
    	and df2:predictions_df Shape: (127400, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (127400, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2014110, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9356, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9356, 2)
    	and df2:population_grids Shape: (2014110, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2014110, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2014110, 7)
    	and df2:population_grids Shape: (2014110, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2014110, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (705090, 32)
    	and df2:geometry_per_grid Shape: (2014110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (694465, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2014110, 7)
    	and df2:population_grids Shape: (2014110, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2014110, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (126913, 78)
    	and df2:population_grids Shape: (2014110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (124477, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13233, 2)
    	and df2:pois_data Shape: (2014110, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13233, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13233, 5)
    	and df2:population_per_grid Shape: (2014110, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13233, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13233, 3)
    	and df2:licenses_per_grid Shape: (13233, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13233, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13233, 9)
    	and df2:geometry_per_grid Shape: (2014110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (13233, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13233, 23)
    	and df2:n_priority_areas_per_grid Shape: (2014110, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (13233, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13233, 3)
    	and df2:licenses_per_grid Shape: (13233, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (13233, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (124477, 94)
    	and df2:points_for_qgis Shape: (126913, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (126913, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (126913, 24)
    	and df2:population_grids Shape: (2014110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (124477, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (13233, 10)
    	and df2:n_licenses_per_facility Shape: (13233, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13233, 11)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (13233, 52)
    	and df2:grid_level_license_risks Shape: (13233, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13233, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (13233, 59)
    	and df2:licenses_per_facility Shape: (13233, 12)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13233, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1389, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2014110, 15)
    	and df2:population_grids Shape: (2014110, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2014110, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (124477, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (124477, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2014110, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (13233, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (13233, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2000935, 22)

INFO:root:Fetched Inspections_df shape: (3219987, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3219987, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3292817, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (1995661, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (1995661, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (1995645, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2000935, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (1995652, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2014110, 13)
INFO:root:Fetched population_grids shape: (2014110, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2014110, 3)
INFO:root:Read pois_licenses_comparison shape: (2014110, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3219987, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3292817, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (1995661, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2000935, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3170272, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3170272, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3258848, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (855856, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2014110, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5280, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2014110, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (11542, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (127573, 73)
    	and df2:predictions_df Shape: (127573, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (127573, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2014110, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9356, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9356, 2)
    	and df2:population_grids Shape: (2014110, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2014110, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2014110, 7)
    	and df2:population_grids Shape: (2014110, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2014110, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (706508, 32)
    	and df2:geometry_per_grid Shape: (2014110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (695856, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2014110, 7)
    	and df2:population_grids Shape: (2014110, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2014110, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (127087, 78)
    	and df2:population_grids Shape: (2014110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (124651, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13234, 2)
    	and df2:pois_data Shape: (2014110, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13234, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13234, 5)
    	and df2:population_per_grid Shape: (2014110, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13234, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13234, 3)
    	and df2:licenses_per_grid Shape: (13234, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13234, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13234, 9)
    	and df2:geometry_per_grid Shape: (2014110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (13234, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13234, 23)
    	and df2:n_priority_areas_per_grid Shape: (2014110, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (13234, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13234, 3)
    	and df2:licenses_per_grid Shape: (13234, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (13234, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (124651, 94)
    	and df2:points_for_qgis Shape: (127087, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (127087, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (127087, 24)
    	and df2:population_grids Shape: (2014110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (124651, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (13234, 10)
    	and df2:n_licenses_per_facility Shape: (13234, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13234, 11)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (13234, 52)
    	and df2:grid_level_license_risks Shape: (13234, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13234, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (13234, 59)
    	and df2:licenses_per_facility Shape: (13234, 12)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13234, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1389, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2014110, 15)
    	and df2:population_grids Shape: (2014110, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2014110, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (124651, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (124651, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2014110, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (13234, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (13234, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2001252, 22)

INFO:root:Fetched Inspections_df shape: (3224553, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3224553, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3297496, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (1999823, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (1999823, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (1999807, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2001252, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (1999814, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2014110, 13)
INFO:root:Fetched population_grids shape: (2014110, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2014110, 3)
INFO:root:Read pois_licenses_comparison shape: (2014110, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3224553, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3297496, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (1999823, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2001252, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3174082, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3174082, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3262866, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (858450, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2014110, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5280, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2014110, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (11542, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (127749, 73)
    	and df2:predictions_df Shape: (127749, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (127749, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2014110, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9356, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9356, 2)
    	and df2:population_grids Shape: (2014110, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2014110, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2014110, 7)
    	and df2:population_grids Shape: (2014110, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2014110, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (707841, 32)
    	and df2:geometry_per_grid Shape: (2014110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (697173, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2014110, 7)
    	and df2:population_grids Shape: (2014110, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2014110, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (127263, 78)
    	and df2:population_grids Shape: (2014110, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (124819, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13243, 2)
    	and df2:pois_data Shape: (2014110, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13243, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13243, 5)
    	and df2:population_per_grid Shape: (2014110, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13243, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13243, 3)
    	and df2:licenses_per_grid Shape: (13243, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13243, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13243, 9)
    	and df2:geometry_per_grid Shape: (2014110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (13243, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13243, 23)
    	and df2:n_priority_areas_per_grid Shape: (2014110, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (13243, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13243, 3)
    	and df2:licenses_per_grid Shape: (13243, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (13243, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (124819, 94)
    	and df2:points_for_qgis Shape: (127263, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (127263, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (127263, 24)
    	and df2:population_grids Shape: (2014110, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (124819, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (13243, 10)
    	and df2:n_licenses_per_facility Shape: (13243, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13243, 11)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (13243, 52)
    	and df2:grid_level_license_risks Shape: (13243, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13243, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (13243, 59)
    	and df2:licenses_per_facility Shape: (13243, 12)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13243, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1389, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2014110, 15)
    	and df2:population_grids Shape: (2014110, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2014110, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (124819, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (124819, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2014110, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (13243, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (13243, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2001678, 22)

INFO:root:Fetched Inspections_df shape: (3229031, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3229031, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3302204, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2004238, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2004238, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2004222, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2001678, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2004229, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3229031, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3302204, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2004238, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2001678, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3178319, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3178319, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3267497, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (861116, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (127908, 73)
    	and df2:predictions_df Shape: (127908, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (127908, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (709396, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (455451, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2001678, 22)

INFO:root:Fetched Inspections_df shape: (3229031, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3229031, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3302204, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2004238, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2004238, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2004222, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2001678, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2004229, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3229031, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3302204, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2004238, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2001678, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3178319, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3178319, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3267497, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (861116, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (127908, 73)
    	and df2:predictions_df Shape: (127908, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (127908, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (709396, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (455451, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2001678, 22)

INFO:root:Fetched Inspections_df shape: (3229031, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3229031, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3302204, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2004238, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2004238, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2004222, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2001678, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2004229, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3229031, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3302204, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2004238, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2001678, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3178319, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3178319, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3267497, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (861116, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (127908, 73)
    	and df2:predictions_df Shape: (127908, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (127908, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (709396, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (455451, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2001678, 22)

INFO:root:Fetched Inspections_df shape: (3229031, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3229031, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3302204, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2004238, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2004238, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2004222, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2001678, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2004229, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3229031, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3302204, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2004238, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2001678, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3178319, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3178319, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3267497, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (861116, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (127908, 73)
    	and df2:predictions_df Shape: (127908, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (127908, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (709396, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (455451, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2001678, 22)

INFO:root:Fetched Inspections_df shape: (3229031, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3229031, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3302204, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2004238, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2004238, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2004222, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2001678, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2004229, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3229031, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3302204, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2004238, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2001678, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3178319, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3178319, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3267497, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (861116, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (127908, 73)
    	and df2:predictions_df Shape: (127908, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (127908, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (709396, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (455451, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2001678, 22)

INFO:root:Fetched Inspections_df shape: (3229031, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3229031, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3302204, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2004238, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2004238, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2004222, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2001678, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2004229, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3229031, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3302204, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2004238, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2001678, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3178319, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3178319, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3267497, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (861116, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (127908, 73)
    	and df2:predictions_df Shape: (127908, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (127908, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (709396, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (455451, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2001678, 22)

INFO:root:Fetched Inspections_df shape: (3229031, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3229031, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3302204, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2004238, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2004238, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2004222, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2001678, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2004229, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3229031, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3302204, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2004238, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2001678, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3178319, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3178319, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3267497, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (861116, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (127908, 73)
    	and df2:predictions_df Shape: (127908, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (127908, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (709396, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (455451, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2001678, 22)

INFO:root:Fetched Inspections_df shape: (3229031, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3229031, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3302204, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2004238, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2004238, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2004222, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2001678, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2004229, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3229031, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3302204, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2004238, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2001678, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3178319, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3178319, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3267497, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (861116, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (127908, 73)
    	and df2:predictions_df Shape: (127908, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (127908, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (709396, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (455451, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2001981, 22)

INFO:root:Fetched Inspections_df shape: (3229031, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3229031, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3302204, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2004238, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2004238, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2004222, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2001981, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2004229, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3229031, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3302204, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2004238, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2001981, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3178622, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3178622, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3267800, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (861116, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (127911, 73)
    	and df2:predictions_df Shape: (127911, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (127911, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (710824, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (456383, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2001981, 22)

INFO:root:Fetched Inspections_df shape: (3233110, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3233110, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3306438, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2008163, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2008163, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2008147, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2001981, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2008154, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3233110, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3306438, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2008163, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2001981, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3182138, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3182138, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3271590, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (863658, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128100, 73)
    	and df2:predictions_df Shape: (128100, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128100, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (710824, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (456383, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2001981, 22)

INFO:root:Fetched Inspections_df shape: (3233110, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3233110, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3306438, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2008163, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2008163, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2008147, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2001981, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2008154, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3233110, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3306438, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2008163, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2001981, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3182138, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3182138, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3271590, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (863658, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128080, 73)
    	and df2:predictions_df Shape: (128080, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128080, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (710824, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (456383, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2001981, 22)

INFO:root:Fetched Inspections_df shape: (3233110, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3233110, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3306438, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2008163, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2008163, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2008147, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2001981, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2008154, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3233110, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3306438, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2008163, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2001981, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3182138, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3182138, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3271590, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (863658, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128080, 73)
    	and df2:predictions_df Shape: (128080, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128080, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (710824, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (456383, 47)
        
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (1757563, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (1780239, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (1757563, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2136020, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (1757563, 2)
    and df2:n_pois_per_grid Shape: (1757563, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1757563, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (1757563, 4)
    and df2:populationsGrids Shape: (1757563, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1757563, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (1757563, 5)
    and df2:populationsGrids Shape: (1757563, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1757563, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1389, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1379204, 11)
    		and df2:licensesKeysDf Shape: (3800, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1379204, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (916753, 17) 
        and df2:licensesDf Shape: (916753, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (562310, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (1963617, 30)
    	and df2:licensesDf Shape: (916753, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1331635, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (380519, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (380519, 25)
    	and df2:xgb_predict_df Shape: (380519, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (380519, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (380519, 28)
    	and df2:licenses_df Shape: (916753, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (380519, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (5657, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (5657, 2)
    	and df2:amanaPopulationOverlay Shape: (1757563, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (1757563, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:amanaPopulationOverlay Shape: (1757563, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (1757563, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (1757563, 14)
    	and predictions_df Shape: (380519, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (1987369, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (1757563, 8)
    	and df2:grid_level_new_businesses Shape: (1757563, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (1757563, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (1757563, 2)
    	and df2:poiData Shape: (1757563, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (1757563, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (1757563, 5)
    	and df2:population_per_grid Shape: (1757563, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (1757563, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (1757563, 2)
    	and df2:licenses_per_grid Shape: (1757563, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (1757563, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (1757563, 2)
    	and df2:licenses_per_grid Shape: (1757563, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (1757563, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (1757563, 9)
    	and df2:n_priority_areas_per_grid Shape: (1757563, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (1757563, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (1987369, 53)
    	and df2:points_for_qgis Shape: (380519, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (404623, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (404623, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (380519, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (380519, 43)
    	and df2:data.amanaPopulationOverlay Shape: (1757563, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (218595, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (12143, 17)
    	and df2:n_licenses_per_facility Shape: (12156, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (12143, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (1757563, 20)
    	and df2:grid_level_license_risks Shape: (1757563, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (1757563, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (1757563, 30)
    	and df2:licenses_per_facility Shape: (12143, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (1757563, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (1757563, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (218595, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (218595, 46)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2001981, 22)

INFO:root:Fetched Inspections_df shape: (3233110, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3233110, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3306438, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2008163, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2008163, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2008147, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2001981, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2008154, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3233110, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3306438, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2008163, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2001981, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3182138, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3182138, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3271590, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (863658, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128080, 73)
    	and df2:predictions_df Shape: (128080, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128080, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (710824, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (456383, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2001981, 22)

INFO:root:Fetched Inspections_df shape: (3233110, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3233110, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3306438, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2008163, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2008163, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2008147, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2001981, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2008154, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3233110, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3306438, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2008163, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2001981, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3182138, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3182138, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3271590, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (863658, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128080, 73)
    	and df2:predictions_df Shape: (128080, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128080, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (710824, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (456383, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2001981, 22)

INFO:root:Fetched Inspections_df shape: (3233110, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3233110, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3306438, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2008163, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2008163, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2008147, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2001981, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2008154, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3233110, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3306438, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2008163, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2001981, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3182138, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3182138, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3271590, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (863658, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128080, 73)
    	and df2:predictions_df Shape: (128080, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128080, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (710824, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (456383, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2001981, 22)

INFO:root:Fetched Inspections_df shape: (3233110, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3233110, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3306438, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2008163, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2008163, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2008147, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2001981, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2008154, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3233110, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3306438, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2008163, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2001981, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3182138, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3182138, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3271590, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (863658, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128080, 73)
    	and df2:predictions_df Shape: (128080, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128080, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (710824, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (456383, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2001981, 22)

INFO:root:Fetched Inspections_df shape: (3233110, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3233110, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3306438, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2008163, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2008163, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2008147, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2001981, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2008154, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3233110, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3306438, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2008163, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2001981, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3182138, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3182138, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3271590, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (863658, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128080, 73)
    	and df2:predictions_df Shape: (128080, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128080, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (710824, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (456383, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2001981, 22)

INFO:root:Fetched Inspections_df shape: (3233110, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3233110, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3306438, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2008163, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2008163, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2008147, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2001981, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2008154, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3233110, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3306438, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2008163, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2001981, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3182138, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3182138, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3271590, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (863658, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128080, 73)
    	and df2:predictions_df Shape: (128080, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128080, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (710824, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (456383, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2001981, 22)

INFO:root:Fetched Inspections_df shape: (3233110, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3233110, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3306438, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2008163, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2008163, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2008147, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2001981, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2008154, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3233110, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3306438, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2008163, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2001981, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3182138, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3182138, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3271590, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (863658, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128080, 73)
    	and df2:predictions_df Shape: (128080, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128080, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (710824, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (456383, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2001981, 22)

INFO:root:Fetched Inspections_df shape: (3233110, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3233110, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3306438, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2008163, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2008163, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2008147, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2001981, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2008154, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3233110, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3306438, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2008163, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2001981, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3182138, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3182138, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3271590, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (863658, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128080, 73)
    	and df2:predictions_df Shape: (128080, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128080, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (710824, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (456383, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2001981, 22)

INFO:root:Fetched Inspections_df shape: (3233110, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3233110, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3306438, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2008163, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2008163, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2008147, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2001981, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2008154, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3233110, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3306438, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2008163, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2001981, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3182138, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3182138, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3271590, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (863658, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128080, 73)
    	and df2:predictions_df Shape: (128080, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128080, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (710824, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (456383, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2001981, 22)

INFO:root:Fetched Inspections_df shape: (3233110, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3233110, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3306438, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2008163, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2008163, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2008147, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2001981, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2008154, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3233110, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3306438, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2008163, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2001981, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3182138, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3182138, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3271590, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (863658, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128080, 73)
    	and df2:predictions_df Shape: (128080, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128080, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (710824, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (456383, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2001981, 22)

INFO:root:Fetched Inspections_df shape: (3233110, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3233110, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3306438, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2008163, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2008163, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2008147, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2001981, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2008154, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3233110, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3306438, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2008163, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2001981, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3182138, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3182138, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3271590, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (863658, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128080, 73)
    	and df2:predictions_df Shape: (128080, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128080, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (710824, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (456383, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002124, 22)

INFO:root:Fetched Inspections_df shape: (3235625, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3235625, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3309051, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2010690, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2010690, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2010674, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002124, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2010681, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3235625, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3309051, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2010690, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002124, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3184560, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3184560, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3274200, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (865268, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128182, 73)
    	and df2:predictions_df Shape: (128182, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128182, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (712587, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (457520, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002124, 22)

INFO:root:Fetched Inspections_df shape: (3235625, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3235625, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3309051, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2010690, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2010690, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2010674, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002124, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2010681, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3235625, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3309051, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2010690, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002124, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3184560, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3184560, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3274200, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (865268, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128182, 73)
    	and df2:predictions_df Shape: (128182, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128182, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (712587, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (457520, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002124, 22)

INFO:root:Fetched Inspections_df shape: (3235625, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3235625, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3309051, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2010690, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2010690, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2010674, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002124, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2010681, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3235625, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3309051, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2010690, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002124, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3184560, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3184560, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3274200, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (865268, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128165, 73)
    	and df2:predictions_df Shape: (128165, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128165, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (712587, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (457520, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002124, 22)

INFO:root:Fetched Inspections_df shape: (3235625, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3235625, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3309051, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2010690, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2010690, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2010674, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002124, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2010681, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3235625, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3309051, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2010690, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002124, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3184560, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3184560, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3274200, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (865268, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128165, 73)
    	and df2:predictions_df Shape: (128165, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128165, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (712587, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (457520, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002124, 22)

INFO:root:Fetched Inspections_df shape: (3235625, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3235625, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3309051, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2010690, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2010690, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2010674, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002124, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2010681, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3235625, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3309051, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2010690, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002124, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3184560, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3184560, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3274200, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (865268, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128165, 73)
    	and df2:predictions_df Shape: (128165, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128165, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (712587, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (457520, 47)
        
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (1757563, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (1780239, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (1757563, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2136143, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (1757563, 2)
    and df2:n_pois_per_grid Shape: (1757563, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1757563, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (1757563, 4)
    and df2:populationsGrids Shape: (1757563, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1757563, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (1757563, 5)
    and df2:populationsGrids Shape: (1757563, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1757563, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1389, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1379347, 11)
    		and df2:licensesKeysDf Shape: (3800, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1379347, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (916809, 17) 
        and df2:licensesDf Shape: (916809, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (563058, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (1966050, 30)
    	and df2:licensesDf Shape: (916809, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1332382, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (380604, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (380604, 25)
    	and df2:xgb_predict_df Shape: (380604, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (380604, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (380604, 28)
    	and df2:licenses_df Shape: (916809, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (380604, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (5657, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (5657, 2)
    	and df2:amanaPopulationOverlay Shape: (1757563, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (1757563, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:amanaPopulationOverlay Shape: (1757563, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (1757563, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (1757563, 14)
    	and predictions_df Shape: (380604, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (1987423, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (1757563, 8)
    	and df2:grid_level_new_businesses Shape: (1757563, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (1757563, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (1757563, 2)
    	and df2:poiData Shape: (1757563, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (1757563, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (1757563, 5)
    	and df2:population_per_grid Shape: (1757563, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (1757563, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (1757563, 2)
    	and df2:licenses_per_grid Shape: (1757563, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (1757563, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (1757563, 2)
    	and df2:licenses_per_grid Shape: (1757563, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (1757563, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (1757563, 9)
    	and df2:n_priority_areas_per_grid Shape: (1757563, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (1757563, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (1987423, 53)
    	and df2:points_for_qgis Shape: (380604, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (404715, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (404715, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (380604, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (380604, 43)
    	and df2:data.amanaPopulationOverlay Shape: (1757563, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (218643, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (12143, 17)
    	and df2:n_licenses_per_facility Shape: (12157, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (12143, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (1757563, 20)
    	and df2:grid_level_license_risks Shape: (1757563, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (1757563, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (1757563, 30)
    	and df2:licenses_per_facility Shape: (12143, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (1757563, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (1757563, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (218643, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (218643, 46)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002124, 22)

INFO:root:Fetched Inspections_df shape: (3235625, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3235625, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3309051, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2010690, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2010690, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2010674, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002124, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2010681, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3235625, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3309051, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2010690, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002124, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3184560, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3184560, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3274200, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (865268, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128165, 73)
    	and df2:predictions_df Shape: (128165, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128165, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (712587, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (457520, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002124, 22)

INFO:root:Fetched Inspections_df shape: (3235625, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3235625, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3309051, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2010690, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2010690, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2010674, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002124, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2010681, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3235625, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3309051, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2010690, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002124, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3184560, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3184560, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3274200, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (865268, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128165, 73)
    	and df2:predictions_df Shape: (128165, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128165, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (712587, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (457520, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002124, 22)

INFO:root:Fetched Inspections_df shape: (3235625, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3235625, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3309051, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2010690, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2010690, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2010674, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002124, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2010681, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3235625, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3309051, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2010690, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002124, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3184560, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3184560, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3274200, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (865268, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128165, 73)
    	and df2:predictions_df Shape: (128165, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128165, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (712587, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (457520, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002150, 22)

INFO:root:Fetched Inspections_df shape: (3236221, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3236221, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3309659, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2011248, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2011248, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2011232, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002150, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2011239, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3236221, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3309659, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2011248, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002150, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3185072, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3185072, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3274738, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (865676, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128199, 73)
    	and df2:predictions_df Shape: (128199, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128199, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (713784, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (458315, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002150, 22)

INFO:root:Fetched Inspections_df shape: (3236221, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3236221, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3309659, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2011248, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2011248, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2011232, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002150, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2011239, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3236221, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3309659, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2011248, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002150, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3185072, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3185072, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3274738, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (865676, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128178, 73)
    	and df2:predictions_df Shape: (128178, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128178, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (713784, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (458315, 47)
        
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (1757563, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (1780239, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (1757563, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2136179, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (1757563, 2)
    and df2:n_pois_per_grid Shape: (1757563, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1757563, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (1757563, 4)
    and df2:populationsGrids Shape: (1757563, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1757563, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (1757563, 5)
    and df2:populationsGrids Shape: (1757563, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1757563, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1389, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1379404, 11)
    		and df2:licensesKeysDf Shape: (3800, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1379404, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (916826, 17) 
        and df2:licensesDf Shape: (916826, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (563344, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (1967717, 30)
    	and df2:licensesDf Shape: (916826, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1332662, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (380612, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (380612, 25)
    	and df2:xgb_predict_df Shape: (380612, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (380612, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (380612, 28)
    	and df2:licenses_df Shape: (916826, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (380612, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (5657, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (5657, 2)
    	and df2:amanaPopulationOverlay Shape: (1757563, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (1757563, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:amanaPopulationOverlay Shape: (1757563, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (1757563, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (1757563, 14)
    	and predictions_df Shape: (380612, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (1987426, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (1757563, 8)
    	and df2:grid_level_new_businesses Shape: (1757563, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (1757563, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (1757563, 2)
    	and df2:poiData Shape: (1757563, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (1757563, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (1757563, 5)
    	and df2:population_per_grid Shape: (1757563, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (1757563, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (1757563, 2)
    	and df2:licenses_per_grid Shape: (1757563, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (1757563, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (1757563, 2)
    	and df2:licenses_per_grid Shape: (1757563, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (1757563, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (1757563, 9)
    	and df2:n_priority_areas_per_grid Shape: (1757563, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (1757563, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (1987426, 53)
    	and df2:points_for_qgis Shape: (380612, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (404726, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (404726, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (380612, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (380612, 43)
    	and df2:data.amanaPopulationOverlay Shape: (1757563, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (218645, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (12145, 17)
    	and df2:n_licenses_per_facility Shape: (12159, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (12145, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (1757563, 20)
    	and df2:grid_level_license_risks Shape: (1757563, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (1757563, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (1757563, 30)
    	and df2:licenses_per_facility Shape: (12145, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (1757563, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (1757563, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (218645, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (218645, 46)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002180, 22)

INFO:root:Fetched Inspections_df shape: (3237431, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3237431, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3310894, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2012391, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2012391, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2012375, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002180, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2012382, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3237431, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3310894, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2012391, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002180, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3185928, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3185928, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3275638, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (866371, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128207, 73)
    	and df2:predictions_df Shape: (128207, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128207, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (714609, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (458815, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002180, 22)

INFO:root:Fetched Inspections_df shape: (3237431, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3237431, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3310894, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2012391, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2012391, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2012375, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002180, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2012382, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3237431, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3310894, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2012391, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002180, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3185928, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3185928, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3275638, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (866371, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128207, 73)
    	and df2:predictions_df Shape: (128207, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128207, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (714609, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (458815, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002180, 22)

INFO:root:Fetched Inspections_df shape: (3237431, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3237431, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3310894, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2012391, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2012391, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2012375, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002180, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2012382, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3237431, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3310894, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2012391, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002180, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3185928, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3185928, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3275638, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (866371, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128207, 73)
    	and df2:predictions_df Shape: (128207, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128207, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (714609, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (458815, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002180, 22)

INFO:root:Fetched Inspections_df shape: (3237431, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3237431, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3310894, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2012391, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2012391, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2012375, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002180, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2012382, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3237431, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3310894, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2012391, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002180, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3185928, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3185928, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3275638, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (866371, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128207, 73)
    	and df2:predictions_df Shape: (128207, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128207, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (714609, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (458815, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002180, 22)

INFO:root:Fetched Inspections_df shape: (3237431, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3237431, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3310894, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2012391, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2012391, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2012375, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002180, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2012382, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3237431, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3310894, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2012391, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002180, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3185928, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3185928, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3275638, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (866371, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128207, 73)
    	and df2:predictions_df Shape: (128207, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128207, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (714609, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (458815, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002218, 22)

INFO:root:Fetched Inspections_df shape: (3239237, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3239237, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3312749, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2014077, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2014077, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2014061, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002218, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2014068, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3239237, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3312749, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2014077, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002218, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3187156, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3187156, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3276928, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (867367, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128269, 73)
    	and df2:predictions_df Shape: (128269, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128269, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (715362, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (459280, 47)
        
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (1757563, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (1780239, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (1757563, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2136167, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (1757563, 2)
    and df2:n_pois_per_grid Shape: (1757563, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1757563, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (1757563, 4)
    and df2:populationsGrids Shape: (1757563, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1757563, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (1757563, 5)
    and df2:populationsGrids Shape: (1757563, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1757563, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1389, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1379443, 11)
    		and df2:licensesKeysDf Shape: (3800, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1379443, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (916844, 17) 
        and df2:licensesDf Shape: (916844, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (563614, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (1969372, 30)
    	and df2:licensesDf Shape: (916844, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1332915, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (380600, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (380600, 25)
    	and df2:xgb_predict_df Shape: (380600, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (380600, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (380600, 28)
    	and df2:licenses_df Shape: (916844, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (380600, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (5657, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (5657, 2)
    	and df2:amanaPopulationOverlay Shape: (1757563, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (1757563, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:amanaPopulationOverlay Shape: (1757563, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (1757563, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (1757563, 14)
    	and predictions_df Shape: (380600, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (1987415, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (1757563, 8)
    	and df2:grid_level_new_businesses Shape: (1757563, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (1757563, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (1757563, 2)
    	and df2:poiData Shape: (1757563, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (1757563, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (1757563, 5)
    	and df2:population_per_grid Shape: (1757563, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (1757563, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (1757563, 2)
    	and df2:licenses_per_grid Shape: (1757563, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (1757563, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (1757563, 2)
    	and df2:licenses_per_grid Shape: (1757563, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (1757563, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (1757563, 9)
    	and df2:n_priority_areas_per_grid Shape: (1757563, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (1757563, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (1987415, 53)
    	and df2:points_for_qgis Shape: (380600, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (404716, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (404716, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (380600, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (380600, 43)
    	and df2:data.amanaPopulationOverlay Shape: (1757563, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (218633, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (12146, 17)
    	and df2:n_licenses_per_facility Shape: (12160, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (12146, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (1757563, 20)
    	and df2:grid_level_license_risks Shape: (1757563, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (1757563, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (1757563, 30)
    	and df2:licenses_per_facility Shape: (12146, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (1757563, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (1757563, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (218633, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (218633, 46)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002218, 22)

INFO:root:Fetched Inspections_df shape: (3239237, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3239237, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3312749, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2014077, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2014077, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2014061, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002218, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2014068, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3239237, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3312749, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2014077, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002218, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3187156, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3187156, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3276928, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (867367, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128243, 73)
    	and df2:predictions_df Shape: (128243, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128243, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (715362, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (459280, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002218, 22)

INFO:root:Fetched Inspections_df shape: (3239237, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3239237, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3312749, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2014077, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2014077, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2014061, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002218, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2014068, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3239237, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3312749, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2014077, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002218, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3187156, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3187156, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3276928, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (867367, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128243, 73)
    	and df2:predictions_df Shape: (128243, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128243, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (715362, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (459280, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002218, 22)

INFO:root:Fetched Inspections_df shape: (3239237, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3239237, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3312749, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2014077, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2014077, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2014061, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002218, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2014068, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3239237, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3312749, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2014077, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002218, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3187156, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3187156, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3276928, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (867367, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128243, 73)
    	and df2:predictions_df Shape: (128243, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128243, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (715362, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (459280, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002218, 22)

INFO:root:Fetched Inspections_df shape: (3239237, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3239237, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3312749, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2014077, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2014077, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2014061, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002218, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2014068, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3239237, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3312749, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2014077, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002218, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3187156, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3187156, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3276928, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (867367, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128243, 73)
    	and df2:predictions_df Shape: (128243, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128243, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (715362, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (459280, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002218, 22)

INFO:root:Fetched Inspections_df shape: (3239237, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3239237, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3312749, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2014077, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2014077, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2014061, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002218, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2014068, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3239237, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3312749, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2014077, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002218, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3187156, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3187156, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3276928, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (867367, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128243, 73)
    	and df2:predictions_df Shape: (128243, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128243, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (715362, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (459280, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002218, 22)

INFO:root:Fetched Inspections_df shape: (3239237, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3239237, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3312749, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2014077, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2014077, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2014061, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002218, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2014068, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3239237, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3312749, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2014077, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002218, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3187156, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3187156, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3276928, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (867367, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128243, 73)
    	and df2:predictions_df Shape: (128243, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128243, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (715362, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (459280, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002218, 22)

INFO:root:Fetched Inspections_df shape: (3239237, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3239237, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3312749, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2014077, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2014077, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2014061, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002218, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2014068, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3239237, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3312749, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2014077, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002218, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3187156, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3187156, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3276928, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (867367, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128243, 73)
    	and df2:predictions_df Shape: (128243, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128243, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (715362, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (459280, 47)
        
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (1757563, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (1780239, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (1757563, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2136085, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (1757563, 2)
    and df2:n_pois_per_grid Shape: (1757563, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1757563, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (1757563, 4)
    and df2:populationsGrids Shape: (1757563, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1757563, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (1757563, 5)
    and df2:populationsGrids Shape: (1757563, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1757563, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1389, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1379443, 11)
    		and df2:licensesKeysDf Shape: (3800, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1379443, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (916844, 17) 
        and df2:licensesDf Shape: (916844, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (563614, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (1969372, 30)
    	and df2:licensesDf Shape: (916844, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1332915, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (380541, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (380541, 25)
    	and df2:xgb_predict_df Shape: (380541, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (380541, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (380541, 28)
    	and df2:licenses_df Shape: (916844, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (380541, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (5657, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (5657, 2)
    	and df2:amanaPopulationOverlay Shape: (1757563, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (1757563, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:amanaPopulationOverlay Shape: (1757563, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (1757563, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (1757563, 14)
    	and predictions_df Shape: (380541, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (1987375, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (1757563, 8)
    	and df2:grid_level_new_businesses Shape: (1757563, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (1757563, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (1757563, 2)
    	and df2:poiData Shape: (1757563, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (1757563, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (1757563, 5)
    	and df2:population_per_grid Shape: (1757563, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (1757563, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (1757563, 2)
    	and df2:licenses_per_grid Shape: (1757563, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (1757563, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (1757563, 2)
    	and df2:licenses_per_grid Shape: (1757563, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (1757563, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (1757563, 9)
    	and df2:n_priority_areas_per_grid Shape: (1757563, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (1757563, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (1987375, 53)
    	and df2:points_for_qgis Shape: (380541, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (404652, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (404652, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (380541, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (380541, 43)
    	and df2:data.amanaPopulationOverlay Shape: (1757563, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (218597, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (12145, 17)
    	and df2:n_licenses_per_facility Shape: (12159, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (12145, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (1757563, 20)
    	and df2:grid_level_license_risks Shape: (1757563, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (1757563, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (1757563, 30)
    	and df2:licenses_per_facility Shape: (12145, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (1757563, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (1757563, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (218597, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (218597, 46)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002357, 22)

INFO:root:Fetched Inspections_df shape: (3241206, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3241206, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3314761, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2015898, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2015898, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2015882, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002357, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2015889, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3241206, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3314761, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2015898, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002357, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3188672, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3188672, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3278510, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (868452, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128308, 73)
    	and df2:predictions_df Shape: (128308, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128308, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (716251, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (459830, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002357, 22)

INFO:root:Fetched Inspections_df shape: (3241206, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3241206, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3314761, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2015898, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2015898, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2015882, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002357, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2015889, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3241206, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3314761, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2015898, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002357, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3188672, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3188672, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3278510, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (868452, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128308, 73)
    	and df2:predictions_df Shape: (128308, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128308, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (716251, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (459830, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002357, 22)

INFO:root:Fetched Inspections_df shape: (3241206, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3241206, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3314761, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2015898, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2015898, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2015882, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002357, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2015889, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3241206, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3314761, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2015898, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002357, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3188672, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3188672, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3278510, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (868452, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128288, 73)
    	and df2:predictions_df Shape: (128288, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128288, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (716251, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (459830, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002357, 22)

INFO:root:Fetched Inspections_df shape: (3241206, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3241206, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3314761, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2015898, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2015898, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2015882, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002357, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2015889, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3241206, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3314761, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2015898, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002357, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3188672, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3188672, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3278510, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (868452, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128288, 73)
    	and df2:predictions_df Shape: (128288, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128288, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (716251, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (459830, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002357, 22)

INFO:root:Fetched Inspections_df shape: (3241206, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3241206, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3314761, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2015898, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2015898, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2015882, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002357, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2015889, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3241206, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3314761, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2015898, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002357, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3188672, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3188672, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3278510, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (868452, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128288, 73)
    	and df2:predictions_df Shape: (128288, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128288, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (716251, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (459830, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002357, 22)

INFO:root:Fetched Inspections_df shape: (3241206, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3241206, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3314761, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2015898, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2015898, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2015882, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002357, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2015889, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3241206, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3314761, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2015898, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002357, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3188672, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3188672, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3278510, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (868452, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128288, 73)
    	and df2:predictions_df Shape: (128288, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128288, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (716251, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (459830, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002357, 22)

INFO:root:Fetched Inspections_df shape: (3241206, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3241206, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3314761, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2015898, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2015898, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2015882, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002357, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2015889, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3241206, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3314761, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2015898, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002357, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3188672, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3188672, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3278510, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (868452, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128288, 73)
    	and df2:predictions_df Shape: (128288, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128288, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (716251, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (459830, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002357, 22)

INFO:root:Fetched Inspections_df shape: (3241206, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3241206, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3314761, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2015898, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2015898, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2015882, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002357, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2015889, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3241206, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3314761, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2015898, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002357, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3188672, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3188672, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3278510, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (868452, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128288, 73)
    	and df2:predictions_df Shape: (128288, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128288, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (716251, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (459830, 47)
        
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (1757563, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (1780239, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (1757563, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2136242, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (1757563, 2)
    and df2:n_pois_per_grid Shape: (1757563, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1757563, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (1757563, 4)
    and df2:populationsGrids Shape: (1757563, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1757563, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (1757563, 5)
    and df2:populationsGrids Shape: (1757563, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1757563, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1389, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1379717, 11)
    		and df2:licensesKeysDf Shape: (3800, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1379717, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (917013, 17) 
        and df2:licensesDf Shape: (917013, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (564681, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (1973562, 30)
    	and df2:licensesDf Shape: (917013, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1334022, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (380684, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (380684, 25)
    	and df2:xgb_predict_df Shape: (380684, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (380684, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (380684, 28)
    	and df2:licenses_df Shape: (917013, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (380684, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (5657, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (5657, 2)
    	and df2:amanaPopulationOverlay Shape: (1757563, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (1757563, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:amanaPopulationOverlay Shape: (1757563, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (1757563, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (1757563, 14)
    	and predictions_df Shape: (380684, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (1987463, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (1757563, 8)
    	and df2:grid_level_new_businesses Shape: (1757563, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (1757563, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (1757563, 2)
    	and df2:poiData Shape: (1757563, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (1757563, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (1757563, 5)
    	and df2:population_per_grid Shape: (1757563, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (1757563, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (1757563, 2)
    	and df2:licenses_per_grid Shape: (1757563, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (1757563, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (1757563, 2)
    	and df2:licenses_per_grid Shape: (1757563, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (1757563, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (1757563, 9)
    	and df2:n_priority_areas_per_grid Shape: (1757563, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (1757563, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (1987463, 53)
    	and df2:points_for_qgis Shape: (380684, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (404804, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (404804, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (380684, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (380684, 43)
    	and df2:data.amanaPopulationOverlay Shape: (1757563, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (218686, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (12154, 17)
    	and df2:n_licenses_per_facility Shape: (12168, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (12154, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (1757563, 20)
    	and df2:grid_level_license_risks Shape: (1757563, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (1757563, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (1757563, 30)
    	and df2:licenses_per_facility Shape: (12154, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (1757563, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (1757563, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (218686, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (218686, 46)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002490, 22)

INFO:root:Fetched Inspections_df shape: (3243782, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3243782, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3317419, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2018368, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2018368, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2018352, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002490, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2018359, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3243782, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3317419, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2018368, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002490, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3190858, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3190858, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3280832, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (869917, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128360, 73)
    	and df2:predictions_df Shape: (128360, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128360, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (717139, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (460414, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002490, 22)

INFO:root:Fetched Inspections_df shape: (3243782, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3243782, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3317419, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2018368, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2018368, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2018352, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002490, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2018359, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3243782, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3317419, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2018368, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002490, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3190858, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3190858, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3280832, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (869917, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128360, 73)
    	and df2:predictions_df Shape: (128360, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128360, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (717139, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (460414, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002490, 22)

INFO:root:Fetched Inspections_df shape: (3243782, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3243782, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3317419, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2018368, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2018368, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2018352, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002490, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2018359, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3243782, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3317419, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2018368, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002490, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3190858, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3190858, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3280832, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (869917, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128360, 73)
    	and df2:predictions_df Shape: (128360, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128360, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (717139, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (460414, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002490, 22)

INFO:root:Fetched Inspections_df shape: (3243782, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3243782, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3317419, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2018368, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2018368, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2018352, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002490, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2018359, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3243782, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3317419, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2018368, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002490, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3190858, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3190858, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3280832, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (869917, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128360, 73)
    	and df2:predictions_df Shape: (128360, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128360, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (717139, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (460414, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002490, 22)

INFO:root:Fetched Inspections_df shape: (3243782, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3243782, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3317419, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2018368, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2018368, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2018352, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002490, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2018359, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3243782, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3317419, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2018368, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002490, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3190858, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3190858, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3280832, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (869917, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128360, 73)
    	and df2:predictions_df Shape: (128360, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128360, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (717139, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (460414, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002490, 22)

INFO:root:Fetched Inspections_df shape: (3243782, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3243782, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3317419, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2018368, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2018368, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2018352, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002490, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2018359, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3243782, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3317419, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2018368, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002490, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3190858, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3190858, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3280832, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (869917, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128360, 73)
    	and df2:predictions_df Shape: (128360, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128360, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (717139, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (460414, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002490, 22)

INFO:root:Fetched Inspections_df shape: (3243782, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3243782, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3317419, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2018368, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2018368, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2018352, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002490, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2018359, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3243782, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3317419, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2018368, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002490, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3190858, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3190858, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3280832, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (869917, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128360, 73)
    	and df2:predictions_df Shape: (128360, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128360, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (717139, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (460414, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002490, 22)

INFO:root:Fetched Inspections_df shape: (3243782, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3243782, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3317419, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2018368, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2018368, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2018352, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002490, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2018359, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3243782, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3317419, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2018368, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002490, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3190858, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3190858, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3280832, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (869917, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128360, 73)
    	and df2:predictions_df Shape: (128360, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128360, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (717139, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (460414, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002795, 22)

INFO:root:Fetched Inspections_df shape: (3247353, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3247353, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3321207, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2021914, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2021914, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2021898, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002795, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2021905, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3247353, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3321207, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2021914, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002795, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3194094, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3194094, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3284466, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (871751, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128481, 73)
    	and df2:predictions_df Shape: (128481, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128481, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (718084, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (461022, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002795, 22)

INFO:root:Fetched Inspections_df shape: (3247353, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3247353, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3321207, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2021914, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2021914, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2021898, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002795, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2021905, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3247353, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3321207, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2021914, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002795, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3194094, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3194094, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3284466, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (871751, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128475, 73)
    	and df2:predictions_df Shape: (128475, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128475, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (718084, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (461022, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002795, 22)

INFO:root:Fetched Inspections_df shape: (3247353, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3247353, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3321207, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2021914, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2021914, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2021898, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002795, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2021905, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3247353, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3321207, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2021914, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002795, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3194094, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3194094, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3284466, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (871751, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128475, 73)
    	and df2:predictions_df Shape: (128475, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128475, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (718084, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (461022, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002795, 22)

INFO:root:Fetched Inspections_df shape: (3247353, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3247353, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3321207, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2021914, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2021914, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2021898, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002795, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2021905, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3247353, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3321207, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2021914, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002795, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3194094, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3194094, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3284466, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (871751, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128475, 73)
    	and df2:predictions_df Shape: (128475, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128475, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (718084, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (461022, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002795, 22)

INFO:root:Fetched Inspections_df shape: (3247353, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3247353, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3321207, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2021914, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2021914, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2021898, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002795, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2021905, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3247353, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3321207, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2021914, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002795, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3194094, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3194094, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3284466, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (871751, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128475, 73)
    	and df2:predictions_df Shape: (128475, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128475, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (718084, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (461022, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002795, 22)

INFO:root:Fetched Inspections_df shape: (3247353, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3247353, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3321207, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2021914, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2021914, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2021898, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002795, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2021905, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3247353, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3321207, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2021914, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002795, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3194094, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3194094, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3284466, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (871751, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128475, 73)
    	and df2:predictions_df Shape: (128475, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128475, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (718084, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (461022, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002795, 22)

INFO:root:Fetched Inspections_df shape: (3247353, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3247353, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3321207, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2021914, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2021914, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2021898, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002795, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2021905, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3247353, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3321207, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2021914, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002795, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3194094, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3194094, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3284466, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (871751, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128475, 73)
    	and df2:predictions_df Shape: (128475, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128475, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (718084, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (461022, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002795, 22)

INFO:root:Fetched Inspections_df shape: (3247353, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3247353, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3321207, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2021914, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2021914, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2021898, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002795, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2021905, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3247353, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3321207, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2021914, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002795, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3194094, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3194094, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3284466, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (871751, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128475, 73)
    	and df2:predictions_df Shape: (128475, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128475, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (718084, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (461022, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2002795, 22)

INFO:root:Fetched Inspections_df shape: (3247353, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3247353, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3321207, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2021914, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2021914, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2021898, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2002795, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2021905, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3247353, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3321207, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2021914, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2002795, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3194094, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3194094, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3284466, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (871751, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128475, 73)
    	and df2:predictions_df Shape: (128475, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128475, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (718988, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (461618, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2003178, 22)

INFO:root:Fetched Inspections_df shape: (3250267, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3250267, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3324318, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2025045, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2025045, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2025029, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2003178, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2025036, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3250267, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3324318, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2025045, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2003178, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3197138, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3197138, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3287858, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (873335, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128589, 73)
    	and df2:predictions_df Shape: (128589, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128589, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (718988, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (461618, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2003178, 22)

INFO:root:Fetched Inspections_df shape: (3250267, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3250267, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3324318, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2025045, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2025045, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2025029, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2003178, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2025036, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3250267, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3324318, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2025045, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2003178, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3197138, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3197138, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3287858, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (873335, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128589, 73)
    	and df2:predictions_df Shape: (128589, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128589, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (718988, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (461618, 47)
        
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (1757563, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (1780239, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (1757563, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2136222, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (1757563, 2)
    and df2:n_pois_per_grid Shape: (1757563, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1757563, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (1757563, 4)
    and df2:populationsGrids Shape: (1757563, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1757563, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (1757563, 5)
    and df2:populationsGrids Shape: (1757563, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1757563, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1389, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1380510, 11)
    		and df2:licensesKeysDf Shape: (3800, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1380510, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (917432, 17) 
        and df2:licensesDf Shape: (917432, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (567420, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (1980646, 30)
    	and df2:licensesDf Shape: (917432, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1336831, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (380587, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (380587, 25)
    	and df2:xgb_predict_df Shape: (380587, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (380587, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (380587, 28)
    	and df2:licenses_df Shape: (917432, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (380587, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (5657, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (5657, 2)
    	and df2:amanaPopulationOverlay Shape: (1757563, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (1757563, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:amanaPopulationOverlay Shape: (1757563, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (1757563, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (1757563, 14)
    	and predictions_df Shape: (380587, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (1987369, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (1757563, 8)
    	and df2:grid_level_new_businesses Shape: (1757563, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (1757563, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (1757563, 2)
    	and df2:poiData Shape: (1757563, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (1757563, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (1757563, 5)
    	and df2:population_per_grid Shape: (1757563, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (1757563, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (1757563, 2)
    	and df2:licenses_per_grid Shape: (1757563, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (1757563, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (1757563, 2)
    	and df2:licenses_per_grid Shape: (1757563, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (1757563, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (1757563, 9)
    	and df2:n_priority_areas_per_grid Shape: (1757563, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (1757563, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (1987369, 53)
    	and df2:points_for_qgis Shape: (380587, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (404690, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (404690, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (380587, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (380587, 43)
    	and df2:data.amanaPopulationOverlay Shape: (1757563, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (218603, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (12149, 17)
    	and df2:n_licenses_per_facility Shape: (12163, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (12149, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (1757563, 20)
    	and df2:grid_level_license_risks Shape: (1757563, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (1757563, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (1757563, 30)
    	and df2:licenses_per_facility Shape: (12149, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (1757563, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (1757563, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (218603, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (218603, 46)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2003269, 22)

INFO:root:Fetched Inspections_df shape: (3251147, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3251147, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3325256, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2025875, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2025875, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2025859, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2003269, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2025866, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3251147, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3325256, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2025875, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2003269, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3197916, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3197916, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3288736, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (873650, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128605, 73)
    	and df2:predictions_df Shape: (128605, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128605, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (719844, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (462166, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2003269, 22)

INFO:root:Fetched Inspections_df shape: (3251147, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3251147, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3325256, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2025875, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2025875, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2025859, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2003269, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2025866, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3251147, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3325256, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2025875, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2003269, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3197916, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3197916, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3288736, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (873650, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128605, 73)
    	and df2:predictions_df Shape: (128605, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128605, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (720742, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (462754, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2003507, 22)

INFO:root:Fetched Inspections_df shape: (3253464, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3253464, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3327724, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2027662, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2027662, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2027646, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2003507, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2027653, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:Fetched population_grids shape: (1757563, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1759903, 3)
INFO:root:Read pois_licenses_comparison shape: (1759903, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3253464, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3327724, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2027662, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2003507, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3199623, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3199623, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3290683, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (874306, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1757563, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (3367, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1757563, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (7895, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128647, 73)
    	and df2:predictions_df Shape: (128647, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128647, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1757563, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (5257, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (5257, 2)
    	and df2:population_grids Shape: (1757563, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:population_grids Shape: (1757563, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1757563, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (720742, 32)
    	and df2:geometry_per_grid Shape: (1757563, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (462754, 47)
        
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (1757563, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (1757563, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (1780239, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (1757563, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2136209, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (1757563, 2)
    and df2:n_pois_per_grid Shape: (1757563, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1757563, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (1757563, 4)
    and df2:populationsGrids Shape: (1757563, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1757563, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (1757563, 5)
    and df2:populationsGrids Shape: (1757563, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1757563, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1389, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1380750, 11)
    		and df2:licensesKeysDf Shape: (3800, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1380750, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (917558, 17) 
        and df2:licensesDf Shape: (917558, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (568262, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (1982313, 30)
    	and df2:licensesDf Shape: (917558, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1337685, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (380525, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (380525, 25)
    	and df2:xgb_predict_df Shape: (380525, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (380525, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (380525, 28)
    	and df2:licenses_df Shape: (917558, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (380525, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (5657, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (5657, 2)
    	and df2:amanaPopulationOverlay Shape: (1757563, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (1757563, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (1757563, 7)
    	and df2:amanaPopulationOverlay Shape: (1757563, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (1757563, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (1757563, 14)
    	and predictions_df Shape: (380525, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (1987342, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (1757563, 8)
    	and df2:grid_level_new_businesses Shape: (1757563, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (1757563, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (1757563, 2)
    	and df2:poiData Shape: (1757563, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (1757563, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (1757563, 5)
    	and df2:population_per_grid Shape: (1757563, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (1757563, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (1757563, 2)
    	and df2:licenses_per_grid Shape: (1757563, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (1757563, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (1757563, 2)
    	and df2:licenses_per_grid Shape: (1757563, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (1757563, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (1757563, 9)
    	and df2:n_priority_areas_per_grid Shape: (1757563, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (1757563, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (1987342, 53)
    	and df2:points_for_qgis Shape: (380525, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (404621, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (404621, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (380525, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (380525, 43)
    	and df2:data.amanaPopulationOverlay Shape: (1757563, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (218584, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (12150, 17)
    	and df2:n_licenses_per_facility Shape: (12164, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (12150, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (1757563, 20)
    	and df2:grid_level_license_risks Shape: (1757563, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (1757563, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (1757563, 30)
    	and df2:licenses_per_facility Shape: (12150, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (1757563, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (1757563, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (218584, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (218584, 46)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2003915, 22)

INFO:root:Fetched Inspections_df shape: (3262208, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3262208, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3336862, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2034256, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2034256, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2034240, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2003915, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2034242, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015322, 13)
INFO:root:Fetched population_grids shape: (2015322, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2015322, 3)
INFO:root:Read pois_licenses_comparison shape: (2015322, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3262208, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3336862, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2034256, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2003915, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3205468, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3205468, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3297156, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (877167, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2015322, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5484, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2015322, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (12291, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (128857, 73)
    	and df2:predictions_df Shape: (128857, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (128857, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015322, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9507, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9507, 2)
    	and df2:population_grids Shape: (2015322, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015322, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015322, 7)
    	and df2:population_grids Shape: (2015322, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015322, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (721981, 32)
    	and df2:geometry_per_grid Shape: (2015322, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (721854, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015322, 7)
    	and df2:population_grids Shape: (2015322, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015322, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (128362, 78)
    	and df2:population_grids Shape: (2015322, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (128356, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13473, 2)
    	and df2:pois_data Shape: (2015322, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13473, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13473, 5)
    	and df2:population_per_grid Shape: (2015322, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13473, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13473, 3)
    	and df2:licenses_per_grid Shape: (13473, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13473, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13473, 9)
    	and df2:geometry_per_grid Shape: (2015322, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (13473, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13473, 23)
    	and df2:n_priority_areas_per_grid Shape: (2015322, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (13473, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13473, 3)
    	and df2:licenses_per_grid Shape: (13473, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (13473, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (128356, 94)
    	and df2:points_for_qgis Shape: (128362, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (128362, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (128362, 24)
    	and df2:population_grids Shape: (2015322, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (128356, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (13473, 10)
    	and df2:n_licenses_per_facility Shape: (13473, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13473, 11)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (13473, 52)
    	and df2:grid_level_license_risks Shape: (13473, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13473, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (13473, 59)
    	and df2:licenses_per_facility Shape: (13473, 12)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13473, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1389, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015322, 15)
    	and df2:population_grids Shape: (2015322, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015322, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (128356, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (128356, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2015322, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (13473, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (13473, 18)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015322, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015322, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (2052090, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015322, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2603810, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (2015322, 2)
    and df2:n_pois_per_grid Shape: (2015322, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015322, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015322, 4)
    and df2:populationsGrids Shape: (2015322, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015322, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015322, 5)
    and df2:populationsGrids Shape: (2015322, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015322, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1389, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1381655, 11)
    		and df2:licensesKeysDf Shape: (3800, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1381655, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (917859, 17) 
        and df2:licensesDf Shape: (917859, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (570828, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (1988593, 30)
    	and df2:licensesDf Shape: (917859, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1340314, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (380816, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (380816, 25)
    	and df2:xgb_predict_df Shape: (380816, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (380816, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (380816, 28)
    	and df2:licenses_df Shape: (917859, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (380816, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (9507, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (9507, 2)
    	and df2:amanaPopulationOverlay Shape: (2015322, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015322, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (2015322, 7)
    	and df2:amanaPopulationOverlay Shape: (2015322, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015322, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (2015322, 14)
    	and predictions_df Shape: (380816, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (2374128, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (2015322, 8)
    	and df2:grid_level_new_businesses Shape: (2015322, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015322, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015322, 2)
    	and df2:poiData Shape: (2015322, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015322, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015322, 5)
    	and df2:population_per_grid Shape: (2015322, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015322, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015322, 2)
    	and df2:licenses_per_grid Shape: (2015322, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015322, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015322, 2)
    	and df2:licenses_per_grid Shape: (2015322, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015322, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2015322, 9)
    	and df2:n_priority_areas_per_grid Shape: (2015322, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (2015322, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2374128, 53)
    	and df2:points_for_qgis Shape: (380816, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (380821, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (380821, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (380816, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (380816, 43)
    	and df2:data.amanaPopulationOverlay Shape: (2015322, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (380806, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (21983, 17)
    	and df2:n_licenses_per_facility Shape: (22004, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (21983, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (2015322, 20)
    	and df2:grid_level_license_risks Shape: (2015322, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015322, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (2015322, 30)
    	and df2:licenses_per_facility Shape: (21983, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015322, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (2015322, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (380806, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (380806, 46)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2004979, 22)

INFO:root:Fetched Inspections_df shape: (3275978, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3275978, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3351304, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2062975, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2062975, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2062959, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2004979, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2062961, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015322, 13)
INFO:root:Fetched population_grids shape: (2015322, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2027486, 3)
INFO:root:Read pois_licenses_comparison shape: (2027486, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3275978, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3351304, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2062975, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2004979, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3231332, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3231332, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3330790, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (890027, 68)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2005626, 22)

INFO:root:Fetched Inspections_df shape: (3284439, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3284439, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3360054, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2068769, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2068769, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2068753, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2005626, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2068755, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015322, 13)
INFO:root:Fetched population_grids shape: (2015322, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2027486, 3)
INFO:root:Read pois_licenses_comparison shape: (2027486, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3284439, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3360054, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2068769, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2005626, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3236589, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3236589, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3336581, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (892831, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2015322, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5484, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2015322, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (12291, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (129527, 73)
    	and df2:predictions_df Shape: (129527, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (129527, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015322, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9484, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9484, 2)
    	and df2:population_grids Shape: (2015322, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015322, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015322, 7)
    	and df2:population_grids Shape: (2015322, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2027486, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (725191, 32)
    	and df2:geometry_per_grid Shape: (2015322, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (724653, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2027486, 7)
    	and df2:population_grids Shape: (2009240, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2027486, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (129032, 78)
    	and df2:population_grids Shape: (2015322, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (128803, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13450, 2)
    	and df2:pois_data Shape: (2027486, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13555, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13555, 5)
    	and df2:population_per_grid Shape: (2015322, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13695, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13450, 3)
    	and df2:licenses_per_grid Shape: (13695, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13695, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13695, 9)
    	and df2:geometry_per_grid Shape: (2009240, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (13695, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13695, 23)
    	and df2:n_priority_areas_per_grid Shape: (2027486, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (14535, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13450, 3)
    	and df2:licenses_per_grid Shape: (13695, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (13695, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (128803, 94)
    	and df2:points_for_qgis Shape: (129032, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (129032, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (129032, 24)
    	and df2:population_grids Shape: (2015322, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (128865, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (13450, 10)
    	and df2:n_licenses_per_facility Shape: (13450, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13450, 11)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (14535, 52)
    	and df2:grid_level_license_risks Shape: (13450, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (14535, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (14535, 59)
    	and df2:licenses_per_facility Shape: (13450, 12)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (14535, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1389, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015322, 15)
    	and df2:population_grids Shape: (2015322, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2017492, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (128803, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (128803, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2017492, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (15655, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (15655, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2005626, 22)

INFO:root:Fetched Inspections_df shape: (3284439, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3284439, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3360054, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2068769, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2068769, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2068753, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2005626, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2068755, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015322, 13)
INFO:root:Fetched population_grids shape: (2015322, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2027486, 3)
INFO:root:Read pois_licenses_comparison shape: (2027486, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3284439, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3360054, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2068769, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2005626, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3236589, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3236589, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3336581, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (892831, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2015322, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5484, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2015322, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (12291, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (129522, 73)
    	and df2:predictions_df Shape: (129522, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (129522, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015322, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9484, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9484, 2)
    	and df2:population_grids Shape: (2015322, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015322, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015322, 7)
    	and df2:population_grids Shape: (2015322, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2027486, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (726191, 32)
    	and df2:geometry_per_grid Shape: (2015322, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (725653, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2027486, 7)
    	and df2:population_grids Shape: (2009240, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2027486, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (129027, 78)
    	and df2:population_grids Shape: (2015322, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (128798, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13450, 2)
    	and df2:pois_data Shape: (2027486, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13555, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13555, 5)
    	and df2:population_per_grid Shape: (2015322, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13695, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13450, 3)
    	and df2:licenses_per_grid Shape: (13695, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13695, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13695, 9)
    	and df2:geometry_per_grid Shape: (2009240, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (13695, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13695, 23)
    	and df2:n_priority_areas_per_grid Shape: (2027486, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (14535, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13450, 3)
    	and df2:licenses_per_grid Shape: (13695, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (13695, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (128798, 94)
    	and df2:points_for_qgis Shape: (129027, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (129027, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (129027, 24)
    	and df2:population_grids Shape: (2015322, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (128860, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (13450, 10)
    	and df2:n_licenses_per_facility Shape: (13450, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13450, 11)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (14535, 52)
    	and df2:grid_level_license_risks Shape: (13450, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (14535, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (14535, 59)
    	and df2:licenses_per_facility Shape: (13450, 12)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (14535, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1389, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015322, 15)
    	and df2:population_grids Shape: (2015322, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2017492, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (128798, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (128798, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2017492, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (15655, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (15655, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2006504, 22)

INFO:root:Fetched Inspections_df shape: (3293458, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3293458, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3369346, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2075365, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2075365, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2075349, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2006504, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2075351, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015322, 13)
INFO:root:Fetched population_grids shape: (2015322, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2027486, 3)
INFO:root:Read pois_licenses_comparison shape: (2027486, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3293458, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3369346, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2075365, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2006504, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3242617, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3242617, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3343117, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (896122, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2015322, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5484, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2015322, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (12291, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (129798, 73)
    	and df2:predictions_df Shape: (129798, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (129798, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015322, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9484, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9484, 2)
    	and df2:population_grids Shape: (2015322, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015322, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015322, 7)
    	and df2:population_grids Shape: (2015322, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2027486, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (727724, 32)
    	and df2:geometry_per_grid Shape: (2015322, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (727188, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2027486, 7)
    	and df2:population_grids Shape: (2009240, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2027486, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (129306, 78)
    	and df2:population_grids Shape: (2015322, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (129075, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13467, 2)
    	and df2:pois_data Shape: (2027486, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13572, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13572, 5)
    	and df2:population_per_grid Shape: (2015322, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13712, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13467, 3)
    	and df2:licenses_per_grid Shape: (13712, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13712, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13712, 9)
    	and df2:geometry_per_grid Shape: (2009240, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (13712, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13712, 23)
    	and df2:n_priority_areas_per_grid Shape: (2027486, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (14552, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13467, 3)
    	and df2:licenses_per_grid Shape: (13712, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (13712, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (129075, 94)
    	and df2:points_for_qgis Shape: (129306, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (129306, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (129306, 24)
    	and df2:population_grids Shape: (2015322, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (129138, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (13467, 10)
    	and df2:n_licenses_per_facility Shape: (13467, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13467, 11)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (14552, 52)
    	and df2:grid_level_license_risks Shape: (13467, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (14552, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (14552, 59)
    	and df2:licenses_per_facility Shape: (13467, 12)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (14552, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1389, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015322, 15)
    	and df2:population_grids Shape: (2015322, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2017492, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (129075, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (129075, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2017492, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (15672, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (15672, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2006906, 22)

INFO:root:Fetched Inspections_df shape: (3305496, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3305496, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3381785, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2084409, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2084409, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2084393, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2006906, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2084395, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015395, 13)
INFO:root:Fetched population_grids shape: (2015395, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2033545, 3)
INFO:root:Read pois_licenses_comparison shape: (2033545, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3305496, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3381785, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2084409, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2006906, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3250102, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3250102, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3351314, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (900438, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2015395, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5484, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2015395, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (12291, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (130031, 73)
    	and df2:predictions_df Shape: (130031, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (130031, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015395, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9487, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9487, 2)
    	and df2:population_grids Shape: (2015395, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015395, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015395, 7)
    	and df2:population_grids Shape: (2015395, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2033545, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (728833, 32)
    	and df2:geometry_per_grid Shape: (2015395, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (728435, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2033545, 7)
    	and df2:population_grids Shape: (2006320, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2033545, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (129538, 78)
    	and df2:population_grids Shape: (2015395, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (129340, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13474, 2)
    	and df2:pois_data Shape: (2033545, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13588, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13588, 5)
    	and df2:population_per_grid Shape: (2015395, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13740, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13474, 3)
    	and df2:licenses_per_grid Shape: (13740, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13740, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13740, 9)
    	and df2:geometry_per_grid Shape: (2006320, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (13740, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13740, 23)
    	and df2:n_priority_areas_per_grid Shape: (2033545, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (14652, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13474, 3)
    	and df2:licenses_per_grid Shape: (13740, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (13740, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (129340, 94)
    	and df2:points_for_qgis Shape: (129538, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (129538, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (129538, 24)
    	and df2:population_grids Shape: (2015395, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (129491, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (13474, 11)
    	and df2:n_licenses_per_facility Shape: (13474, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13474, 12)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (14652, 52)
    	and df2:grid_level_license_risks Shape: (13474, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (14652, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (14652, 59)
    	and df2:licenses_per_facility Shape: (13474, 13)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (14652, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1389, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015395, 15)
    	and df2:population_grids Shape: (2015395, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2017751, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (129340, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (129340, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2017751, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (15868, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (15868, 18)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015395, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015395, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (2052163, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015395, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2604382, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (2015395, 2)
    and df2:n_pois_per_grid Shape: (2015395, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015395, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015395, 4)
    and df2:populationsGrids Shape: (2015395, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015395, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015395, 5)
    and df2:populationsGrids Shape: (2015395, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015395, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1389, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (0, 11)
    		and df2:licensesKeysDf Shape: (3800, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (0, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (0, 17) 
        and df2:licensesDf Shape: (0, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (0, 47)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2007589, 22)

INFO:root:Fetched Inspections_df shape: (3314821, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3314821, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3391409, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2092234, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2092234, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2092218, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2007589, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2092220, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015395, 13)
INFO:root:Fetched population_grids shape: (2015395, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2033545, 3)
INFO:root:Read pois_licenses_comparison shape: (2033545, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3314821, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3391409, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2092234, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2007589, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3256934, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3256934, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3358674, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (904096, 68)
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2008132, 22)

INFO:root:Fetched Inspections_df shape: (3323309, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3323309, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3400189, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2099635, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2099635, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2099619, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2008132, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2099621, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015395, 13)
INFO:root:Fetched population_grids shape: (2015395, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2033545, 3)
INFO:root:Read pois_licenses_comparison shape: (2033545, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3323309, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3400189, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2099635, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2008132, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3263307, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3263307, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3365541, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (907729, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2015395, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5484, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2015395, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (12291, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (130471, 73)
    	and df2:predictions_df Shape: (130471, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (130471, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015395, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9487, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9487, 2)
    	and df2:population_grids Shape: (2015395, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015395, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015395, 7)
    	and df2:population_grids Shape: (2015395, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2033545, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (730627, 32)
    	and df2:geometry_per_grid Shape: (2015395, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (730229, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2033545, 7)
    	and df2:population_grids Shape: (2006320, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2033545, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (129975, 78)
    	and df2:population_grids Shape: (2015395, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (129774, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13507, 2)
    	and df2:pois_data Shape: (2033545, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13621, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13621, 5)
    	and df2:population_per_grid Shape: (2015395, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13773, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13507, 3)
    	and df2:licenses_per_grid Shape: (13773, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13773, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13773, 9)
    	and df2:geometry_per_grid Shape: (2006320, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (13773, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13773, 23)
    	and df2:n_priority_areas_per_grid Shape: (2033545, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (14685, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13507, 3)
    	and df2:licenses_per_grid Shape: (13773, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (13773, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (129774, 94)
    	and df2:points_for_qgis Shape: (129975, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (129975, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (129975, 24)
    	and df2:population_grids Shape: (2015395, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (129926, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (13507, 11)
    	and df2:n_licenses_per_facility Shape: (13507, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13507, 12)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (14685, 52)
    	and df2:grid_level_license_risks Shape: (13507, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (14685, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (14685, 59)
    	and df2:licenses_per_facility Shape: (13507, 13)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (14685, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1389, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015395, 15)
    	and df2:population_grids Shape: (2015395, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2017751, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (129774, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (129774, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2017751, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (15901, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (15901, 18)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015395, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015395, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (2052163, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015395, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2606354, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (2015395, 2)
    and df2:n_pois_per_grid Shape: (2015395, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015395, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015395, 4)
    and df2:populationsGrids Shape: (2015395, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015395, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015395, 5)
    and df2:populationsGrids Shape: (2015395, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015395, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1389, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1385432, 11)
    		and df2:licensesKeysDf Shape: (3800, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1385432, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (920231, 17) 
        and df2:licensesDf Shape: (920231, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (594236, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (2048720, 30)
    	and df2:licensesDf Shape: (920231, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1362508, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (382446, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (382446, 25)
    	and df2:xgb_predict_df Shape: (382446, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (382446, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (382446, 28)
    	and df2:licenses_df Shape: (920231, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (382446, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (9496, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (9496, 2)
    	and df2:amanaPopulationOverlay Shape: (2015395, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015395, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (2015395, 7)
    	and df2:amanaPopulationOverlay Shape: (2015395, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015395, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (2015395, 14)
    	and predictions_df Shape: (382446, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (2375719, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (2015395, 8)
    	and df2:grid_level_new_businesses Shape: (2015395, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015395, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015395, 2)
    	and df2:poiData Shape: (2015395, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015395, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015395, 5)
    	and df2:population_per_grid Shape: (2015395, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015395, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015395, 2)
    	and df2:licenses_per_grid Shape: (2015395, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015395, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015395, 2)
    	and df2:licenses_per_grid Shape: (2015395, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015395, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2015395, 9)
    	and df2:n_priority_areas_per_grid Shape: (2015395, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (2015395, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2375719, 53)
    	and df2:points_for_qgis Shape: (382446, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (382724, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (382724, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (382446, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (382446, 43)
    	and df2:data.amanaPopulationOverlay Shape: (2015395, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (382057, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (21921, 17)
    	and df2:n_licenses_per_facility Shape: (21942, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (21921, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (2015395, 20)
    	and df2:grid_level_license_risks Shape: (2015395, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015395, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (2015395, 30)
    	and df2:licenses_per_facility Shape: (21921, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015395, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (2015395, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (382057, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (382057, 46)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2009373, 22)

INFO:root:Fetched Inspections_df shape: (3335679, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3335679, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3413043, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2110914, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2110914, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2110898, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2009373, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2110900, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015395, 13)
INFO:root:Fetched population_grids shape: (2015395, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2033545, 3)
INFO:root:Read pois_licenses_comparison shape: (2033545, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3335679, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3413043, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2110914, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2009373, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3273619, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3273619, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3376761, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (913200, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2015395, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5484, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2015395, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (12291, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (130769, 73)
    	and df2:predictions_df Shape: (130769, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (130769, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015395, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9487, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9487, 2)
    	and df2:population_grids Shape: (2015395, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015395, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015395, 7)
    	and df2:population_grids Shape: (2015395, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2033545, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (732572, 32)
    	and df2:geometry_per_grid Shape: (2015395, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (732238, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2033545, 7)
    	and df2:population_grids Shape: (2006320, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2033545, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (130266, 78)
    	and df2:population_grids Shape: (2015395, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (130064, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13519, 2)
    	and df2:pois_data Shape: (2033545, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13633, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13633, 5)
    	and df2:population_per_grid Shape: (2015395, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13785, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13519, 3)
    	and df2:licenses_per_grid Shape: (13785, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13785, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13785, 9)
    	and df2:geometry_per_grid Shape: (2006320, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (13785, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13785, 23)
    	and df2:n_priority_areas_per_grid Shape: (2033545, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (14697, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13519, 3)
    	and df2:licenses_per_grid Shape: (13785, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (13785, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (130064, 94)
    	and df2:points_for_qgis Shape: (130266, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (130266, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (130266, 24)
    	and df2:population_grids Shape: (2015395, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (130216, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (13519, 11)
    	and df2:n_licenses_per_facility Shape: (13519, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13519, 12)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (14697, 52)
    	and df2:grid_level_license_risks Shape: (13519, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (14697, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (14697, 59)
    	and df2:licenses_per_facility Shape: (13519, 13)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (14697, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1389, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015395, 15)
    	and df2:population_grids Shape: (2015395, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2017751, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (130064, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (130064, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2017751, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (15913, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (15913, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2009452, 22)

INFO:root:Fetched Inspections_df shape: (3336744, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3336744, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3414148, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2112029, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2112029, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2112013, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2009452, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2112015, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2259498, 13)
INFO:root:Fetched population_grids shape: (2259498, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (6553748, 3)
INFO:root:Read pois_licenses_comparison shape: (6553748, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3336744, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3414148, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2112029, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2009452, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3274548, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3274548, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3377768, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (913741, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2259498, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5484, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2259498, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (12291, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (130765, 73)
    	and df2:predictions_df Shape: (130765, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (130765, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2259498, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9467, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9467, 2)
    	and df2:population_grids Shape: (2259498, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2259498, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2259498, 7)
    	and df2:population_grids Shape: (2259498, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (6553748, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (732881, 32)
    	and df2:geometry_per_grid Shape: (2259498, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (738206, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (6553748, 7)
    	and df2:population_grids Shape: (2005552, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (6553748, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (130261, 78)
    	and df2:population_grids Shape: (2259498, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (129934, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13483, 2)
    	and df2:pois_data Shape: (6553748, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (56478, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (56478, 5)
    	and df2:population_per_grid Shape: (2259498, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (7335680, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13483, 3)
    	and df2:licenses_per_grid Shape: (7335680, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (7335680, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (7335680, 9)
    	and df2:geometry_per_grid Shape: (2005552, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (7335680, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (7335680, 23)
    	and df2:n_priority_areas_per_grid Shape: (6553748, 28)  on='GridNumber'
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2009452, 22)

INFO:root:Fetched Inspections_df shape: (3336744, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3336744, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3414148, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2112029, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2112029, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2112013, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2009452, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2112015, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2259498, 13)
INFO:root:Fetched population_grids shape: (2259498, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (6553748, 3)
INFO:root:Read pois_licenses_comparison shape: (6553748, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3336744, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3414148, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2112029, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2009452, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3274548, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3274548, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3377768, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (913741, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2259498, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5484, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2259498, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (12291, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (130765, 73)
    	and df2:predictions_df Shape: (130765, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (130765, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2259498, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9467, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9467, 2)
    	and df2:population_grids Shape: (2259498, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2259498, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2259498, 7)
    	and df2:population_grids Shape: (2259498, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (6553748, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (732881, 32)
    	and df2:geometry_per_grid Shape: (2259498, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (738206, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (6553748, 7)
    	and df2:population_grids Shape: (2005552, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (6553748, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (130261, 78)
    	and df2:population_grids Shape: (2259498, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (129934, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13483, 2)
    	and df2:pois_data Shape: (6553748, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (56478, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (56478, 5)
    	and df2:population_per_grid Shape: (2259498, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (7335680, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13483, 3)
    	and df2:licenses_per_grid Shape: (7335680, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (7335680, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (7335680, 9)
    	and df2:geometry_per_grid Shape: (2005552, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (7335680, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (7335680, 23)
    	and df2:n_priority_areas_per_grid Shape: (6553748, 28)  on='GridNumber'
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2009452, 22)

INFO:root:Fetched Inspections_df shape: (3336744, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3336744, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3414148, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2112029, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2112029, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2112013, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2009452, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2112015, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2259498, 13)
INFO:root:Fetched population_grids shape: (2259498, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (6553748, 3)
INFO:root:Read pois_licenses_comparison shape: (6553748, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3336744, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3414148, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2112029, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2009452, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3274548, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3274548, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3377768, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (913741, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2259498, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5484, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2259498, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (12291, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (130765, 73)
    	and df2:predictions_df Shape: (130765, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (130765, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2259498, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9467, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9467, 2)
    	and df2:population_grids Shape: (2259498, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2259498, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2259498, 7)
    	and df2:population_grids Shape: (2259498, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (6553748, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (732881, 32)
    	and df2:geometry_per_grid Shape: (2259498, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (738206, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (6553748, 7)
    	and df2:population_grids Shape: (2005552, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (6553748, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (130261, 78)
    	and df2:population_grids Shape: (2259498, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (129934, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13483, 2)
    	and df2:pois_data Shape: (6553748, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (56478, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (56478, 5)
    	and df2:population_per_grid Shape: (2259498, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (7335680, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13483, 3)
    	and df2:licenses_per_grid Shape: (7335680, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (7335680, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (7335680, 9)
    	and df2:geometry_per_grid Shape: (2005552, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (7335680, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (7335680, 23)
    	and df2:n_priority_areas_per_grid Shape: (6553748, 28)  on='GridNumber'
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2009452, 22)

INFO:root:Fetched Inspections_df shape: (3336744, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3336744, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3414148, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2112029, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2112029, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2112013, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2009452, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2112015, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2259498, 13)
INFO:root:Fetched population_grids shape: (2259498, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (6553748, 3)
INFO:root:Read pois_licenses_comparison shape: (6553748, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3336744, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3414148, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2112029, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2009452, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3274548, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3274548, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3377768, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (913741, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2259498, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5484, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2259498, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (12291, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (130765, 73)
    	and df2:predictions_df Shape: (130765, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (130765, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2259498, 14)
    	and df2:priority_areas Shape: (1389, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9467, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9467, 2)
    	and df2:population_grids Shape: (2259498, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2259498, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2259498, 7)
    	and df2:population_grids Shape: (2259498, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (6553748, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (732881, 32)
    	and df2:geometry_per_grid Shape: (2259498, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (738206, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (6553748, 7)
    	and df2:population_grids Shape: (2005552, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (6553748, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (130261, 78)
    	and df2:population_grids Shape: (2259498, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (129934, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13483, 2)
    	and df2:pois_data Shape: (6553748, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (56478, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (56478, 5)
    	and df2:population_per_grid Shape: (2259498, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (7335680, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13483, 3)
    	and df2:licenses_per_grid Shape: (7335680, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (7335680, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (7335680, 9)
    	and df2:geometry_per_grid Shape: (2005552, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (7335680, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (7335680, 23)
    	and df2:n_priority_areas_per_grid Shape: (6553748, 28)  on='GridNumber'
        
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2009773, 22)

INFO:root:Fetched Inspections_df shape: (3338984, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3338984, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3416495, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2114100, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2114100, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2114084, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2009773, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2114086, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2009773, 22)

INFO:root:Fetched Inspections_df shape: (3338984, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3338984, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3416495, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2114100, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2114100, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2114084, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2009773, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2114086, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2010327, 22)

INFO:root:Fetched Inspections_df shape: (3347513, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3347513, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3425412, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2120869, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2120869, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2120853, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2010327, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2120855, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (3941316, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (3978114, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (3941316, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (4542341, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (3941316, 2)
    and df2:n_pois_per_grid Shape: (3941316, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (3941316, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (3941316, 4)
    and df2:populationsGrids Shape: (3941316, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (3941316, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (3941316, 5)
    and df2:populationsGrids Shape: (3941316, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (3941316, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1389, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1387643, 11)
    		and df2:licensesKeysDf Shape: (3800, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1387643, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (921517, 17) 
        and df2:licensesDf Shape: (921517, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (602000, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (2069014, 30)
    	and df2:licensesDf Shape: (921517, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1370442, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (382898, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (382898, 25)
    	and df2:xgb_predict_df Shape: (382898, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (382898, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (382898, 28)
    	and df2:licenses_df Shape: (921517, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (382898, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (9741, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (9741, 2)
    	and df2:amanaPopulationOverlay Shape: (3941316, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (3941316, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (3941316, 7)
    	and df2:amanaPopulationOverlay Shape: (3941316, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (3941316, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (3941316, 14)
    	and predictions_df Shape: (382898, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (4306824, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (3941316, 8)
    	and df2:grid_level_new_businesses Shape: (3941316, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (3941316, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (3941316, 2)
    	and df2:poiData Shape: (3941316, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (3941316, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (3941316, 5)
    	and df2:population_per_grid Shape: (3941316, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (3941316, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (3941316, 2)
    	and df2:licenses_per_grid Shape: (3941316, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (3941316, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (3941316, 2)
    	and df2:licenses_per_grid Shape: (3941316, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (3941316, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (3941316, 9)
    	and df2:n_priority_areas_per_grid Shape: (3941316, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (3941316, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (4306824, 53)
    	and df2:points_for_qgis Shape: (382898, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (392886, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (392886, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (382898, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (382898, 43)
    	and df2:data.amanaPopulationOverlay Shape: (3941316, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (382220, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (21859, 17)
    	and df2:n_licenses_per_facility Shape: (21880, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (21859, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (3941316, 20)
    	and df2:grid_level_license_risks Shape: (3941316, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (3941316, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (3941316, 30)
    	and df2:licenses_per_facility Shape: (21859, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (3941316, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (3941316, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (382220, 46)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (3941316, 14) how="right"
        
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (382220, 46)
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (3978114, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (3941316, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (4542341, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (3941316, 2)
    and df2:n_pois_per_grid Shape: (3941316, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (3941316, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (3941316, 4)
    and df2:populationsGrids Shape: (3941316, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (3941316, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (3941316, 5)
    and df2:populationsGrids Shape: (3941316, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (3941316, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1389, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1387643, 11)
    		and df2:licensesKeysDf Shape: (3800, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1387643, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (921517, 17) 
        and df2:licensesDf Shape: (921517, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (602000, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (2069014, 30)
    	and df2:licensesDf Shape: (921517, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1370442, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (382898, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (382898, 25)
    	and df2:xgb_predict_df Shape: (382898, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (382898, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (382898, 28)
    	and df2:licenses_df Shape: (921517, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (382898, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (9741, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (9741, 2)
    	and df2:amanaPopulationOverlay Shape: (3941316, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (3941316, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (3941316, 7)
    	and df2:amanaPopulationOverlay Shape: (3941316, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (3941316, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (3941316, 14)
    	and predictions_df Shape: (382898, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (4306824, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (3941316, 8)
    	and df2:grid_level_new_businesses Shape: (3941316, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (3941316, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (3941316, 2)
    	and df2:poiData Shape: (3941316, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (3941316, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (3941316, 5)
    	and df2:population_per_grid Shape: (3941316, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (3941316, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (3941316, 2)
    	and df2:licenses_per_grid Shape: (3941316, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (3941316, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (3941316, 2)
    	and df2:licenses_per_grid Shape: (3941316, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (3941316, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (3941316, 9)
    	and df2:n_priority_areas_per_grid Shape: (3941316, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (3941316, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (4306824, 53)
    	and df2:points_for_qgis Shape: (382898, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (392886, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (392886, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (382898, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (382898, 43)
    	and df2:data.amanaPopulationOverlay Shape: (3941316, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (382220, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (21859, 17)
    	and df2:n_licenses_per_facility Shape: (21880, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (21859, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (3941316, 20)
    	and df2:grid_level_license_risks Shape: (3941316, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (3941316, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (3941316, 30)
    	and df2:licenses_per_facility Shape: (21859, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (3941316, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (3941316, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (382220, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (382220, 46)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2010327, 22)

INFO:root:Fetched Inspections_df shape: (3347513, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3347513, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3425412, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2120869, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2120869, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2120853, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2010327, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2120855, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2010327, 22)

INFO:root:Fetched Inspections_df shape: (3347513, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3347513, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3425412, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2120869, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2120869, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2120853, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2010327, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2120855, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (3941316, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (3978114, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (3941316, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (4542305, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (3941316, 2)
    and df2:n_pois_per_grid Shape: (3941316, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (3941316, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (3941316, 4)
    and df2:populationsGrids Shape: (3941316, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (3941316, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (3941316, 5)
    and df2:populationsGrids Shape: (3941316, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (3941316, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1389, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1387936, 11)
    		and df2:licensesKeysDf Shape: (3800, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1387936, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (921697, 17) 
        and df2:licensesDf Shape: (921697, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (604678, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (2076115, 30)
    	and df2:licensesDf Shape: (921697, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1372939, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (382846, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (382846, 25)
    	and df2:xgb_predict_df Shape: (382846, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (382846, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (382846, 28)
    	and df2:licenses_df Shape: (921697, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (382846, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (9741, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (9741, 2)
    	and df2:amanaPopulationOverlay Shape: (3941316, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (3941316, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (3941316, 7)
    	and df2:amanaPopulationOverlay Shape: (3941316, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (3941316, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (3941316, 14)
    	and predictions_df Shape: (382846, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (4306779, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (3941316, 8)
    	and df2:grid_level_new_businesses Shape: (3941316, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (3941316, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (3941316, 2)
    	and df2:poiData Shape: (3941316, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (3941316, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (3941316, 5)
    	and df2:population_per_grid Shape: (3941316, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (3941316, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (3941316, 2)
    	and df2:licenses_per_grid Shape: (3941316, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (3941316, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (3941316, 2)
    	and df2:licenses_per_grid Shape: (3941316, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (3941316, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (3941316, 9)
    	and df2:n_priority_areas_per_grid Shape: (3941316, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (3941316, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (4306779, 53)
    	and df2:points_for_qgis Shape: (382846, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (392829, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (392829, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (382846, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (382846, 43)
    	and df2:data.amanaPopulationOverlay Shape: (3941316, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (382167, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (21855, 17)
    	and df2:n_licenses_per_facility Shape: (21876, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (21855, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (3941316, 20)
    	and df2:grid_level_license_risks Shape: (3941316, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (3941316, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (3941316, 30)
    	and df2:licenses_per_facility Shape: (21855, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (3941316, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (3941316, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (382167, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (382167, 46)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2010610, 22)

INFO:root:Fetched Inspections_df shape: (3355572, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3355572, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3433817, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2128279, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2128279, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2128263, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2010610, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2128265, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2010610, 22)

INFO:root:Fetched Inspections_df shape: (3355572, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3355572, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3433817, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2128279, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2128279, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2128263, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2010610, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2128265, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (3941316, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (3978114, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (3941316, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (4541652, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (3941316, 2)
    and df2:n_pois_per_grid Shape: (3941316, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (3941316, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (3941316, 4)
    and df2:populationsGrids Shape: (3941316, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (3941316, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (3941316, 5)
    and df2:populationsGrids Shape: (3941316, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (3941316, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1389, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1387936, 11)
    		and df2:licensesKeysDf Shape: (3800, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1387936, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (921697, 17) 
        and df2:licensesDf Shape: (921697, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (604678, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (2076115, 30)
    	and df2:licensesDf Shape: (921697, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1372939, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (382433, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (382433, 25)
    	and df2:xgb_predict_df Shape: (382433, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (382433, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (382433, 28)
    	and df2:licenses_df Shape: (921697, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (382433, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (9741, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (9741, 2)
    	and df2:amanaPopulationOverlay Shape: (3941316, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (3941316, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (3941316, 7)
    	and df2:amanaPopulationOverlay Shape: (3941316, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (3941316, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (3941316, 14)
    	and predictions_df Shape: (382433, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (4306371, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (3941316, 8)
    	and df2:grid_level_new_businesses Shape: (3941316, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (3941316, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (3941316, 2)
    	and df2:poiData Shape: (3941316, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (3941316, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (3941316, 5)
    	and df2:population_per_grid Shape: (3941316, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (3941316, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (3941316, 2)
    	and df2:licenses_per_grid Shape: (3941316, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (3941316, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (3941316, 2)
    	and df2:licenses_per_grid Shape: (3941316, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (3941316, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (3941316, 9)
    	and df2:n_priority_areas_per_grid Shape: (3941316, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (3941316, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (4306371, 53)
    	and df2:points_for_qgis Shape: (382433, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (392413, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (392413, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (382433, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (382433, 43)
    	and df2:data.amanaPopulationOverlay Shape: (3941316, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (381755, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (21848, 17)
    	and df2:n_licenses_per_facility Shape: (21869, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (21848, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (3941316, 20)
    	and df2:grid_level_license_risks Shape: (3941316, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (3941316, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (3941316, 30)
    	and df2:licenses_per_facility Shape: (21848, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (3941316, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (3941316, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (381755, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (381755, 46)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2011530, 22)

INFO:root:Fetched Inspections_df shape: (3363675, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3363675, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3442392, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2135808, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2135808, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2135792, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2011530, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2135794, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2011530, 22)

INFO:root:Fetched Inspections_df shape: (3363675, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3363675, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3442392, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2135808, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2135808, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2135792, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2011530, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2135794, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2011530, 22)

INFO:root:Fetched Inspections_df shape: (3363675, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3363675, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3442392, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2135808, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2135808, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2135792, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2011530, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2135794, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2011530, 22)

INFO:root:Fetched Inspections_df shape: (3363675, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3363675, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3442392, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2135808, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2135808, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2135792, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2011530, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2135794, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (3941316, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (3978114, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (3941316, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (3941316, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (3941316, 2)
    and df2:n_pois_per_grid Shape: (3941316, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (3941316, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (3941316, 4)
    and df2:populationsGrids Shape: (3941316, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (3941316, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (3941316, 5)
    and df2:populationsGrids Shape: (3941316, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (3941316, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1389, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1389562, 11)
    		and df2:licensesKeysDf Shape: (3800, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1389562, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (922630, 17) 
        and df2:licensesDf Shape: (922630, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (607589, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (2083220, 30)
    	and df2:licensesDf Shape: (922630, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1376381, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (383808, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (383808, 25)
    	and df2:xgb_predict_df Shape: (383808, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (383808, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (383808, 28)
    	and df2:licenses_df Shape: (922630, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (383808, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (9741, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (9741, 2)
    	and df2:amanaPopulationOverlay Shape: (3941316, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (3941316, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (3941316, 7)
    	and df2:amanaPopulationOverlay Shape: (3941316, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (3941316, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (3941316, 14)
    	and predictions_df Shape: (383808, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (4307707, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (3941316, 8)
    	and df2:grid_level_new_businesses Shape: (3941316, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (3941316, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (3941316, 2)
    	and df2:poiData Shape: (3941316, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (3941316, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (3941316, 5)
    	and df2:population_per_grid Shape: (3941316, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (3941316, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (3941316, 2)
    	and df2:licenses_per_grid Shape: (3941316, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (3941316, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (3941316, 2)
    	and df2:licenses_per_grid Shape: (3941316, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (3941316, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (3941316, 9)
    	and df2:n_priority_areas_per_grid Shape: (3941316, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (3941316, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (4307707, 53)
    	and df2:points_for_qgis Shape: (383808, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (393799, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (393799, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (383808, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (383808, 43)
    	and df2:data.amanaPopulationOverlay Shape: (3941316, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (383124, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (21881, 17)
    	and df2:n_licenses_per_facility Shape: (21902, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (21881, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (3941316, 20)
    	and df2:grid_level_license_risks Shape: (3941316, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (3941316, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (3941316, 30)
    	and df2:licenses_per_facility Shape: (21881, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (3941316, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (3941316, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (383124, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (383124, 46)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2012225, 22)

INFO:root:Fetched Inspections_df shape: (3372720, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3372720, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3451784, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2143501, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2143501, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2143485, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2012225, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2143487, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2012225, 22)

INFO:root:Fetched Inspections_df shape: (3372720, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3372720, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3451784, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2143501, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2143501, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2143485, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2012225, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2143487, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2012225, 22)

INFO:root:Fetched Inspections_df shape: (3372720, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3372720, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3451784, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2143501, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2143501, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2143485, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2012225, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2143487, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2012225, 22)

INFO:root:Fetched Inspections_df shape: (3372720, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3372720, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3451784, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2143501, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2143501, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2143485, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2012225, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2143487, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (3941316, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (3978114, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (3941316, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (4544238, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (3941316, 2)
    and df2:n_pois_per_grid Shape: (3941316, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (3941316, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (3941316, 4)
    and df2:populationsGrids Shape: (3941316, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (3941316, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (3941316, 5)
    and df2:populationsGrids Shape: (3941316, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (3941316, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1389, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1390182, 11)
    		and df2:licensesKeysDf Shape: (3800, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1390182, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (923031, 17) 
        and df2:licensesDf Shape: (923031, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (610338, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (2090581, 30)
    	and df2:licensesDf Shape: (923031, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1379206, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (384023, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (384023, 25)
    	and df2:xgb_predict_df Shape: (384023, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (384023, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (384023, 28)
    	and df2:licenses_df Shape: (923031, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (384023, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (9741, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (9741, 2)
    	and df2:amanaPopulationOverlay Shape: (3941316, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (3941316, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (3941316, 7)
    	and df2:amanaPopulationOverlay Shape: (3941316, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (3941316, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (3941316, 14)
    	and predictions_df Shape: (384023, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (4307911, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (3941316, 8)
    	and df2:grid_level_new_businesses Shape: (3941316, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (3941316, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (3941316, 2)
    	and df2:poiData Shape: (3941316, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (3941316, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (3941316, 5)
    	and df2:population_per_grid Shape: (3941316, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (3941316, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (3941316, 2)
    	and df2:licenses_per_grid Shape: (3941316, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (3941316, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (3941316, 2)
    	and df2:licenses_per_grid Shape: (3941316, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (3941316, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (3941316, 9)
    	and df2:n_priority_areas_per_grid Shape: (3941316, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (3941316, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (4307911, 53)
    	and df2:points_for_qgis Shape: (384023, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (394016, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (394016, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (384023, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (384023, 43)
    	and df2:data.amanaPopulationOverlay Shape: (3941316, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (383340, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (21893, 17)
    	and df2:n_licenses_per_facility Shape: (21914, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (21893, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (3941316, 20)
    	and df2:grid_level_license_risks Shape: (3941316, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (3941316, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (3941316, 30)
    	and df2:licenses_per_facility Shape: (21893, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (3941316, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (3941316, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (383340, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (383340, 46)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2012849, 22)

INFO:root:Fetched Inspections_df shape: (3378920, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3378920, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3458288, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2149762, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2149762, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2149746, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2012849, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2149748, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2012849, 22)

INFO:root:Fetched Inspections_df shape: (3378920, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3378920, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3458288, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2149762, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2149762, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2149746, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2012849, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2149748, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2012849, 22)

INFO:root:Fetched Inspections_df shape: (3378920, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3378920, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3458288, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2149762, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2149762, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2149746, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2012849, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2149748, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2012849, 22)

INFO:root:Fetched Inspections_df shape: (3378920, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3378920, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3458288, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2149762, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2149762, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2149746, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2012849, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2149748, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2012959, 22)

INFO:root:Fetched Inspections_df shape: (3380111, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3380111, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3459516, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2150999, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2150999, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2150983, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2012959, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2150985, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2012959, 22)

INFO:root:Fetched Inspections_df shape: (3380111, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3380111, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3459516, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2150999, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2150999, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2150983, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2012959, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2150985, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2012959, 22)

INFO:root:Fetched Inspections_df shape: (3380111, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3380111, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3459516, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2150999, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2150999, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2150983, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2012959, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2150985, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2012959, 22)

INFO:root:Fetched Inspections_df shape: (3380111, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3380111, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3459516, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2150999, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2150999, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2150983, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2012959, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2150985, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2013236, 22)

INFO:root:Fetched Inspections_df shape: (3382968, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3382968, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3462498, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2153726, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2153726, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2153710, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2013236, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2153712, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2013725, 22)

INFO:root:Fetched Inspections_df shape: (3391462, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3391462, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3471370, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2161068, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2161068, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2161052, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2013725, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2161054, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (3941316, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (3978114, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (3941316, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (4544255, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (3941316, 2)
    and df2:n_pois_per_grid Shape: (3941316, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (3941316, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (3941316, 4)
    and df2:populationsGrids Shape: (3941316, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (3941316, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (3941316, 5)
    and df2:populationsGrids Shape: (3941316, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (3941316, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1389, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1391065, 11)
    		and df2:licensesKeysDf Shape: (3800, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1391065, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (923532, 17) 
        and df2:licensesDf Shape: (923532, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (616486, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (2107363, 30)
    	and df2:licensesDf Shape: (923532, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1385185, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (383973, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (383973, 25)
    	and df2:xgb_predict_df Shape: (383973, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (383973, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (383973, 28)
    	and df2:licenses_df Shape: (923532, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (383973, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (9741, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (9741, 2)
    	and df2:amanaPopulationOverlay Shape: (3941316, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (3941316, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (3941316, 7)
    	and df2:amanaPopulationOverlay Shape: (3941316, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (3941316, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (3941316, 14)
    	and predictions_df Shape: (383973, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (4307871, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (3941316, 8)
    	and df2:grid_level_new_businesses Shape: (3941316, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (3941316, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (3941316, 2)
    	and df2:poiData Shape: (3941316, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (3941316, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (3941316, 5)
    	and df2:population_per_grid Shape: (3941316, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (3941316, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (3941316, 2)
    	and df2:licenses_per_grid Shape: (3941316, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (3941316, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (3941316, 2)
    	and df2:licenses_per_grid Shape: (3941316, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (3941316, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (3941316, 9)
    	and df2:n_priority_areas_per_grid Shape: (3941316, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (3941316, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (4307871, 53)
    	and df2:points_for_qgis Shape: (383973, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (393971, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (393971, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (383973, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (383973, 43)
    	and df2:data.amanaPopulationOverlay Shape: (3941316, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (383289, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (21886, 17)
    	and df2:n_licenses_per_facility Shape: (21907, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (21886, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (3941316, 20)
    	and df2:grid_level_license_risks Shape: (3941316, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (3941316, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (3941316, 30)
    	and df2:licenses_per_facility Shape: (21886, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (3941316, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (3941316, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (383289, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (383289, 46)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2013725, 22)

INFO:root:Fetched Inspections_df shape: (3391462, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3391462, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3471370, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2161068, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2161068, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2161052, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2013725, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2161054, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2013725, 22)

INFO:root:Fetched Inspections_df shape: (3391462, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3391462, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3471370, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2161068, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2161068, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2161052, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2013725, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2161054, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2013725, 22)

INFO:root:Fetched Inspections_df shape: (3391462, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3391462, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3471370, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2161068, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2161068, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2161052, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2013725, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2161054, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2013725, 22)

INFO:root:Fetched Inspections_df shape: (3391462, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3391462, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3471370, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2161068, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2161068, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2161052, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2013725, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2161054, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2014344, 22)

INFO:root:Fetched Inspections_df shape: (3400397, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3400397, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3480656, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2168931, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2168931, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2168915, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2014344, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2168917, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2014344, 22)

INFO:root:Fetched Inspections_df shape: (3400397, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3400397, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3480656, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2168931, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2168931, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2168915, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2014344, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2168917, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2014344, 22)

INFO:root:Fetched Inspections_df shape: (3400397, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3400397, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3480656, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2168931, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2168931, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2168915, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2014344, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2168917, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (3941316, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (3978114, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (3941316, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (4545219, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (3941316, 2)
    and df2:n_pois_per_grid Shape: (3941316, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (3941316, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (3941316, 4)
    and df2:populationsGrids Shape: (3941316, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (3941316, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (3941316, 5)
    and df2:populationsGrids Shape: (3941316, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (3941316, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1389, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1392345, 11)
    		and df2:licensesKeysDf Shape: (3800, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1392345, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (924289, 17) 
        and df2:licensesDf Shape: (924289, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (621792, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (2122157, 30)
    	and df2:licensesDf Shape: (924289, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1390696, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (384584, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (384584, 25)
    	and df2:xgb_predict_df Shape: (384584, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (384584, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (384584, 28)
    	and df2:licenses_df Shape: (924289, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (384584, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (9741, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (9741, 2)
    	and df2:amanaPopulationOverlay Shape: (3941316, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (3941316, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (3941316, 7)
    	and df2:amanaPopulationOverlay Shape: (3941316, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (3941316, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (3941316, 14)
    	and predictions_df Shape: (384584, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (4308478, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (3941316, 8)
    	and df2:grid_level_new_businesses Shape: (3941316, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (3941316, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (3941316, 2)
    	and df2:poiData Shape: (3941316, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (3941316, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (3941316, 5)
    	and df2:population_per_grid Shape: (3941316, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (3941316, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (3941316, 2)
    	and df2:licenses_per_grid Shape: (3941316, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (3941316, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (3941316, 2)
    	and df2:licenses_per_grid Shape: (3941316, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (3941316, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (3941316, 9)
    	and df2:n_priority_areas_per_grid Shape: (3941316, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (3941316, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (4308478, 53)
    	and df2:points_for_qgis Shape: (384584, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (394593, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (394593, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (384584, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (384584, 43)
    	and df2:data.amanaPopulationOverlay Shape: (3941316, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (383900, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (21902, 17)
    	and df2:n_licenses_per_facility Shape: (21923, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (21902, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (3941316, 20)
    	and df2:grid_level_license_risks Shape: (3941316, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (3941316, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (3941316, 30)
    	and df2:licenses_per_facility Shape: (21902, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (3941316, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (3941316, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (383900, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (383900, 46)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2015011, 22)

INFO:root:Fetched Inspections_df shape: (3408667, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3408667, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3489280, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2176482, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2176482, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2176466, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2015011, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2176468, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2015011, 22)

INFO:root:Fetched Inspections_df shape: (3408667, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3408667, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3489280, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2176482, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2176482, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2176466, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2015011, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2176468, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2015011, 22)

INFO:root:Fetched Inspections_df shape: (3408667, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3408667, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3489280, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2176482, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2176482, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2176466, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2015011, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2176468, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2015011, 22)

INFO:root:Fetched Inspections_df shape: (3408667, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3408667, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3489280, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2176482, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2176482, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2176466, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2015011, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2176468, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2015667, 22)

INFO:root:Fetched Inspections_df shape: (3415936, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3415936, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3496869, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2183168, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2183168, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2183152, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2015667, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2183154, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2015667, 22)

INFO:root:Fetched Inspections_df shape: (3415936, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3415936, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3496869, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2183168, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2183168, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2183152, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2015667, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2183154, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2015667, 22)

INFO:root:Fetched Inspections_df shape: (3415936, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3415936, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3496869, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2183168, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2183168, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2183152, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2015667, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2183154, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2015667, 22)

INFO:root:Fetched Inspections_df shape: (3415936, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3415936, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3496869, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2183168, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2183168, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2183152, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2015667, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2183154, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2016295, 22)

INFO:root:Fetched Inspections_df shape: (3424757, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3424757, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3505970, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2188942, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2188942, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2188926, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2016295, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2188928, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2016295, 22)

INFO:root:Fetched Inspections_df shape: (3424757, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3424757, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3505970, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2188942, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2188942, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2188926, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2016295, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2188928, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2016295, 22)

INFO:root:Fetched Inspections_df shape: (3424757, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3424757, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3505970, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2188942, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2188942, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2188926, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2016295, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2188928, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2016413, 22)

INFO:root:Fetched Inspections_df shape: (3427610, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3427610, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3508869, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2190202, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2190202, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2190186, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2016413, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2190188, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2016413, 22)

INFO:root:Fetched Inspections_df shape: (3427610, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3427610, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3508869, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2190202, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2190202, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2190186, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2016413, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2190188, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2016413, 22)

INFO:root:Fetched Inspections_df shape: (3427610, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3427610, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3508869, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2190202, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2190202, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2190186, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2016413, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2190188, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2016413, 22)

INFO:root:Fetched Inspections_df shape: (3427610, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3427610, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3508869, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2190202, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2190202, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2190186, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2016413, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2190188, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2016413, 22)

INFO:root:Fetched Inspections_df shape: (3427610, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3427610, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3508869, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2190202, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2190202, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2190186, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2016413, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2190188, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2016413, 22)

INFO:root:Fetched Inspections_df shape: (3427610, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3427610, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3508869, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2190202, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2190202, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2190186, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2016413, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2190188, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2016413, 22)

INFO:root:Fetched Inspections_df shape: (3427610, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3427610, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3508869, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2190202, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2190202, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2190186, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2016413, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2190188, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2016413, 22)

INFO:root:Fetched Inspections_df shape: (3427610, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3427610, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3508869, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2190202, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2190202, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2190186, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2016413, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2190188, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2016413, 22)

INFO:root:Fetched Inspections_df shape: (3427610, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3427610, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3508869, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2190202, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2190202, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2190186, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2016413, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2190188, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (3941316, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (3978114, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (3941316, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (4544869, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (3941316, 2)
    and df2:n_pois_per_grid Shape: (3941316, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (3941316, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (3941316, 4)
    and df2:populationsGrids Shape: (3941316, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (3941316, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (3941316, 5)
    and df2:populationsGrids Shape: (3941316, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (3941316, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1389, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1393758, 11)
    		and df2:licensesKeysDf Shape: (3800, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1393758, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (925123, 17) 
        and df2:licensesDf Shape: (925123, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (626176, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (2135292, 30)
    	and df2:licensesDf Shape: (925123, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1395429, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (384343, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (384343, 25)
    	and df2:xgb_predict_df Shape: (384343, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (384343, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (384343, 28)
    	and df2:licenses_df Shape: (925123, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (384343, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (9741, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (9741, 2)
    	and df2:amanaPopulationOverlay Shape: (3941316, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (3941316, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (3941316, 7)
    	and df2:amanaPopulationOverlay Shape: (3941316, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (3941316, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (3941316, 14)
    	and predictions_df Shape: (384343, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (4308263, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (3941316, 8)
    	and df2:grid_level_new_businesses Shape: (3941316, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (3941316, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (3941316, 2)
    	and df2:poiData Shape: (3941316, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (3941316, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (3941316, 5)
    	and df2:population_per_grid Shape: (3941316, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (3941316, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (3941316, 2)
    	and df2:licenses_per_grid Shape: (3941316, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (3941316, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (3941316, 2)
    	and df2:licenses_per_grid Shape: (3941316, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (3941316, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (3941316, 9)
    	and df2:n_priority_areas_per_grid Shape: (3941316, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (3941316, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (4308263, 53)
    	and df2:points_for_qgis Shape: (384343, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (394379, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (394379, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (384343, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (384343, 43)
    	and df2:data.amanaPopulationOverlay Shape: (3941316, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (383655, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (21895, 17)
    	and df2:n_licenses_per_facility Shape: (21915, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (21895, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (3941316, 20)
    	and df2:grid_level_license_risks Shape: (3941316, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (3941316, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (3941316, 30)
    	and df2:licenses_per_facility Shape: (21895, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (3941316, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (3941316, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (383655, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (383655, 46)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2016716, 22)

INFO:root:Fetched Inspections_df shape: (3430789, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3430789, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3512191, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2192942, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2192942, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2192926, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2016716, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2192928, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2016716, 22)

INFO:root:Fetched Inspections_df shape: (3430789, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3430789, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3512191, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2192942, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2192942, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2192926, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2016716, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2192928, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2016716, 22)

INFO:root:Fetched Inspections_df shape: (3430789, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3430789, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3512191, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2192942, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2192942, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2192926, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2016716, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2192928, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2016716, 22)

INFO:root:Fetched Inspections_df shape: (3430789, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3430789, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3512191, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2192942, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2192942, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2192926, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2016716, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2192928, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2016716, 22)

INFO:root:Fetched Inspections_df shape: (3430789, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3430789, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3512191, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2192942, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2192942, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2192926, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2016716, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2192928, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2016716, 22)

INFO:root:Fetched Inspections_df shape: (3430789, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3430789, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3512191, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2192942, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2192942, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2192926, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2016716, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2192928, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2017301, 22)

INFO:root:Fetched Inspections_df shape: (3437482, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3437482, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3519237, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2198972, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2198972, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2198956, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2017301, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2198958, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2017301, 22)

INFO:root:Fetched Inspections_df shape: (3437482, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3437482, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3519237, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2198972, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2198972, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2198956, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2017301, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2198958, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2017301, 22)

INFO:root:Fetched Inspections_df shape: (3437482, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3437482, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3519237, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2198972, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2198972, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2198956, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2017301, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2198958, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2017301, 22)

INFO:root:Fetched Inspections_df shape: (3437482, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3437482, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3519237, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2198972, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2198972, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2198956, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2017301, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2198958, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2017301, 22)

INFO:root:Fetched Inspections_df shape: (3437482, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3437482, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3519237, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2198972, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2198972, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2198956, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2017301, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2198958, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2017301, 22)

INFO:root:Fetched Inspections_df shape: (3437482, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3437482, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3519237, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2198972, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2198972, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2198956, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2017301, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2198958, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (3941316, 13)
INFO:root:Fetched population_grids shape: (3941316, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2018635, 22)

INFO:root:Fetched Inspections_df shape: (3452476, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3452476, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3534906, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2211442, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2211442, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2211426, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2018635, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2211428, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (794434, 13)
INFO:root:Fetched population_grids shape: (794434, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (838906, 3)
INFO:root:Read pois_licenses_comparison shape: (838906, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3452476, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3534906, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2211442, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2018635, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3361402, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3361402, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3473412, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (959639, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (794434, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (58, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (794434, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (82, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (132895, 73)
    	and df2:predictions_df Shape: (132895, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (132895, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (794434, 14)
    	and df2:priority_areas Shape: (1384, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (4778, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (4778, 2)
    	and df2:population_grids Shape: (794434, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (794434, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (794434, 7)
    	and df2:population_grids Shape: (794434, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (838906, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (748615, 32)
    	and df2:geometry_per_grid Shape: (794434, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (372970, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (838906, 7)
    	and df2:population_grids Shape: (772198, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (838906, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (132390, 78)
    	and df2:population_grids Shape: (794434, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (50524, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (5106, 2)
    	and df2:pois_data Shape: (838906, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (5118, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (5118, 5)
    	and df2:population_per_grid Shape: (794434, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (5134, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (5106, 3)
    	and df2:licenses_per_grid Shape: (5134, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (5134, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (5134, 9)
    	and df2:geometry_per_grid Shape: (772198, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (5134, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (5134, 23)
    	and df2:n_priority_areas_per_grid Shape: (838906, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (5230, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (5106, 3)
    	and df2:licenses_per_grid Shape: (5134, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (5134, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (50524, 94)
    	and df2:points_for_qgis Shape: (132390, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (132390, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (132390, 24)
    	and df2:population_grids Shape: (794434, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (50529, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (5106, 12)
    	and df2:n_licenses_per_facility Shape: (5106, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (5106, 13)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (5230, 52)
    	and df2:grid_level_license_risks Shape: (5106, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (5230, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (5230, 59)
    	and df2:licenses_per_facility Shape: (5106, 14)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (5230, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1384, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (794434, 15)
    	and df2:population_grids Shape: (794434, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (794682, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (50524, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (50524, 28)
    
INFO:root:OUTPUT tooltip_df shape: (794682, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (5358, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (5358, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2019387, 22)

INFO:root:Fetched Inspections_df shape: (3461281, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3461281, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3544031, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2217877, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2217877, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2217861, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2019387, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2217863, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2005407, 13)
INFO:root:Fetched population_grids shape: (2005407, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2005407, 3)
INFO:root:Read pois_licenses_comparison shape: (2005407, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3461281, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3544031, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2217877, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2019387, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3367288, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3367288, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3479796, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (962806, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2005407, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5484, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2005407, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (12291, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (133040, 73)
    	and df2:predictions_df Shape: (133040, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (133040, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2005407, 14)
    	and df2:priority_areas Shape: (1384, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9451, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9451, 2)
    	and df2:population_grids Shape: (2005407, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2005407, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2005407, 7)
    	and df2:population_grids Shape: (2005407, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2005407, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (750208, 32)
    	and df2:geometry_per_grid Shape: (2005407, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (748756, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2005407, 7)
    	and df2:population_grids Shape: (2005407, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2005407, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (132536, 78)
    	and df2:population_grids Shape: (2005407, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (132191, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13533, 2)
    	and df2:pois_data Shape: (2005407, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13533, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13533, 5)
    	and df2:population_per_grid Shape: (2005407, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13533, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13533, 3)
    	and df2:licenses_per_grid Shape: (13533, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13533, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13533, 9)
    	and df2:geometry_per_grid Shape: (2005407, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (13533, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13533, 23)
    	and df2:n_priority_areas_per_grid Shape: (2005407, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (13533, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13533, 3)
    	and df2:licenses_per_grid Shape: (13533, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (13533, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (132191, 94)
    	and df2:points_for_qgis Shape: (132536, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (132536, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (132536, 24)
    	and df2:population_grids Shape: (2005407, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (132191, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (13533, 12)
    	and df2:n_licenses_per_facility Shape: (13533, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13533, 13)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (13533, 52)
    	and df2:grid_level_license_risks Shape: (13533, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13533, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (13533, 59)
    	and df2:licenses_per_facility Shape: (13533, 14)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13533, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1384, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2005407, 15)
    	and df2:population_grids Shape: (2005407, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2005407, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (132191, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (132191, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2005407, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (13533, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (13533, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2020094, 22)

INFO:root:Fetched Inspections_df shape: (3468226, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3468226, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3551413, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2224569, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2224569, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2224553, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2020094, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2224555, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015395, 13)
INFO:root:Fetched population_grids shape: (2015395, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2015395, 3)
INFO:root:Read pois_licenses_comparison shape: (2015395, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3468226, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3551413, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2224569, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2020094, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3373057, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3373057, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3486231, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (965727, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2015395, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5484, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2015395, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (12291, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (133137, 73)
    	and df2:predictions_df Shape: (133137, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (133137, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015395, 14)
    	and df2:priority_areas Shape: (1384, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9492, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9492, 2)
    	and df2:population_grids Shape: (2015395, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015395, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015395, 7)
    	and df2:population_grids Shape: (2015395, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015395, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (752553, 32)
    	and df2:geometry_per_grid Shape: (2015395, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (752487, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015395, 7)
    	and df2:population_grids Shape: (2015395, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015395, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (132636, 78)
    	and df2:population_grids Shape: (2015395, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (132629, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13639, 2)
    	and df2:pois_data Shape: (2015395, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13639, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13639, 5)
    	and df2:population_per_grid Shape: (2015395, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13639, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13639, 3)
    	and df2:licenses_per_grid Shape: (13639, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13639, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13639, 9)
    	and df2:geometry_per_grid Shape: (2015395, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (13639, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13639, 23)
    	and df2:n_priority_areas_per_grid Shape: (2015395, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (13639, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13639, 3)
    	and df2:licenses_per_grid Shape: (13639, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (13639, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (132629, 94)
    	and df2:points_for_qgis Shape: (132636, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (132636, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (132636, 24)
    	and df2:population_grids Shape: (2015395, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (132629, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (13639, 12)
    	and df2:n_licenses_per_facility Shape: (13639, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13639, 13)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (13639, 52)
    	and df2:grid_level_license_risks Shape: (13639, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13639, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (13639, 59)
    	and df2:licenses_per_facility Shape: (13639, 14)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13639, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1384, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015395, 15)
    	and df2:population_grids Shape: (2015395, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015395, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (132629, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (132629, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2015395, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (13639, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (13639, 18)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015395, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015395, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (2052163, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015395, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2612288, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (2015395, 2)
    and df2:n_pois_per_grid Shape: (2015395, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015395, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015395, 4)
    and df2:populationsGrids Shape: (2015395, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015395, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015395, 5)
    and df2:populationsGrids Shape: (2015395, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015395, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1384, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1397801, 11)
    		and df2:licensesKeysDf Shape: (3800, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1397801, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (927484, 17) 
        and df2:licensesDf Shape: (927484, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (638185, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (2170546, 30)
    	and df2:licensesDf Shape: (927484, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1408392, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (385734, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (385734, 25)
    	and df2:xgb_predict_df Shape: (385734, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (385734, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (385734, 28)
    	and df2:licenses_df Shape: (927484, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (385734, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (9492, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (9492, 2)
    	and df2:amanaPopulationOverlay Shape: (2015395, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015395, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (2015395, 7)
    	and df2:amanaPopulationOverlay Shape: (2015395, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015395, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (2015395, 14)
    	and predictions_df Shape: (385734, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (2379103, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (2015395, 8)
    	and df2:grid_level_new_businesses Shape: (2015395, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015395, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015395, 2)
    	and df2:poiData Shape: (2015395, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015395, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015395, 5)
    	and df2:population_per_grid Shape: (2015395, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015395, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015395, 2)
    	and df2:licenses_per_grid Shape: (2015395, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015395, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015395, 2)
    	and df2:licenses_per_grid Shape: (2015395, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015395, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2015395, 9)
    	and df2:n_priority_areas_per_grid Shape: (2015395, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (2015395, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2379103, 53)
    	and df2:points_for_qgis Shape: (385734, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (385739, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (385739, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (385734, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (385734, 43)
    	and df2:data.amanaPopulationOverlay Shape: (2015395, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (385713, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (21988, 17)
    	and df2:n_licenses_per_facility Shape: (22008, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (21988, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (2015395, 20)
    	and df2:grid_level_license_risks Shape: (2015395, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015395, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (2015395, 30)
    	and df2:licenses_per_facility Shape: (21988, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015395, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (2015395, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (385713, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (385713, 46)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2020414, 22)

INFO:root:Fetched Inspections_df shape: (3471228, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3471228, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3554571, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2227045, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2227045, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2227029, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2020414, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2227031, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015395, 13)
INFO:root:Fetched population_grids shape: (2015395, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2015395, 3)
INFO:root:Read pois_licenses_comparison shape: (2015395, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3471228, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3554571, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2227045, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2020414, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3375350, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3375350, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3488788, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (966959, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2015395, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5484, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2015395, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (12291, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (133157, 73)
    	and df2:predictions_df Shape: (133157, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (133157, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015395, 14)
    	and df2:priority_areas Shape: (1384, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9492, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9492, 2)
    	and df2:population_grids Shape: (2015395, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015395, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015395, 7)
    	and df2:population_grids Shape: (2015395, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015395, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (753573, 32)
    	and df2:geometry_per_grid Shape: (2015395, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (753507, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015395, 7)
    	and df2:population_grids Shape: (2015395, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015395, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (132656, 78)
    	and df2:population_grids Shape: (2015395, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (132649, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13637, 2)
    	and df2:pois_data Shape: (2015395, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13637, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13637, 5)
    	and df2:population_per_grid Shape: (2015395, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13637, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13637, 3)
    	and df2:licenses_per_grid Shape: (13637, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13637, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13637, 9)
    	and df2:geometry_per_grid Shape: (2015395, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (13637, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13637, 23)
    	and df2:n_priority_areas_per_grid Shape: (2015395, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (13637, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13637, 3)
    	and df2:licenses_per_grid Shape: (13637, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (13637, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (132649, 94)
    	and df2:points_for_qgis Shape: (132656, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (132656, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (132656, 24)
    	and df2:population_grids Shape: (2015395, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (132649, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (13637, 12)
    	and df2:n_licenses_per_facility Shape: (13637, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13637, 13)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (13637, 52)
    	and df2:grid_level_license_risks Shape: (13637, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13637, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (13637, 59)
    	and df2:licenses_per_facility Shape: (13637, 14)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13637, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1384, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015395, 15)
    	and df2:population_grids Shape: (2015395, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015395, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (132649, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (132649, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2015395, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (13637, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (13637, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2021030, 22)

INFO:root:Fetched Inspections_df shape: (3478415, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3478415, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3562144, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2234130, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2234130, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2234114, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2021030, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2234116, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015395, 13)
INFO:root:Fetched population_grids shape: (2015395, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2015395, 3)
INFO:root:Read pois_licenses_comparison shape: (2015395, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3478415, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3562144, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2234130, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2021030, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3381427, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3381427, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3495557, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (970139, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2015395, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5484, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2015395, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (12291, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (133341, 73)
    	and df2:predictions_df Shape: (133341, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (133341, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015395, 14)
    	and df2:priority_areas Shape: (1384, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9492, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9492, 2)
    	and df2:population_grids Shape: (2015395, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015395, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015395, 7)
    	and df2:population_grids Shape: (2015395, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015395, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (754790, 32)
    	and df2:geometry_per_grid Shape: (2015395, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (754724, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015395, 7)
    	and df2:population_grids Shape: (2015395, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015395, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (132841, 78)
    	and df2:population_grids Shape: (2015395, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (132834, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13646, 2)
    	and df2:pois_data Shape: (2015395, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13646, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13646, 5)
    	and df2:population_per_grid Shape: (2015395, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13646, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13646, 3)
    	and df2:licenses_per_grid Shape: (13646, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13646, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13646, 9)
    	and df2:geometry_per_grid Shape: (2015395, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (13646, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13646, 23)
    	and df2:n_priority_areas_per_grid Shape: (2015395, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (13646, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13646, 3)
    	and df2:licenses_per_grid Shape: (13646, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (13646, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (132834, 94)
    	and df2:points_for_qgis Shape: (132841, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (132841, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (132841, 24)
    	and df2:population_grids Shape: (2015395, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (132834, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (13646, 12)
    	and df2:n_licenses_per_facility Shape: (13646, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13646, 13)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (13646, 52)
    	and df2:grid_level_license_risks Shape: (13646, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13646, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (13646, 59)
    	and df2:licenses_per_facility Shape: (13646, 14)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13646, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1384, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015395, 15)
    	and df2:population_grids Shape: (2015395, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015395, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (132834, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (132834, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2015395, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (13646, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (13646, 18)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015395, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015395, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (2052163, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015395, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2612757, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (2015395, 2)
    and df2:n_pois_per_grid Shape: (2015395, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015395, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015395, 4)
    and df2:populationsGrids Shape: (2015395, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015395, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015395, 5)
    and df2:populationsGrids Shape: (2015395, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015395, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1384, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1398418, 11)
    		and df2:licensesKeysDf Shape: (3800, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1398418, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (927834, 17) 
        and df2:licensesDf Shape: (927834, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (640612, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (2177286, 30)
    	and df2:licensesDf Shape: (927834, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1410868, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (386010, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (386010, 25)
    	and df2:xgb_predict_df Shape: (386010, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (386010, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (386010, 28)
    	and df2:licenses_df Shape: (927834, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (386010, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (9492, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (9492, 2)
    	and df2:amanaPopulationOverlay Shape: (2015395, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015395, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (2015395, 7)
    	and df2:amanaPopulationOverlay Shape: (2015395, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015395, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (2015395, 14)
    	and predictions_df Shape: (386010, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (2379376, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (2015395, 8)
    	and df2:grid_level_new_businesses Shape: (2015395, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015395, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015395, 2)
    	and df2:poiData Shape: (2015395, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015395, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015395, 5)
    	and df2:population_per_grid Shape: (2015395, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015395, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015395, 2)
    	and df2:licenses_per_grid Shape: (2015395, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015395, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015395, 2)
    	and df2:licenses_per_grid Shape: (2015395, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015395, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2015395, 9)
    	and df2:n_priority_areas_per_grid Shape: (2015395, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (2015395, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2379376, 53)
    	and df2:points_for_qgis Shape: (386010, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (386015, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (386015, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (386010, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (386010, 43)
    	and df2:data.amanaPopulationOverlay Shape: (2015395, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (385990, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (21992, 17)
    	and df2:n_licenses_per_facility Shape: (22012, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (21992, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (2015395, 20)
    	and df2:grid_level_license_risks Shape: (2015395, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015395, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (2015395, 30)
    	and df2:licenses_per_facility Shape: (21992, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015395, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (2015395, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (385990, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (385990, 46)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2021688, 22)

INFO:root:Fetched Inspections_df shape: (3486701, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3486701, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3570839, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2241213, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2241213, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2241197, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2021688, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2241199, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015395, 13)
INFO:root:Fetched population_grids shape: (2015395, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2015395, 3)
INFO:root:Read pois_licenses_comparison shape: (2015395, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3486701, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3570839, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2241213, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2021688, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3387606, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3387606, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3502442, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (973325, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2015395, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5484, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2015395, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (12291, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (133446, 73)
    	and df2:predictions_df Shape: (133446, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (133446, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015395, 14)
    	and df2:priority_areas Shape: (1384, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9492, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9492, 2)
    	and df2:population_grids Shape: (2015395, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015395, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015395, 7)
    	and df2:population_grids Shape: (2015395, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015395, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (755881, 32)
    	and df2:geometry_per_grid Shape: (2015395, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (755815, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015395, 7)
    	and df2:population_grids Shape: (2015395, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015395, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (132948, 78)
    	and df2:population_grids Shape: (2015395, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (132941, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13645, 2)
    	and df2:pois_data Shape: (2015395, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13645, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13645, 5)
    	and df2:population_per_grid Shape: (2015395, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13645, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13645, 3)
    	and df2:licenses_per_grid Shape: (13645, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13645, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13645, 9)
    	and df2:geometry_per_grid Shape: (2015395, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (13645, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13645, 23)
    	and df2:n_priority_areas_per_grid Shape: (2015395, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (13645, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13645, 3)
    	and df2:licenses_per_grid Shape: (13645, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (13645, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (132941, 94)
    	and df2:points_for_qgis Shape: (132948, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (132948, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (132948, 24)
    	and df2:population_grids Shape: (2015395, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (132941, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (13645, 12)
    	and df2:n_licenses_per_facility Shape: (13645, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13645, 13)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (13645, 52)
    	and df2:grid_level_license_risks Shape: (13645, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13645, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (13645, 59)
    	and df2:licenses_per_facility Shape: (13645, 14)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13645, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1384, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015395, 15)
    	and df2:population_grids Shape: (2015395, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015395, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (132941, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (132941, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2015395, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (13645, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (13645, 18)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015395, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015395, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (2052163, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015395, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2613779, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (2015395, 2)
    and df2:n_pois_per_grid Shape: (2015395, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015395, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015395, 4)
    and df2:populationsGrids Shape: (2015395, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015395, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015395, 5)
    and df2:populationsGrids Shape: (2015395, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015395, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1384, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1399766, 11)
    		and df2:licensesKeysDf Shape: (3800, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1399766, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (928654, 17) 
        and df2:licensesDf Shape: (928654, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (643044, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (2184016, 30)
    	and df2:licensesDf Shape: (928654, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1413873, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (386584, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (386584, 25)
    	and df2:xgb_predict_df Shape: (386584, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (386584, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (386584, 28)
    	and df2:licenses_df Shape: (928654, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (386584, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (9492, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (9492, 2)
    	and df2:amanaPopulationOverlay Shape: (2015395, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015395, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (2015395, 7)
    	and df2:amanaPopulationOverlay Shape: (2015395, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015395, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (2015395, 14)
    	and predictions_df Shape: (386584, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (2379961, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (2015395, 8)
    	and df2:grid_level_new_businesses Shape: (2015395, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015395, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015395, 2)
    	and df2:poiData Shape: (2015395, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015395, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015395, 5)
    	and df2:population_per_grid Shape: (2015395, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015395, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015395, 2)
    	and df2:licenses_per_grid Shape: (2015395, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015395, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015395, 2)
    	and df2:licenses_per_grid Shape: (2015395, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015395, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2015395, 9)
    	and df2:n_priority_areas_per_grid Shape: (2015395, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (2015395, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2379961, 53)
    	and df2:points_for_qgis Shape: (386584, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (386589, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (386589, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (386584, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (386584, 43)
    	and df2:data.amanaPopulationOverlay Shape: (2015395, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (386565, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (21984, 17)
    	and df2:n_licenses_per_facility Shape: (22004, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (21984, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (2015395, 20)
    	and df2:grid_level_license_risks Shape: (2015395, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015395, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (2015395, 30)
    	and df2:licenses_per_facility Shape: (21984, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015395, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (2015395, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (386565, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (386565, 46)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2023753, 22)

INFO:root:Fetched Inspections_df shape: (3508024, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3508024, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3593229, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2261074, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2261074, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2261058, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2023753, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2261060, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015395, 13)
INFO:root:Fetched population_grids shape: (2015395, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2015395, 3)
INFO:root:Read pois_licenses_comparison shape: (2015395, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3508024, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3593229, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2261074, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2023753, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3405372, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3405372, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3522114, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (982830, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2015395, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5484, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2015395, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (12291, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (133878, 73)
    	and df2:predictions_df Shape: (133878, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (133878, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015395, 14)
    	and df2:priority_areas Shape: (1384, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9492, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9492, 2)
    	and df2:population_grids Shape: (2015395, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015395, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015395, 7)
    	and df2:population_grids Shape: (2015395, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015395, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (758794, 32)
    	and df2:geometry_per_grid Shape: (2015395, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (758727, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015395, 7)
    	and df2:population_grids Shape: (2015395, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015395, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (133384, 78)
    	and df2:population_grids Shape: (2015395, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (133377, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13661, 2)
    	and df2:pois_data Shape: (2015395, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13661, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13661, 5)
    	and df2:population_per_grid Shape: (2015395, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13661, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13661, 3)
    	and df2:licenses_per_grid Shape: (13661, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13661, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13661, 9)
    	and df2:geometry_per_grid Shape: (2015395, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (13661, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13661, 23)
    	and df2:n_priority_areas_per_grid Shape: (2015395, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (13661, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13661, 3)
    	and df2:licenses_per_grid Shape: (13661, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (13661, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (133377, 94)
    	and df2:points_for_qgis Shape: (133384, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (133384, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (133384, 24)
    	and df2:population_grids Shape: (2015395, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (133377, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (13661, 12)
    	and df2:n_licenses_per_facility Shape: (13661, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13661, 13)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (13661, 52)
    	and df2:grid_level_license_risks Shape: (13661, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13661, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (13661, 59)
    	and df2:licenses_per_facility Shape: (13661, 14)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13661, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1384, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015395, 15)
    	and df2:population_grids Shape: (2015395, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015395, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (133377, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (133377, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2015395, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (13661, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (13661, 18)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015395, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015395, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (2052163, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015395, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2614806, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (2015395, 2)
    and df2:n_pois_per_grid Shape: (2015395, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015395, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015395, 4)
    and df2:populationsGrids Shape: (2015395, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015395, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015395, 5)
    and df2:populationsGrids Shape: (2015395, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015395, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1384, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1401142, 11)
    		and df2:licensesKeysDf Shape: (3800, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1401142, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (929458, 17) 
        and df2:licensesDf Shape: (929458, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (649586, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (2202925, 30)
    	and df2:licensesDf Shape: (929458, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1420454, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (387177, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (387177, 25)
    	and df2:xgb_predict_df Shape: (387177, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (387177, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (387177, 28)
    	and df2:licenses_df Shape: (929458, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (387177, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (9492, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (9492, 2)
    	and df2:amanaPopulationOverlay Shape: (2015395, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015395, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (2015395, 7)
    	and df2:amanaPopulationOverlay Shape: (2015395, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015395, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (2015395, 14)
    	and predictions_df Shape: (387177, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (2380545, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (2015395, 8)
    	and df2:grid_level_new_businesses Shape: (2015395, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015395, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015395, 2)
    	and df2:poiData Shape: (2015395, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015395, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015395, 5)
    	and df2:population_per_grid Shape: (2015395, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015395, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015395, 2)
    	and df2:licenses_per_grid Shape: (2015395, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015395, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015395, 2)
    	and df2:licenses_per_grid Shape: (2015395, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015395, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2015395, 9)
    	and df2:n_priority_areas_per_grid Shape: (2015395, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (2015395, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2380545, 53)
    	and df2:points_for_qgis Shape: (387177, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (387182, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (387182, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (387177, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (387177, 43)
    	and df2:data.amanaPopulationOverlay Shape: (2015395, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (387156, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (21990, 17)
    	and df2:n_licenses_per_facility Shape: (22010, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (21990, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (2015395, 20)
    	and df2:grid_level_license_risks Shape: (2015395, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015395, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (2015395, 30)
    	and df2:licenses_per_facility Shape: (21990, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015395, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (2015395, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (387156, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (387156, 46)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015395, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015395, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (2052163, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015395, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2614077, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (2015395, 2)
    and df2:n_pois_per_grid Shape: (2015395, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015395, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015395, 4)
    and df2:populationsGrids Shape: (2015395, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015395, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015395, 5)
    and df2:populationsGrids Shape: (2015395, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015395, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1384, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1401284, 11)
    		and df2:licensesKeysDf Shape: (3800, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1401284, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (929537, 17) 
        and df2:licensesDf Shape: (929537, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (649913, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (2204255, 30)
    	and df2:licensesDf Shape: (929537, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1420827, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (386718, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (386718, 25)
    	and df2:xgb_predict_df Shape: (386718, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (386718, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (386718, 28)
    	and df2:licenses_df Shape: (929537, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (386718, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (9492, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (9492, 2)
    	and df2:amanaPopulationOverlay Shape: (2015395, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015395, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (2015395, 7)
    	and df2:amanaPopulationOverlay Shape: (2015395, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015395, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (2015395, 14)
    	and predictions_df Shape: (386718, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (2380098, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (2015395, 8)
    	and df2:grid_level_new_businesses Shape: (2015395, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015395, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015395, 2)
    	and df2:poiData Shape: (2015395, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015395, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015395, 5)
    	and df2:population_per_grid Shape: (2015395, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015395, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015395, 2)
    	and df2:licenses_per_grid Shape: (2015395, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015395, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015395, 2)
    	and df2:licenses_per_grid Shape: (2015395, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015395, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2015395, 9)
    	and df2:n_priority_areas_per_grid Shape: (2015395, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (2015395, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2380098, 53)
    	and df2:points_for_qgis Shape: (386718, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (386723, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (386723, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (386718, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (386718, 43)
    	and df2:data.amanaPopulationOverlay Shape: (2015395, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (386697, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (21978, 17)
    	and df2:n_licenses_per_facility Shape: (21998, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (21978, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (2015395, 20)
    	and df2:grid_level_license_risks Shape: (2015395, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015395, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (2015395, 30)
    	and df2:licenses_per_facility Shape: (21978, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015395, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (2015395, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (386697, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (386697, 46)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2024293, 22)

INFO:root:Fetched Inspections_df shape: (3512593, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3512593, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3597980, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2265403, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2265403, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2265387, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2024293, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2265390, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015395, 13)
INFO:root:Fetched population_grids shape: (2015395, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2015395, 3)
INFO:root:Read pois_licenses_comparison shape: (2015395, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3512593, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3597980, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2265403, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2024293, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3409091, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3409091, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3526165, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (984779, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2015395, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5484, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2015395, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (12291, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (133875, 73)
    	and df2:predictions_df Shape: (133875, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (133875, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015395, 14)
    	and df2:priority_areas Shape: (1384, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9492, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9492, 2)
    	and df2:population_grids Shape: (2015395, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015395, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015395, 7)
    	and df2:population_grids Shape: (2015395, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015395, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (760484, 32)
    	and df2:geometry_per_grid Shape: (2015395, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (760417, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015395, 7)
    	and df2:population_grids Shape: (2015395, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015395, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (133385, 78)
    	and df2:population_grids Shape: (2015395, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (133378, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13650, 2)
    	and df2:pois_data Shape: (2015395, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13650, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13650, 5)
    	and df2:population_per_grid Shape: (2015395, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13650, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13650, 3)
    	and df2:licenses_per_grid Shape: (13650, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13650, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13650, 9)
    	and df2:geometry_per_grid Shape: (2015395, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (13650, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13650, 23)
    	and df2:n_priority_areas_per_grid Shape: (2015395, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (13650, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13650, 3)
    	and df2:licenses_per_grid Shape: (13650, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (13650, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (133378, 94)
    	and df2:points_for_qgis Shape: (133385, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (133385, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (133385, 24)
    	and df2:population_grids Shape: (2015395, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (133378, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (13650, 12)
    	and df2:n_licenses_per_facility Shape: (13650, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13650, 13)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (13650, 52)
    	and df2:grid_level_license_risks Shape: (13650, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13650, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (13650, 59)
    	and df2:licenses_per_facility Shape: (13650, 14)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13650, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1384, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015395, 15)
    	and df2:population_grids Shape: (2015395, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015395, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (133378, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (133378, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2015395, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (13650, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (13650, 18)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2026214, 22)

INFO:root:Fetched Inspections_df shape: (3537077, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3537077, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3623528, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2287780, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2287780, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2287764, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2026214, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2287767, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (1775371, 13)
INFO:root:Fetched population_grids shape: (1775371, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (1775371, 3)
INFO:root:Read pois_licenses_comparison shape: (1775371, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3537077, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3623528, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2287780, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2026214, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3428281, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3428281, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3547317, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (994697, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (1775371, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (4761, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (1775371, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (11112, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (134388, 73)
    	and df2:predictions_df Shape: (134388, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (134388, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1775371, 14)
    	and df2:priority_areas Shape: (1384, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (8546, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (8546, 2)
    	and df2:population_grids Shape: (1775371, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1775371, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1775371, 7)
    	and df2:population_grids Shape: (1775371, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (1775371, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (763689, 32)
    	and df2:geometry_per_grid Shape: (1775371, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (683295, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (1775371, 7)
    	and df2:population_grids Shape: (1775371, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (1775371, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (133890, 78)
    	and df2:population_grids Shape: (1775371, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (120697, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (12357, 2)
    	and df2:pois_data Shape: (1775371, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (12357, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (12357, 5)
    	and df2:population_per_grid Shape: (1775371, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (12357, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (12357, 3)
    	and df2:licenses_per_grid Shape: (12357, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (12357, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (12357, 9)
    	and df2:geometry_per_grid Shape: (1775371, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (12357, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (12357, 23)
    	and df2:n_priority_areas_per_grid Shape: (1775371, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (12357, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (12357, 3)
    	and df2:licenses_per_grid Shape: (12357, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (12357, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (120697, 94)
    	and df2:points_for_qgis Shape: (133890, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (133890, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (133890, 24)
    	and df2:population_grids Shape: (1775371, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (120697, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (12357, 12)
    	and df2:n_licenses_per_facility Shape: (12357, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (12357, 13)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (12357, 52)
    	and df2:grid_level_license_risks Shape: (12357, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (12357, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (12357, 59)
    	and df2:licenses_per_facility Shape: (12357, 14)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (12357, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1384, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (1775371, 15)
    	and df2:population_grids Shape: (1775371, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (1775371, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (120697, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (120697, 28)
    
INFO:root:OUTPUT tooltip_df shape: (1775371, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (12357, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (12357, 18)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (1073412, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (1073412, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (1076337, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (1073412, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (1126912, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (1073412, 2)
    and df2:n_pois_per_grid Shape: (1073412, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1073412, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (1073412, 4)
    and df2:populationsGrids Shape: (1073412, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1073412, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (1073412, 5)
    and df2:populationsGrids Shape: (1073412, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1073412, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1384, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1404316, 11)
    		and df2:licensesKeysDf Shape: (3800, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1404316, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (931280, 17) 
        and df2:licensesDf Shape: (931280, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (661116, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (2235089, 30)
    	and df2:licensesDf Shape: (931280, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1432613, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (387201, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (387201, 25)
    	and df2:xgb_predict_df Shape: (387201, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (387201, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (387201, 28)
    	and df2:licenses_df Shape: (931280, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (387201, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (971, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (971, 2)
    	and df2:amanaPopulationOverlay Shape: (1073412, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (1073412, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (1073412, 7)
    	and df2:amanaPopulationOverlay Shape: (1073412, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (1073412, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (1073412, 14)
    	and predictions_df Shape: (387201, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (1105596, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (1073412, 8)
    	and df2:grid_level_new_businesses Shape: (1073412, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (1073412, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (1073412, 2)
    	and df2:poiData Shape: (1073412, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (1073412, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (1073412, 5)
    	and df2:population_per_grid Shape: (1073412, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (1073412, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (1073412, 2)
    	and df2:licenses_per_grid Shape: (1073412, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (1073412, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (1073412, 2)
    	and df2:licenses_per_grid Shape: (1073412, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (1073412, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (1073412, 9)
    	and df2:n_priority_areas_per_grid Shape: (1073412, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (1073412, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (1105596, 53)
    	and df2:points_for_qgis Shape: (387201, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (387201, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (387201, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (387201, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (387201, 43)
    	and df2:data.amanaPopulationOverlay Shape: (1073412, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (34812, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (2626, 16)
    	and df2:n_licenses_per_facility Shape: (2628, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (2626, 17)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (1073412, 20)
    	and df2:grid_level_license_risks Shape: (1073412, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (1073412, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (1073412, 30)
    	and df2:licenses_per_facility Shape: (2626, 18) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (1073412, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (1073412, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (34812, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (34812, 46)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015412, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015412, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (2052182, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015412, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2615927, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (2015412, 2)
    and df2:n_pois_per_grid Shape: (2015412, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015412, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015412, 4)
    and df2:populationsGrids Shape: (2015412, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015412, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015412, 5)
    and df2:populationsGrids Shape: (2015412, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015412, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1384, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1405026, 11)
    		and df2:licensesKeysDf Shape: (3800, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1405026, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (931698, 17) 
        and df2:licensesDf Shape: (931698, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (662872, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (2240877, 30)
    	and df2:licensesDf Shape: (931698, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1434566, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (387447, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (387447, 25)
    	and df2:xgb_predict_df Shape: (387447, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (387447, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (387447, 28)
    	and df2:licenses_df Shape: (931698, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (387447, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (9481, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (9481, 2)
    	and df2:amanaPopulationOverlay Shape: (2015412, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015412, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (2015412, 7)
    	and df2:amanaPopulationOverlay Shape: (2015412, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015412, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (2015412, 14)
    	and predictions_df Shape: (387447, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (2380843, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (2015412, 8)
    	and df2:grid_level_new_businesses Shape: (2015412, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015412, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015412, 2)
    	and df2:poiData Shape: (2015412, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015412, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015412, 5)
    	and df2:population_per_grid Shape: (2015412, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015412, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015412, 2)
    	and df2:licenses_per_grid Shape: (2015412, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015412, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015412, 2)
    	and df2:licenses_per_grid Shape: (2015412, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015412, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2015412, 9)
    	and df2:n_priority_areas_per_grid Shape: (2015412, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (2015412, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2380843, 53)
    	and df2:points_for_qgis Shape: (387447, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (387558, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (387558, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (387447, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (387447, 43)
    	and df2:data.amanaPopulationOverlay Shape: (2015412, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (387257, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (21815, 17)
    	and df2:n_licenses_per_facility Shape: (21835, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (21815, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (2015412, 20)
    	and df2:grid_level_license_risks Shape: (2015412, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015412, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (2015412, 30)
    	and df2:licenses_per_facility Shape: (21815, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015412, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (2015412, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (387257, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (387257, 46)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2028078, 22)

INFO:root:Fetched Inspections_df shape: (3555971, 31)

INFO:root:Fetched/Read Health_df shape: (3800, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3555971, 31)
    	and df2:Health_df Shape: (3800, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3643130, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2304778, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2304778, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2304762, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2028078, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2304765, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015412, 13)
INFO:root:Fetched population_grids shape: (2015412, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2415302, 3)
INFO:root:Read pois_licenses_comparison shape: (2415302, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3555971, 31)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3643130, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2304778, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2028078, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3443056, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3443056, 61)
    	and df2:Health_df Shape: (3800, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3563424, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (1002915, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2015412, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5484, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2015412, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (12291, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (134741, 73)
    	and df2:predictions_df Shape: (134741, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (134741, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015412, 14)
    	and df2:priority_areas Shape: (1384, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9472, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9472, 2)
    	and df2:population_grids Shape: (2015412, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015412, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015412, 7)
    	and df2:population_grids Shape: (2015412, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2415302, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (767296, 32)
    	and df2:geometry_per_grid Shape: (2015412, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (767157, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2415302, 7)
    	and df2:population_grids Shape: (1815021, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2415302, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (134236, 78)
    	and df2:population_grids Shape: (2015412, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (134140, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13599, 2)
    	and df2:pois_data Shape: (2415302, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13788, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13788, 5)
    	and df2:population_per_grid Shape: (2015412, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (14040, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13527, 3)
    	and df2:licenses_per_grid Shape: (14040, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13968, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13968, 9)
    	and df2:geometry_per_grid Shape: (1814682, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (13968, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13968, 23)
    	and df2:n_priority_areas_per_grid Shape: (2415302, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (15480, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13527, 3)
    	and df2:licenses_per_grid Shape: (14040, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (13968, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (134140, 94)
    	and df2:points_for_qgis Shape: (134236, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (134236, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (134236, 24)
    	and df2:population_grids Shape: (2015412, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (134210, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (13599, 12)
    	and df2:n_licenses_per_facility Shape: (13599, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13599, 13)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (15480, 52)
    	and df2:grid_level_license_risks Shape: (13599, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (15480, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (15480, 59)
    	and df2:licenses_per_facility Shape: (13599, 14)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (15480, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1384, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015412, 15)
    	and df2:population_grids Shape: (2015412, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2019318, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (134140, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (134140, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2019318, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (17496, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (17496, 18)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015412, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015412, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (2052182, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015412, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2614220, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (2015412, 2)
    and df2:n_pois_per_grid Shape: (2015412, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015412, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015412, 4)
    and df2:populationsGrids Shape: (2015412, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015412, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015412, 5)
    and df2:populationsGrids Shape: (2015412, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015412, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1384, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1405478, 11)
    		and df2:licensesKeysDf Shape: (3800, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1405478, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (931930, 17) 
        and df2:licensesDf Shape: (931930, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (663778, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (2244821, 30)
    	and df2:licensesDf Shape: (931930, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1435619, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (386317, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (386317, 25)
    	and df2:xgb_predict_df Shape: (386317, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (386317, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (386317, 28)
    	and df2:licenses_df Shape: (931930, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (386317, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (9481, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (9481, 2)
    	and df2:amanaPopulationOverlay Shape: (2015412, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015412, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (2015412, 7)
    	and df2:amanaPopulationOverlay Shape: (2015412, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015412, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (2015412, 14)
    	and predictions_df Shape: (386317, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (2379741, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (2015412, 8)
    	and df2:grid_level_new_businesses Shape: (2015412, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015412, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015412, 2)
    	and df2:poiData Shape: (2015412, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015412, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015412, 5)
    	and df2:population_per_grid Shape: (2015412, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015412, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015412, 2)
    	and df2:licenses_per_grid Shape: (2015412, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015412, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015412, 2)
    	and df2:licenses_per_grid Shape: (2015412, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015412, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2015412, 9)
    	and df2:n_priority_areas_per_grid Shape: (2015412, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (2015412, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2379741, 53)
    	and df2:points_for_qgis Shape: (386317, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (386428, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (386428, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (386317, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (386317, 43)
    	and df2:data.amanaPopulationOverlay Shape: (2015412, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (386127, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (21786, 17)
    	and df2:n_licenses_per_facility Shape: (21806, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (21786, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (2015412, 20)
    	and df2:grid_level_license_risks Shape: (2015412, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015412, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (2015412, 30)
    	and df2:licenses_per_facility Shape: (21786, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015412, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (2015412, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (386127, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (386127, 46)
INFO:root:###########################################
INFO:root:Started getting data from data sources
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015412, 13)
INFO:root:CHECK:SJOIN function:getModelResults df1:poiDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015412, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:poiGrids (2052182, 33)
INFO:root:CHECK:SJOIN function:getModelResults df1:licensesDf Shape: (40958, 19)
    	and populationsGrids Shape: (2015412, 14) how="right"
        
INFO:root:CHECK:SJOIN_OUTPUT df:licenseGrids (2613226, 26)
INFO:root:CHECK:MERGE df1:n_licenses_per_grid Shape: (2015412, 2)
    and df2:n_pois_per_grid Shape: (2015412, 2)
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015412, 3)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015412, 4)
    and df2:populationsGrids Shape: (2015412, 14) on GridNumber, how:inner
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015412, 5)
    
INFO:root:CHECK:MERGE df1:pois_licenses_comparison Shape: (2015412, 5)
    and df2:populationsGrids Shape: (2015412, 14) on GridNumber
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (2015412, 6)
    
INFO:root:Function:priorityAreas df:priorityAreas Shape: (1384, 15)
INFO:root:Function:priorityAreas df:GridZones Shape: (1365177, 3)
INFO:root:Started getting data from data sources
INFO:root:CHECK:MERGE df1:licensesDf Shape: (1405478, 11)
    		and df2:licensesKeysDf Shape: (3800, 6) LEFT on BUSINESS ACTIVITY right on D_ACTIVITIES_NAME
INFO:root:CHECK:MERGE_OUTPUT df:pois_licenses_comparison (1405478, 17)
			
INFO:root:CHECK:MERGE function:buildFeatureDf df1:licensesDf Shape: (931930, 17) 
        and df2:licensesDf Shape: (931930, 17) INNER on LICENSE NUMBER
        
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (663778, 47)
        
INFO:root:CHECK:MERGE df1:inspectionsDf Shape: (2244821, 30)
    	and df2:licensesDf Shape: (931930, 17) LEFT on BUSINESS ACTIVITY
INFO:root:CHECK:MERGE_OUTPUT df:inspectionsWithLicensesDf (1435619, 47)
        
INFO:root:OUTPUT:FEATURES df:artificialDataset Shape: (385704, 25)
INFO:root:CHECK:MERGE function:processModel df1:data Shape: (385704, 25)
    	and df2:xgb_predict_df Shape: (385704, 2) left_index=True, right_index=True
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (385704, 27)
        
INFO:root:STATIC WEIGHTS- 
        impact_weight = 0.5
        visibility_weight = 0.5
        unlicensed_weight = 10 
INFO:root:CHECK:MERGE function:getModelResults df1:getModelResults Shape: (385704, 28)
    	and df2:licenses_df Shape: (931930, 17)  on='License ID (MOMRAH)', how='left' 
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (385704, 30)
        
INFO:root:CHECK:SJOIN_OUTPUT df:n_priority_areas_per_grid (9481, 2)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (9481, 2)
    	and df2:amanaPopulationOverlay Shape: (2015412, 14) on=['GridNumber'], how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015412, 7)
        
INFO:root:CHECK:MERGE function:getModelResults df1:n_priority_areas_per_grid Shape: (2015412, 7)
    	and df2:amanaPopulationOverlay Shape: (2015412, 14)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2015412, 7)
        
INFO:root:CHECK:SJOIN function:getModelResults df1:data.amanaPopulationOverlay Shape: (2015412, 14)
    	and predictions_df Shape: (385704, 37) how='left' .drop_duplicates(['GridNumber','License ID (MOMRAH)'])
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (2379147, 51)
INFO:root:CHECK:MERGE function:getModelResults df1:grid_level_license_risks Shape: (2015412, 8)
    	and df2:grid_level_new_businesses Shape: (2015412, 2) how='left', on='GridNumber' 
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015412, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015412, 2)
    	and df2:poiData Shape: (2015412, 3) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015412, 4)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_grid Shape: (2015412, 5)
    	and df2:population_per_grid Shape: (2015412, 2) how='inner',on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (2015412, 6)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015412, 2)
    	and df2:licenses_per_grid Shape: (2015412, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015412, 8)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licensed_risk_per_grid Shape: (2015412, 2)
    	and df2:licenses_per_grid Shape: (2015412, 7) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (2015412, 9)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2015412, 9)
    	and df2:n_priority_areas_per_grid Shape: (2015412, 10) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (2015412, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:risk_from_businesses Shape: (2379147, 53)
    	and df2:points_for_qgis Shape: (385704, 32) how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (385815, 41)
        
INFO:root:CHECK:DROP_DUPLICATES df:points_for_qgis (385815, 43) drop_duplicates('License ID (MOMRAH)')
        
INFO:root:CHECK:DROP_DUPLICATES_OUTPUT df:points_for_qgis (385704, 43)
        
INFO:root:CHECK:MERGE function:getModelResults df1:points_for_qgis Shape: (385704, 43)
    	and df2:data.amanaPopulationOverlay Shape: (2015412, 14)  on='GridNumber', how='inner'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (385516, 45)
        
INFO:root:CHECK:MERGE function:getModelResults df1:licenses_per_facility Shape: (21769, 17)
    	and df2:n_licenses_per_facility Shape: (21789, 2)   how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (21769, 18)
        
INFO:root:CHECK:MERGE function:getModelResults df1:total_risk_df Shape: (2015412, 20)
    	and df2:grid_level_license_risks Shape: (2015412, 9) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015412, 29)
        
INFO:root:CHECK:MERGE function:getModelResults df1:tooltip_df Shape: (2015412, 30)
    	and df2:licenses_per_facility Shape: (21769, 19) on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2015412, 31)
        
INFO:root:OUTPUT:LICENCES df:tooltip_df Shape: (2015412, 32)
INFO:root:OUTPUT:GRIDS df:points_for_qgis Shape: (385516, 46)
INFO:root:OUTPUT:GRIDS after saving df:points_for_qgis Shape: (385516, 46)
INFO:root:#############ENGINE RUN STARTS ###################
INFO:root:Fetched Retail_Licenses_medina_df shape: (2029004, 22)

INFO:root:Fetched Inspections_df shape: (3563504, 31)

INFO:root:Fetched/Read Health_df shape: (3801, 6)

INFO:root:CHECK:MERGE function:Create_Health_Model df1:Inspections_df Shape: (3563504, 31)
    	and df2:Health_df Shape: (3801, 7)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df (3650956, 37)
INFO:root:CHECK:DROP_OUTPUT degree of compliance = na df:df (2311588, 37)
        
INFO:root:CHECK:DROP_OUTPUT Licence number is na df:df (2311588, 37)
        
INFO:root:CHECK:MERGE function:Create_Health_Model df1:df Shape: (2311572, 67)
    	and df2:Retail_Licenses_medina_df Shape: (2029004, 24)  on='License ID (MOMRAH)', how='left' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df1 (2311575, 90)
        
INFO:root:Function:getPopulationData df:shpGrid Shape: (2015412, 13)
INFO:root:Fetched population_grids shape: (2015412, 13)

INFO:root:Fetched population_grids shape: (17, 8)

INFO:root:CHECK:POIS df:POI_df1_raw (6246, 17)
INFO:root:CHECK:POIS df:POI_df2_raw (34712, 18)
INFO:root:CHECK:POIS df:POI_df (40958, 18)
INFO:root:CHECK:POIS calculation result df:pois_licenses_comparison (2415302, 3)
INFO:root:Read pois_licenses_comparison shape: (2415302, 3)

INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:Inspections_df Shape: (3563504, 31)
    	and df2:Health_df Shape: (3801, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:Inspections_df (3650956, 38)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_inspections Shape: (2311588, 38)
    	and df2:Retail_Licenses_medina_df Shape: (2029004, 24)  on='LICENSE NUMBER',how='right' 
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3449206, 61)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations df1:df_all Shape: (3449206, 61)
    	and df2:Health_df Shape: (3801, 8)  on='Business Activity Description', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_all (3570086, 68)
        
INFO:root:CHECK:ONLY HEALTH LICENCES df:df_all (1006247, 68)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:geometry_per_grid Shape: (2015412, 14)
    	and df2:SewerManholes Shape: (5472, 19)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerManholes_grids (5484, 33)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:SewerLines Shape: (11448, 30)
    	and df2:geometry_per_grid Shape: (2015412, 14)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:SewerLines_grids (12291, 44)
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:Final_output_df Shape: (134858, 73)
    	and df2:predictions_df Shape: (134858, 2)  left_index=True, right_index=True
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (134858, 75)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015412, 14)
    	and df2:priority_areas Shape: (1384, 1)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:SJOIN_OUTPUT df:predictions_df (9472, 2)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (9472, 2)
    	and df2:population_grids Shape: (2015412, 14)   on=['GridNumber'], how='right'
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2015412, 7)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2015412, 7)
    	and df2:population_grids Shape: (2015412, 15)  
        
INFO:root:CHECK:MERGE_OUTPUT df:predictions_df (2415302, 7)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:CRM_Cleanliness_df Shape: (768532, 32)
    	and df2:geometry_per_grid Shape: (2015412, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:CRM_Cleanliness_withGrid_df (768393, 47)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:n_priority_areas_per_grid Shape: (2415302, 7)
    	and df2:population_grids Shape: (1815021, 18)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:n_priority_areas_per_grid (2415302, 24)
        
INFO:root:CHECK:SJOIN function:Perform_Predictions_Risk_Calculations 
        df1:predictions_df Shape: (134350, 78)
    	and df2:population_grids Shape: (2015412, 15)  how="inner",predicate="intersects"
        
INFO:root:CHECK:SJOIN_OUTPUT df:grid_level_probabilities (134254, 93)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13600, 2)
    	and df2:pois_data Shape: (2415302, 3)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13789, 4)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_grid Shape: (13789, 5)
    	and df2:population_per_grid Shape: (2015412, 2)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (14041, 6)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13528, 3)
    	and df2:licenses_per_grid Shape: (14041, 7)  on=['GridNumber'], how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_grid (13969, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13969, 9)
    	and df2:geometry_per_grid Shape: (1814682, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:risk_from_businesses (13969, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (13969, 23)
    	and df2:n_priority_areas_per_grid Shape: (2415302, 28)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:total_risk_df (15481, 50)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licensed_risk_per_grid Shape: (13528, 3)
    	and df2:licenses_per_grid Shape: (14041, 7)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:df_final (13969, 9)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:risk_from_businesses Shape: (134254, 94)
    	and df2:points_for_qgis Shape: (134350, 22)  how='right', on='License ID (MOMRAH)'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (134350, 23)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:points_for_qgis Shape: (134350, 24)
    	and df2:population_grids Shape: (2015412, 15)  on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:points_for_qgis (134324, 25)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:licenses_per_facility Shape: (13600, 12)
    	and df2:n_licenses_per_facility Shape: (13600, 2) how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (13600, 13)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:total_risk_df Shape: (15481, 52)
    	and df2:grid_level_license_risks Shape: (13600, 7)  on='GridNumber', how='left'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (15481, 59)
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:tooltip_df Shape: (15481, 59)
    	and df2:licenses_per_facility Shape: (13600, 14)  how='left', on='GridNumber'
        
INFO:root:CHECK:MERGE_OUTPUT df:licenses_per_facility (15481, 60)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (1384, 1)
        
INFO:root:CHECK:FILTER_OUTPUT df:lines_priority_areas (326, 1) removing non polygon areas
        
INFO:root:CHECK:MERGE function:Perform_Predictions_Risk_Calculations 
        df1:population_grids Shape: (2015412, 15)
    	and df2:population_grids Shape: (2015412, 15)  on='GridNumber', how='outer'
        
INFO:root:CHECK:MERGE_OUTPUT df:tooltip_df (2019318, 61)
        
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT points_for_qgis_withzone shape: (134254, 28)
    
INFO:root:OUTPUT points_for_qgis shape: (134254, 28)
    
INFO:root:OUTPUT tooltip_df shape: (2019318, 61)
    
INFO:root:Function:priorityAreas df:GridZones Shape: (1421958, 3)
INFO:root:Fetched zone_grids shape: (1421958, 3)
    
INFO:root:OUTPUT tooltip_df_subset_withzone shape: (17497, 21)
    
INFO:root:OUTPUT tooltip_df_subset shape: (17497, 18)
